%!PS-Adobe-2.0
%%Creator: dvips(k) 5.78 Copyright 1998 Radical Eye Software (www.radicaleye.com)
%%Title: main.dvi
%%Pages: 16
%%PageOrder: Ascend
%%BoundingBox: 0 0 596 842
%%DocumentFonts: Times-Bold Times-Roman Courier Times-Italic
%%+ Helvetica-Bold Helvetica
%%EndComments
%DVIPSCommandLine: dvips -f main.dvi
%DVIPSParameters: dpi=600, compressed
%DVIPSSource:  TeX output 1999.10.18:1519
%%BeginProcSet: texc.pro
%!
/TeXDict 300 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N
/X{S N}B /TR{translate}N /isls false N /vsize 11 72 mul N /hsize 8.5 72
mul N /landplus90{false}def /@rigin{isls{[0 landplus90{1 -1}{-1 1}
ifelse 0 0 0]concat}if 72 Resolution div 72 VResolution div neg scale
isls{landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div
hsize mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul
TR[matrix currentmatrix{dup dup round sub abs 0.00001 lt{round}if}
forall round exch round exch]setmatrix}N /@landscape{/isls true N}B
/@manualfeed{statusdict /manualfeed true put}B /@copies{/#copies X}B
/FMat[1 0 0 -1 0 0]N /FBB[0 0 0 0]N /nn 0 N /IE 0 N /ctr 0 N /df-tail{
/nn 8 dict N nn begin /FontType 3 N /FontMatrix fntrx N /FontBBox FBB N
string /base X array /BitMaps X /BuildChar{CharBuilder}N /Encoding IE N
end dup{/foo setfont}2 array copy cvx N load 0 nn put /ctr 0 N[}B /df{
/sf 1 N /fntrx FMat N df-tail}B /dfs{div /sf X /fntrx[sf 0 0 sf neg 0 0]
N df-tail}B /E{pop nn dup definefont setfont}B /ch-width{ch-data dup
length 5 sub get}B /ch-height{ch-data dup length 4 sub get}B /ch-xoff{
128 ch-data dup length 3 sub get sub}B /ch-yoff{ch-data dup length 2 sub
get 127 sub}B /ch-dx{ch-data dup length 1 sub get}B /ch-image{ch-data
dup type /stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N
/rc 0 N /gp 0 N /cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup
/base get 2 index get S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx
0 ch-xoff ch-yoff ch-height sub ch-xoff ch-width add ch-yoff
setcachedevice ch-width ch-height true[1 0 0 -1 -.1 ch-xoff sub ch-yoff
.1 sub]/id ch-image N /rw ch-width 7 add 8 idiv string N /rc 0 N /gp 0 N
/cp 0 N{rc 0 ne{rc 1 sub /rc X rw}{G}ifelse}imagemask restore}B /G{{id
gp get /gp gp 1 add N dup 18 mod S 18 idiv pl S get exec}loop}B /adv{cp
add /cp X}B /chg{rw cp id gp 4 index getinterval putinterval dup gp add
/gp X adv}B /nd{/cp 0 N rw exit}B /lsh{rw cp 2 copy get dup 0 eq{pop 1}{
dup 255 eq{pop 254}{dup dup add 255 and S 1 and or}ifelse}ifelse put 1
adv}B /rsh{rw cp 2 copy get dup 0 eq{pop 128}{dup 255 eq{pop 127}{dup 2
idiv S 128 and or}ifelse}ifelse put 1 adv}B /clr{rw cp 2 index string
putinterval adv}B /set{rw cp fillstr 0 4 index getinterval putinterval
adv}B /fillstr 18 string 0 1 17{2 copy 255 put pop}for N /pl[{adv 1 chg}
{adv 1 chg nd}{1 add chg}{1 add chg nd}{adv lsh}{adv lsh nd}{adv rsh}{
adv rsh nd}{1 add adv}{/rc X nd}{1 add set}{1 add clr}{adv 2 chg}{adv 2
chg nd}{pop nd}]dup{bind pop}forall N /D{/cc X dup type /stringtype ne{]
}if nn /base get cc ctr put nn /BitMaps get S ctr S sf 1 ne{dup dup
length 1 sub dup 2 index S get sf div put}if put /ctr ctr 1 add N}B /I{
cc 1 add D}B /bop{userdict /bop-hook known{bop-hook}if /SI save N @rigin
0 0 moveto /V matrix currentmatrix dup 1 get dup mul exch 0 get dup mul
add .99 lt{/QV}{/RV}ifelse load def pop pop}N /eop{SI restore userdict
/eop-hook known{eop-hook}if showpage}N /@start{userdict /start-hook
known{start-hook}if pop /VResolution X /Resolution X 1000 div /DVImag X
/IE 256 array N 2 string 0 1 255{IE S dup 360 add 36 4 index cvrs cvn
put}for pop 65781.76 div /vsize X 65781.76 div /hsize X}N /p{show}N
/RMat[1 0 0 -1 0 0]N /BDot 260 string N /rulex 0 N /ruley 0 N /v{/ruley
X /rulex X V}B /V{}B /RV statusdict begin /product where{pop false[
(Display)(NeXT)(LaserWriter 16/600)]{dup length product length le{dup
length product exch 0 exch getinterval eq{pop true exit}if}{pop}ifelse}
forall}{false}ifelse end{{gsave TR -.1 .1 TR 1 1 scale rulex ruley false
RMat{BDot}imagemask grestore}}{{gsave TR -.1 .1 TR rulex ruley scale 1 1
false RMat{BDot}imagemask grestore}}ifelse B /QV{gsave newpath transform
round exch round exch itransform moveto rulex 0 rlineto 0 ruley neg
rlineto rulex neg 0 rlineto fill grestore}B /a{moveto}B /delta 0 N /tail
{dup /delta X 0 rmoveto}B /M{S p delta add tail}B /b{S p tail}B /c{-4 M}
B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B /j{3 M}B /k{
4 M}B /w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w}B /q{
p 1 w}B /r{p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p
a}B /bos{/SS save N}B /eos{SS restore}B end

%%EndProcSet
%%BeginProcSet: 8r.enc
% @@psencodingfile@{
%   author = "S. Rahtz, P. MacKay, Alan Jeffrey, B. Horn, K. Berry",
%   version = "0.6",
%   date = "22 June 1996",
%   filename = "8r.enc",
%   email = "kb@@mail.tug.org",
%   address = "135 Center Hill Rd. // Plymouth, MA 02360",
%   codetable = "ISO/ASCII",
%   checksum = "119     662    4424",
%   docstring = "Encoding for TrueType or Type 1 fonts to be used with TeX."
% @}
% 
% Idea is to have all the characters normally included in Type 1 fonts
% available for typesetting. This is effectively the characters in Adobe
% Standard Encoding + ISO Latin 1 + extra characters from Lucida.
% 
% Character code assignments were made as follows:
% 
% (1) the Windows ANSI characters are almost all in their Windows ANSI
% positions, because some Windows users cannot easily reencode the
% fonts, and it makes no difference on other systems. The only Windows
% ANSI characters not available are those that make no sense for
% typesetting -- rubout (127 decimal), nobreakspace (160), softhyphen
% (173). quotesingle and grave are moved just because it's such an
% irritation not having them in TeX positions.
% 
% (2) Remaining characters are assigned arbitrarily to the lower part
% of the range, avoiding 0, 10 and 13 in case we meet dumb software.
% 
% (3) Y&Y Lucida Bright includes some extra text characters; in the
% hopes that other PostScript fonts, perhaps created for public
% consumption, will include them, they are included starting at 0x12.
% 
% (4) Remaining positions left undefined are for use in (hopefully)
% upward-compatible revisions, if someday more characters are generally
% available.
% 
% (5) hyphen appears twice for compatibility with both ASCII and Windows.
% 
/TeXBase1Encoding [
% 0x00 (encoded characters from Adobe Standard not in Windows 3.1)
  /.notdef /dotaccent /fi /fl
  /fraction /hungarumlaut /Lslash /lslash
  /ogonek /ring /.notdef
  /breve /minus /.notdef 
% These are the only two remaining unencoded characters, so may as
% well include them.
  /Zcaron /zcaron 
% 0x10
 /caron /dotlessi 
% (unusual TeX characters available in, e.g., Lucida Bright)
 /dotlessj /ff /ffi /ffl 
 /.notdef /.notdef /.notdef /.notdef
 /.notdef /.notdef /.notdef /.notdef
 % very contentious; it's so painful not having quoteleft and quoteright
 % at 96 and 145 that we move the things normally found there down to here.
 /grave /quotesingle 
% 0x20 (ASCII begins)
 /space /exclam /quotedbl /numbersign
 /dollar /percent /ampersand /quoteright
 /parenleft /parenright /asterisk /plus /comma /hyphen /period /slash
% 0x30
 /zero /one /two /three /four /five /six /seven
 /eight /nine /colon /semicolon /less /equal /greater /question
% 0x40
 /at /A /B /C /D /E /F /G /H /I /J /K /L /M /N /O
% 0x50
 /P /Q /R /S /T /U /V /W
 /X /Y /Z /bracketleft /backslash /bracketright /asciicircum /underscore
% 0x60
 /quoteleft /a /b /c /d /e /f /g /h /i /j /k /l /m /n /o
% 0x70
 /p /q /r /s /t /u /v /w
 /x /y /z /braceleft /bar /braceright /asciitilde
 /.notdef % rubout; ASCII ends
% 0x80
 /.notdef /.notdef /quotesinglbase /florin
 /quotedblbase /ellipsis /dagger /daggerdbl
 /circumflex /perthousand /Scaron /guilsinglleft
 /OE /.notdef /.notdef /.notdef
% 0x90
 /.notdef /.notdef /.notdef /quotedblleft
 /quotedblright /bullet /endash /emdash
 /tilde /trademark /scaron /guilsinglright
 /oe /.notdef /.notdef /Ydieresis
% 0xA0
 /.notdef % nobreakspace
 /exclamdown /cent /sterling
 /currency /yen /brokenbar /section
 /dieresis /copyright /ordfeminine /guillemotleft
 /logicalnot
 /hyphen % Y&Y (also at 45); Windows' softhyphen
 /registered
 /macron
% 0xD0
 /degree /plusminus /twosuperior /threesuperior
 /acute /mu /paragraph /periodcentered
 /cedilla /onesuperior /ordmasculine /guillemotright
 /onequarter /onehalf /threequarters /questiondown
% 0xC0
 /Agrave /Aacute /Acircumflex /Atilde /Adieresis /Aring /AE /Ccedilla
 /Egrave /Eacute /Ecircumflex /Edieresis
 /Igrave /Iacute /Icircumflex /Idieresis
% 0xD0
 /Eth /Ntilde /Ograve /Oacute
 /Ocircumflex /Otilde /Odieresis /multiply
 /Oslash /Ugrave /Uacute /Ucircumflex
 /Udieresis /Yacute /Thorn /germandbls
% 0xE0
 /agrave /aacute /acircumflex /atilde
 /adieresis /aring /ae /ccedilla
 /egrave /eacute /ecircumflex /edieresis
 /igrave /iacute /icircumflex /idieresis
% 0xF0
 /eth /ntilde /ograve /oacute
 /ocircumflex /otilde /odieresis /divide
 /oslash /ugrave /uacute /ucircumflex
 /udieresis /yacute /thorn /ydieresis
] def

%%EndProcSet
%%BeginProcSet: texps.pro
%!
TeXDict begin /rf{findfont dup length 1 add dict begin{1 index /FID ne 2
index /UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll
exec 0 exch 5 -1 roll VResolution Resolution div mul neg 0 0]/Metrics
exch def dict begin Encoding{exch dup type /integertype ne{pop pop 1 sub
dup 0 le{pop}{[}ifelse}{FontMatrix 0 get div Metrics 0 get div def}
ifelse}forall Metrics /Metrics currentdict end def[2 index currentdict
end definefont 3 -1 roll makefont /setfont cvx]cvx def}def /ObliqueSlant
{dup sin S cos div neg}B /SlantFont{4 index mul add}def /ExtendFont{3 -1
roll mul exch}def /ReEncodeFont{/Encoding exch def}def end

%%EndProcSet
%%BeginProcSet: special.pro
%!
TeXDict begin /SDict 200 dict N SDict begin /@SpecialDefaults{/hs 612 N
/vs 792 N /ho 0 N /vo 0 N /hsc 1 N /vsc 1 N /ang 0 N /CLIP 0 N /rwiSeen
false N /rhiSeen false N /letter{}N /note{}N /a4{}N /legal{}N}B
/@scaleunit 100 N /@hscale{@scaleunit div /hsc X}B /@vscale{@scaleunit
div /vsc X}B /@hsize{/hs X /CLIP 1 N}B /@vsize{/vs X /CLIP 1 N}B /@clip{
/CLIP 2 N}B /@hoffset{/ho X}B /@voffset{/vo X}B /@angle{/ang X}B /@rwi{
10 div /rwi X /rwiSeen true N}B /@rhi{10 div /rhi X /rhiSeen true N}B
/@llx{/llx X}B /@lly{/lly X}B /@urx{/urx X}B /@ury{/ury X}B /magscale
true def end /@MacSetUp{userdict /md known{userdict /md get type
/dicttype eq{userdict begin md length 10 add md maxlength ge{/md md dup
length 20 add dict copy def}if end md begin /letter{}N /note{}N /legal{}
N /od{txpose 1 0 mtx defaultmatrix dtransform S atan/pa X newpath
clippath mark{transform{itransform moveto}}{transform{itransform lineto}
}{6 -2 roll transform 6 -2 roll transform 6 -2 roll transform{
itransform 6 2 roll itransform 6 2 roll itransform 6 2 roll curveto}}{{
closepath}}pathforall newpath counttomark array astore /gc xdf pop ct 39
0 put 10 fz 0 fs 2 F/|______Courier fnt invertflag{PaintBlack}if}N
/txpose{pxs pys scale ppr aload pop por{noflips{pop S neg S TR pop 1 -1
scale}if xflip yflip and{pop S neg S TR 180 rotate 1 -1 scale ppr 3 get
ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub neg TR}if xflip yflip
not and{pop S neg S TR pop 180 rotate ppr 3 get ppr 1 get neg sub neg 0
TR}if yflip xflip not and{ppr 1 get neg ppr 0 get neg TR}if}{noflips{TR
pop pop 270 rotate 1 -1 scale}if xflip yflip and{TR pop pop 90 rotate 1
-1 scale ppr 3 get ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub neg
TR}if xflip yflip not and{TR pop pop 90 rotate ppr 3 get ppr 1 get neg
sub neg 0 TR}if yflip xflip not and{TR pop pop 270 rotate ppr 2 get ppr
0 get neg sub neg 0 S TR}if}ifelse scaleby96{ppr aload pop 4 -1 roll add
2 div 3 1 roll add 2 div 2 copy TR .96 dup scale neg S neg S TR}if}N /cp
{pop pop showpage pm restore}N end}if}if}N /normalscale{Resolution 72
div VResolution 72 div neg scale magscale{DVImag dup scale}if 0 setgray}
N /psfts{S 65781.76 div N}N /startTexFig{/psf$SavedState save N userdict
maxlength dict begin /magscale true def normalscale currentpoint TR
/psf$ury psfts /psf$urx psfts /psf$lly psfts /psf$llx psfts /psf$y psfts
/psf$x psfts currentpoint /psf$cy X /psf$cx X /psf$sx psf$x psf$urx
psf$llx sub div N /psf$sy psf$y psf$ury psf$lly sub div N psf$sx psf$sy
scale psf$cx psf$sx div psf$llx sub psf$cy psf$sy div psf$ury sub TR
/showpage{}N /erasepage{}N /copypage{}N /p 3 def @MacSetUp}N /doclip{
psf$llx psf$lly psf$urx psf$ury currentpoint 6 2 roll newpath 4 copy 4 2
roll moveto 6 -1 roll S lineto S lineto S lineto closepath clip newpath
moveto}N /endTexFig{end psf$SavedState restore}N /@beginspecial{SDict
begin /SpecialSave save N gsave normalscale currentpoint TR
@SpecialDefaults count /ocount X /dcount countdictstack N}N /@setspecial
{CLIP 1 eq{newpath 0 0 moveto hs 0 rlineto 0 vs rlineto hs neg 0 rlineto
closepath clip}if ho vo TR hsc vsc scale ang rotate rwiSeen{rwi urx llx
sub div rhiSeen{rhi ury lly sub div}{dup}ifelse scale llx neg lly neg TR
}{rhiSeen{rhi ury lly sub div dup scale llx neg lly neg TR}if}ifelse
CLIP 2 eq{newpath llx lly moveto urx lly lineto urx ury lineto llx ury
lineto closepath clip}if /showpage{}N /erasepage{}N /copypage{}N newpath
}N /@endspecial{count ocount sub{pop}repeat countdictstack dcount sub{
end}repeat grestore SpecialSave restore end}N /@defspecial{SDict begin}
N /@fedspecial{end}B /li{lineto}B /rl{rlineto}B /rc{rcurveto}B /np{
/SaveX currentpoint /SaveY X N 1 setlinecap newpath}N /st{stroke SaveX
SaveY moveto}N /fil{fill SaveX SaveY moveto}N /ellipse{/endangle X
/startangle X /yrad X /xrad X /savematrix matrix currentmatrix N TR xrad
yrad scale 0 0 1 startangle endangle arc savematrix setmatrix}N end

%%EndProcSet
TeXDict begin 39158280 55380996 1000 600 600 (main.dvi)
@start /Fa 205[25 25 49[{TeXBase1Encoding ReEncodeFont}2
49.8132 /Times-Roman rf /Fb 205[29 29 49[{TeXBase1Encoding ReEncodeFont}
2 58.1154 /Times-Roman rf
%DVIPSBitmapFont: Fc cmr10 10 5
/Fc 5 62 df<146014E0EB01C0EB0380EB0700130E131E5B5BA25B485AA2485AA212075B
120F90C7FCA25A121EA2123EA35AA65AB2127CA67EA3121EA2121F7EA27F12077F1203A2
6C7EA26C7E1378A27F7F130E7FEB0380EB01C0EB00E01460135278BD20>40
D<12C07E12707E7E7E120F6C7E6C7EA26C7E6C7EA21378A2137C133C133E131EA2131F7F
A21480A3EB07C0A6EB03E0B2EB07C0A6EB0F80A31400A25B131EA2133E133C137C1378A2
5BA2485A485AA2485A48C7FC120E5A5A5A5A5A13527CBD20>I<EB01C013031307131F13
FFB5FCA2131F1200B3B3A8497E007FB512F0A31C3879B72A>49 D<121C127FEAFF80A5EA
7F00121CC7FCB2121C127FEAFF80A5EA7F00121C092479A317>58
D<007FB812F8B912FCA26C17F8CCFCAE007FB812F8B912FCA26C17F836167B9F41>61
D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fd cmmi7 7 4
/Fd 4 111 df<013FB512F816FF903A01FC001FC04AEB07E0EE01F0010315F816005CA2
130716015CA2010FEC03F0A24AEB07E0EE0FC0011FEC1F80EE3E0091388001FC91B512E0
93C7FCD93F80C8FC91C9FCA35B137EA313FE5BA312015BA21203B512C0A22D287DA72A>
80 D<130E131F5BA2133E131C90C7FCA7EA03E0487EEA0C78EA187C1230A212605B12C0
A2EA01F0A3485AA2485AA2EBC180EA0F81A2381F0300A213066C5A131CEA07F06C5A1128
7DA617>105 D<133EEA07FEA2EA007CA213FCA25BA21201A25BA21203EC07809038E01F
C0EC38600007EB61E014C3EBC187EBC307D80FC613C09038CC038001B8C7FC13E0487E13
FEEB3F80EB0FC0486C7E1303003E1460A2127EECC0C0127CECC18012FC903801E30038F8
00FE0070137C1B297CA723>107 D<3907801FC0390FE07FF03918F0E0F83930F1807CEB
FB00D860FE133C5B5B00C1147C5B1201A248485BA34A5AEA07C01660EC03E0A23A0F8007
C0C0A2EDC180913803C300D81F0013C7EC01FE000EEB00F8231B7D9929>110
D E
%EndDVIPSBitmapFont
/Fe 130[45 45 45 1[45 45 45 45 45 45 45 45 1[45 45 45
45 45 45 45 45 45 45 45 45 45 45 45 45 1[45 1[45 1[45
1[45 45 45 45 45 45 45 45 1[45 45 45 45 3[45 2[45 45
45 45 5[45 1[45 45 6[45 45 45 45 45 45 45 45 1[45 45
45 45 45 3[45 45 33[{TeXBase1Encoding ReEncodeFont}65
74.7198 /Courier rf
%DVIPSBitmapFont: Ff cmr7 7 2
/Ff 2 51 df<13381378EA01F8121F12FE12E01200B3AB487EB512F8A215267BA521>49
D<13FF000313E0380E03F0381800F848137C48137E00787F12FC6CEB1F80A4127CC7FC15
005C143E147E147C5C495A495A5C495A010EC7FC5B5B903870018013E0EA018039030003
0012065A001FB5FC5A485BB5FCA219267DA521>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fg cmmi10 10 18
/Fg 18 121 df<121C127FEAFF80A5EA7F00121C0909798817>58
D<121C127FEAFF80A213C0A3127F121C1200A412011380A2120313005A1206120E5A5A5A
12600A19798817>I<9339FF8001C0030F13E0037F9038F80380913A01FF807E07913A07
F8000F0FDA1FE0EB079FDA3F80903803BF0002FFC76CB4FCD901FC80495A4948157E495A
495A4948153E017F163C49C9FC5B1201484816385B1207485A1830121F4993C7FCA2485A
A3127F5BA312FF90CCFCA41703A25F1706A26C160E170C171C5F6C7E5F001F5E6D4A5A6C
6C4A5A16076C6C020EC8FC6C6C143C6C6C5C6CB4495A90393FE00FC0010FB5C9FC010313
FC9038007FC03A3D7CBA3B>67 D<902603FFF891381FFFF8496D5CA2D90007030113006F
EC007C02061678DA0EFF157081020C6D1460A2DA1C3F15E0705CEC181F82023815016F6C
5C1430150702706D1303030392C7FC02607FA2DAE0015C701306ECC0008201016E130EEF
800C5C163F0103EDC01C041F131891C713E0160F49EDF03818300106140717F8010E0203
1370EFFC60130CEE01FE011C16E004005B011815FF177F1338600130153FA20170151F95
C8FC01F081EA07FCB512E01706A245397DB843>78 D<0103B7FC4916E018F8903B0007F8
0007FC4BEB00FE187F020FED3F80F01FC05DA2021F16E0A25DA2143FF03FC05DA2027FED
7F80A292C8130018FE4A4A5A604AEC07F04D5A0101ED3FC04CB4C7FC91B612FC17E0D903
FCCAFCA25CA21307A25CA2130FA25CA2131FA25CA2133FA25CA2137FA291CBFC497EB6FC
A33B397DB835>80 D<92391FE00380DBFFFC130002036D5A91390FE01F8F91393F0007DF
027EEB01FE02F81300495A4948147E177C4948143C495AA2011F153891C8FCA3491530A2
8094C7FC80806D7E14FEECFFE06D13FE6DEBFFC06D14F06D806D80021F7F02037FEC003F
03037F1500167F163F161FA3120C160FA2001C151F94C7FCA3003C153EA25E003E5D127E
007F4A5A6D495A6DEB0FC0D8F9F0495AD8F0FE01FEC8FC39E03FFFF8010F13E0D8C00190
C9FC313D7CBA33>83 D<49B500F890387FFFF095B5FC1AE0D90003018090380FFC004BC7
13E00201ED07804EC7FC6E6C140E606F5C705B606F6C485A4D5A031F91C8FCEEE0065F6F
6C5A5F03075B705A16F96FB45A94C9FC6F5AA36F7EA34B7FED037F9238063FC0150E4B6C
7E1538ED700F03E07F15C04A486C7EEC0300020613034A805C4A6D7E14704A1300494880
495A49C86C7E130E011E153F017E4B7ED803FF4B7E007F01E0011FEBFFC0B5FC6144397E
B845>88 D<B500FC91383FFFE0A3000390C83807FC006CEE03E06C5F4D5A95C7FC6D6C14
0E5F5F6D6C14305F5F6D6C495A4CC8FC010F5C6E130E160C01075C6E5B5E6D6C5B15014B
5AD901FE90C9FC15065D6D6C5A5D15706E5A5D5D6ECAFC5CA3147E14FEA35C1301A35C13
03A35C1307A2130F000FB512F0A25D3B397DB830>I<147E903803FF8090390FC1C38090
391F00EFC0017E137F49133F485A4848EB1F8012075B000F143F48481400A2485A5D007F
147E90C7FCA215FE485C5AA214015D48150CA21403EDF01C16181407007C1538007E010F
1330003E131F027B13706C01E113E03A0F83C0F9C03A03FF007F80D800FCEB1F0026267D
A42C>97 D<163FED1FFFA3ED007F167EA216FEA216FCA21501A216F8A21503A216F0A215
07A2027E13E0903803FF8790380FC1CF90381F00EF017EEB7FC049133F485A4848131F00
0715805B000F143F485A1600485A5D127F90C7127EA215FE5A485CA21401A248ECF80CA2
1403161CEDF0181407007C1538007E010F1330003E131F027B13706C01E113E03A0F83C0
F9C03A03FF007F80D800FCEB1F00283B7DB92B>100 D<EC3FC0903801FFF0903807E078
90381F801C90387E001E49130E485A485A1207485A49131E001F141C153C484813F8EC03
E0007FEB3FC09038FFFE0014E090C8FC5A5AA7007E140315071506003E140E153C6C1470
6C6C13E0EC07C03903E03F003801FFF838003FC020267DA427>I<D803E0017F14FE3D07
F801FFE003FFC03D0E3C0781F00F03E03D1C3E1E00F83C01F026383F38D9FC707F003049
14E04A90387DC000007049EB7F8000604991C7FCA200E090C700FE1301485A017E5CA200
000201140301FE5F495CA203031407000160495C180F03075D1203494A011F1360198003
0F023F13E00007F000C0495C1901031F023E1380000F1803494A150061033F150E001FEF
1E1C4991C7EA0FF80007C7000EEC03E043267EA449>109 D<D803E0137F3A07F801FFE0
3A0E3C0781F03A1C3E1E00F826383F387F00305B4A137C00705B00605BA200E090C712FC
485A137EA20000140101FE5C5BA2150300015D5B15075E120349010F133016C0031F1370
0007ED80605B17E0EE00C0000F15014915801603EE0700001FEC0F0E49EB07FC0007C7EA
01F02C267EA432>I<EC1FC0ECFFF8903807E07E90380F801F90393F000F80017E14C049
1307484814E0485A4848EB03F0120F5B121F48481307A2127F90C7FCA2150F5A4815E0A2
151F16C0A248EC3F8016005D157E007E5C4A5A003E495A003F495A6C495A6C6C48C7FC38
07E07E3801FFF038003F8024267DA428>I<14FF010313C090380F80F090383E00380178
131C153C4913FC0001130113E0A33903F000F06D13007F3801FFE014FC14FF6C14806D13
C0011F13E013039038003FF014071403001E1301127FA24814E0A348EB03C012F800E0EB
07800070EB0F006C133E001E13F83807FFE0000190C7FC1E267CA427>115
D<EB01C0497E1307A4130F5CA3131F5CA3133F91C7FC007FB51280A2B6FCD8007EC7FCA3
13FE5BA312015BA312035BA312075BA3120FEBC006A2140E001F130CEB801C141814385C
146014E0380F81C038078780D803FEC7FCEA00F819357EB31E>I<01F8EB03C0D803FEEB
07E0D8070F130F000E018013F0121C12180038140700301403D8701F130112601500D8E0
3F14E000C090C7FC5BEA007E16C013FE5B1501000115805B150316001203495B1506150E
150C151C151815385D00015C6D485A6C6C485AD97E0FC7FCEB1FFEEB07F024267EA428>
118 D<903907E001F090391FF807FC9039783E0E0F9039E01F1C1FD801C09038383F803A
03800FF07F0100EBE0FF5A000E4A1300000C157E021F133C001C4AC7FC1218A2C7123FA2
92C8FCA25CA2147EA214FEA24A130CA20101141C001E1518003F5BD87F81143801835C00
FF1560010714E03AFE0E7C01C0D87C1C495A2778383E0FC7FC391FF00FFC3907C003F029
267EA42F>120 D E
%EndDVIPSBitmapFont
/Fh 105[42 30[60 42 1[28 32 37 1[46 42 46 1[23 46 1[23
3[37 1[37 1[42 11[60 1[46 2[51 65 60 4[32 4[60 60 12[42
2[42 42 42 1[23 21 28 45[{TeXBase1Encoding ReEncodeFont}30
83.022 /Times-Bold rf /Fi 82[28 51[46 46 65 46 51 28
46 32 51 51 51 51 74 23 2[23 51 51 28 46 51 46 51 46
8[55 3[51 55 60 1[55 65 1[69 51 2[23 60 1[51 2[60 9[46
46 46 46 46 46 46 46 46 46 23 23 1[23 44[{TeXBase1Encoding ReEncodeFont}
49 83.022 /Helvetica-Bold rf
%DVIPSBitmapFont: Fj cmmi9 9 1
/Fj 1 61 df<171C177EEE01FEEE07FCEE1FF0EE7FC0923801FF00ED07FCED1FF0ED7FC0
4A48C7FCEC07FCEC1FF0EC7FC04948C8FCEB07FCEB1FF0EB7FC04848C9FCEA07FCEA1FF0
EA7FC048CAFCA2EA7FC0EA1FF0EA07FCEA01FF38007FC0EB1FF0EB07FCEB01FF9038007F
C0EC1FF0EC07FCEC01FF9138007FC0ED1FF0ED07FCED01FF9238007FC0EE1FF0EE07FCEE
01FEEE007E171C2F2E7AA93C>60 D E
%EndDVIPSBitmapFont
/Fk 133[33 37 37 54 37 37 21 29 25 1[37 37 37 58 21 37
21 21 37 37 25 33 37 33 37 33 3[25 1[25 46 54 54 71 54
54 46 42 50 1[42 54 54 66 46 54 29 25 54 54 42 46 54
50 50 54 6[21 37 37 37 37 37 37 37 37 37 37 21 19 25
19 2[25 25 25 1[62 34[42 2[{TeXBase1Encoding ReEncodeFont}72
74.7198 /Times-Roman rf /Fl 82[30 51[46 46 66 46 51 30
36 41 1[51 46 51 76 25 51 1[25 51 46 30 41 51 41 51 46
8[66 91 66 66 1[51 66 1[56 71 66 4[36 2[56 61 66 66 1[66
9[46 46 1[46 46 46 46 2[23 46[{TeXBase1Encoding ReEncodeFont}46
91.3242 /Times-Bold rf /Fm 133[50 50 50 50 50 50 50 50
50 1[50 50 50 50 50 50 1[50 50 50 50 50 50 50 50 50 10[50
50 50 50 50 1[50 50 50 4[50 2[50 50 50 50 10[50 7[50
50 1[50 50 44[{TeXBase1Encoding ReEncodeFont}42 83.022
/Courier rf /Fn 105[33 28[33 33 48 33 33 18 26 22 1[33
33 33 52 18 33 1[18 33 33 22 29 33 29 33 29 11[48 41
37 44 1[37 48 1[59 3[22 2[37 1[48 44 44 48 7[33 1[33
33 1[33 33 33 33 33 1[17 22 17 2[22 22 22 36[37 2[{
TeXBase1Encoding ReEncodeFont}52 66.4176 /Times-Roman
rf
%DVIPSBitmapFont: Fo cmsy6 6 1
/Fo 1 4 df<136013701360A20040132000E0137038F861F0387E67E0381FFF803807FE
00EA00F0EA07FE381FFF80387E67E038F861F038E060700040132000001300A213701360
14157B9620>3 D E
%EndDVIPSBitmapFont
/Fp 104[83 2[37 37 24[37 42 42 60 42 42 23 32 28 42 42
42 42 65 23 42 23 23 42 42 28 37 42 37 42 37 3[28 1[28
1[60 60 78 60 60 51 46 55 1[46 60 60 74 51 60 1[28 60
60 46 51 60 55 55 60 5[23 23 42 42 42 42 42 42 42 42
42 42 23 21 28 21 47 1[28 28 28 1[69 3[28 29[46 46 2[{
TeXBase1Encoding ReEncodeFont}78 83.022 /Times-Roman
rf /Fq 133[32 37 37 55 37 42 23 32 32 42 42 42 42 60
23 37 23 23 42 42 23 37 42 37 42 42 8[51 69 1[60 46 42
2[51 60 55 69 3[28 3[51 1[55 1[51 6[28 10[23 21 28 21
40[42 42 2[{TeXBase1Encoding ReEncodeFont}46 83.022 /Times-Italic
rf /Fr 134[50 1[72 50 55 33 39 44 1[55 50 55 83 28 55
1[28 2[33 44 55 44 55 50 9[100 3[55 72 1[61 78 5[39 4[72
72 1[72 7[50 50 50 50 50 50 50 50 50 46[55 2[{
TeXBase1Encoding ReEncodeFont}39 99.6264 /Times-Bold
rf /Fs 134[60 3[60 60 60 60 1[60 1[60 1[60 60 1[60 3[60
60 60 60 60 32[60 17[60 46[{TeXBase1Encoding ReEncodeFont}17
99.6264 /Courier rf /Ft 134[50 1[72 50 1[28 39 33 2[50
50 78 1[50 1[28 2[33 44 3[44 7[72 3[72 1[55 66 3[72 2[72
39 33 6[66 72 7[50 1[50 1[50 50 2[50 50 1[25 1[25 44[{
TeXBase1Encoding ReEncodeFont}32 99.6264 /Times-Roman
rf
%DVIPSBitmapFont: Fu cmsy10 10 5
/Fu 5 107 df<007FB81280B912C0A26C17803204799641>0 D<121C127FEAFF80A5EA7F
00121C0909799917>I<EB0380497EA7397803803C00FC147E00FE14FE397F8383FC393F
C387F8390FE38FE03903FBBF803900FFFE00EB3FF8EB0FE0A2EB3FF8EBFFFE3903FBBF80
390FE38FE0393FC387F8397F8383FC39FE0380FE00FC147E0078143C390007C000A76D5A
1F247BA62A>3 D<EB0FE0EB7FFC497E0003EBFF804814C04814E04814F04814F8A24814
FCA3B612FEA86C14FCA36C14F8A26C14F06C14E06C14C06C1480C6EBFE006D5AEB0FE01F
207BA42A>15 D<126012F0B3B3B3B3A91260045377BD17>106 D
E
%EndDVIPSBitmapFont
/Fv 134[60 2[60 66 40 47 53 1[66 60 66 100 33 2[33 2[40
53 66 53 1[60 11[86 1[66 2[73 3[80 2[47 4[86 86 1[86
6[40 12[40 42[66 2[{TeXBase1Encoding ReEncodeFont}28
119.552 /Times-Bold rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 600dpi
TeXDict begin
%%PaperSize: A4

%%EndSetup
%%Page: 1 1
1 0 bop 492 689 a Fv(User)l(-Le)n(v)o(el)29 b(Infrastructur)n(e)h(f)m
(or)g(System)f(Call)h(Inter)o(position:)583 839 y(A)g(Platf)m(orm)f(f)m
(or)g(Intrusion)i(Detection)f(and)h(Con\002nement)3265
795 y Fu(\003)1038 1055 y Ft(K.)25 b(Jain)748 1171 y(Io)n(w)o(a)g
(State)g(Uni)n(v)o(ersity)848 1287 y(Ames,)g(IA)g(50014)581
1403 y Fs(kapil@cs.iastate.edu)2507 1055 y Ft(R.)g(Sekar)2090
1171 y(State)g(Uni)n(v)o(ersity)e(of)h(Ne)n(w)h(Y)-11
b(ork)2192 1287 y(Ston)o(y)24 b(Brook,)h(NY)g(11794)2111
1403 y Fs(sekar@cs.sunysb.edu)661 1654 y Fr(Abstract)-38
1859 y Fq(Se)o(ver)o(al)e(ne)o(w)i(appr)l(oac)o(hes)d(for)j(detecting)e
(malicious)h(attac)n(ks)-138 1959 y(on)38 b(computer)f(systems)j
(and/or)d(con\002ning)f(untrusted)h(or)i(ma-)-138 2059
y(licious)g(applications)d(have)i(emer)m(g)o(ed)g(o)o(ver)h(the)g(past)
f(se)o(ver)o(al)-138 2158 y(year)o(s.)59 b(These)32 b(tec)o(hniques)e
(often)h(r)m(ely)h(on)f(the)h(fact)f(that)g(when)-138
2258 y(a)20 b(system)g(is)h(attac)n(k)o(ed)d(fr)l(om)j(a)e(r)m(emote)h
(location)e(o)o(ver)i(a)g(network,)-138 2358 y(dama)o(g)o(e)34
b(can)h(ultimately)g(be)g(in\003icted)f(only)h(via)h(system)g(calls)
-138 2457 y(made)17 b(by)g(pr)l(ocesses)g(running)f(on)h(the)g(tar)m(g)
o(et)g(system.)25 b(This)17 b(factor)-138 2557 y(has)k(lead)g(to)g(a)h
(sur)m(g)o(e)f(of)g(inter)m(est)h(in)g(de)o(veloping)d(infr)o
(astructur)m(es)-138 2656 y(that)25 b(enable)f(secur)m(e)i(inter)m
(ception)e(and)g(modi\002cation)f(of)i(system)-138 2756
y(calls)20 b(made)e(by)i(pr)l(ocesses)g(running)e(on)g(the)i(tar)m(g)o
(et)f(system.)26 b(Most)-138 2856 y(known)f(appr)l(oac)o(hes)f(for)i
(solving)f(this)h(pr)l(oblem)f(have)g(r)m(elied)h(on)-138
2955 y(an)e(in-k)o(ernel)f(appr)l(oac)o(h,)g(wher)m(e)h(the)g(inter)m
(ception)f(mec)o(hanisms)-138 3055 y(as)k(well)h(as)f(the)g(intrusion)f
(detection/con\002nement)d(systems)28 b(ar)m(e)-138 3155
y(implemented)k(within)h(the)g(oper)o(ating)f(system)i(k)o(ernel.)64
b(W)-8 b(e)34 b(e)n(x-)-138 3254 y(plor)m(e)d(an)g(alternative)g(appr)l
(oac)o(h)f(that)h(uses)h(mec)o(hanisms)f(pr)l(o-)-138
3354 y(vided)19 b(by)h(most)g(variants)g(of)g(the)f(UNIX)h(oper)o
(ating)e(system)j(to)f(im-)-138 3453 y(plement)30 b(system)h(call)g
(interposition)e(at)i(user)g(le)o(vel,)h(wher)m(e)f(the)-138
3553 y(system)20 b(calls)g(made)f(by)g(one)g(pr)l(ocess)h(ar)m(e)g
(monitor)m(ed)e(by)h(another)-138 3653 y(pr)l(ocess.)25
b(Some)17 b(of)g(the)h(k)o(e)n(y)f(pr)l(oblems)h(that)f(need)g(to)h
(solved)f(in)h(de-)-138 3752 y(veloping)24 b(suc)o(h)h(an)h(appr)l(oac)
o(h)d(ar)m(e:)36 b(pr)l(o)o(viding)25 b(adequate)f(set)i(of)-138
3852 y(capabilities)21 b(in)h(the)g(infr)o(astructur)m(e)o(,)g
(portability)g(of)g(the)g(security)-138 3952 y(enhancements)j(and)h
(the)g(infr)o(astructur)m(e)h(itself)h(acr)l(oss)f(dif)o(fer)m(ent)-138
4051 y(oper)o(ating)20 b(systems,)k(and)d(minimizing)h(performance)f(o)
o(verheads)-138 4151 y(associated)30 b(with)h(inter)m(ception)e(for)i
(a)g(wide)g(r)o(ang)o(e)e(of)i(applica-)-138 4251 y(tions.)58
b(W)-8 b(e)33 b(pr)m(esent)e(a)g(solution)g(that)g(satisfactorily)g
(addr)m(esses)-138 4350 y(these)16 b(issues,)i(and)d(can)h(thus)g(lead)
f(to)h(a)h(platform)e(for)i(r)o(apid)e(de)o(vel-)-138
4450 y(opment)23 b(and)g(deployment)g(of)h(r)l(ob)n(ust)h(intrusion)e
(detector)o(s,)i(con-)-138 4549 y(\002nement)17 b(systems)i(and)e
(other)g(application-speci\002c)e(security)j(en-)-138
4649 y(hancements.)-138 4933 y Fr(1)99 b(Intr)n(oduction)-38
5167 y Fp(One)34 b(of)h(the)g(biggest)f(problems)g(f)o(aced)g(by)h(b)n
(usinesses,)k(in-)-138 5267 y(di)n(viduals)31 b(and)g(or)o(ganizations)
d(is)33 b(the)e(protection)f(of)h(their)h(net-)-138 5366
y(w)o(ork)o(ed)24 b(computing)e(systems)j(from)f(damage)f(due)h(to)h
(malicious)p -138 5462 788 4 v -54 5515 a Fo(\003)-18
5538 y Fn(This)j(research)i(is)f(supported)h(in)f(part)g(by)g(Defense)h
(Adv)n(anced)g(Research)-138 5617 y(Agenc)o(y')l(s)23
b(Information)g(T)-5 b(echnology)24 b(Of)n(\002ce)e(\(D)m(ARP)-6
b(A-IT)o(O\))21 b(under)h(the)g(Infor)o(-)-138 5696 y(mation)d(System)f
(Survi)n(v)n(ability)k(program,)c(under)h(contract)h(number)e
(F30602-97-)-138 5775 y(C-0244.)2018 1654 y Fp(attacks)33
b(launched)e(remotely)h(via)h(the)g(Internet.)62 b(Such)32
b(attacks)2018 1754 y(may)17 b(utilize)h(a)f(v)n(ariety)g(of)g
(techniques,)f(e.g.,)h(e)o(xploit)g(softw)o(are)g(er)n(-)2018
1853 y(rors)22 b(in)g(pri)n(vile)o(ged)e(programs)g(to)i(gain)f
Fm(root)g Fp(pri)n(vile)o(ge,)g(e)o(xploit)2018 1953
y(vulnerabilities)26 b(in)h(system)g(con\002guration)e(to)i(access)g
(con\002den-)2018 2053 y(tial)j(data,)g(or)f(rely)f(on)h(a)g(le)o
(gitimate)f(system)h(user)g(to)g(do)n(wnload)2018 2152
y(and)21 b(run)f(a)i(le)o(gitimate-looking)c(T)m(rojan)i(Horse)h
(program)e(that)j(in-)2018 2252 y(\003icts)f(damage.)i
Fq(Intrusion)c(detection)f Fp(refers)h(to)h(a)g(broad)e(range)h(of)2018
2352 y(techniques)27 b(that)h(ha)n(v)o(e)f(been)h(de)n(v)o(eloped)d(o)o
(v)o(er)i(the)h(past)g(se)n(v)o(eral)2018 2451 y(years)j(to)g(protect)f
(against)h(malicious)f(attacks.)57 b(A)32 b(majority)e(of)2018
2551 y(these)22 b(techniques)e(tak)o(e)i(the)f(passi)n(v)o(e)g
(approach)f(of)h(of)n(\003ine)g(moni-)2018 2650 y(toring)j(of)g(system)
g(\(or)g(user\))g(acti)n(vities)h(to)f(identify)g(those)g(acti)n(v-)
2018 2750 y(ities)29 b(that)g(de)n(viate)e(from)g(the)i(norm)e([1)o(,)h
(26)o(,)h(10)o(,)f(12)o(,)h(17)o(,)f(21)o(])h(or)2018
2850 y(are)g(otherwise)e(indicati)n(v)o(e)g(of)i(attacks)f([14)o(,)g
(18,)g(22)o(].)50 b(More)28 b(re-)2018 2949 y(cently)-5
b(,)27 b(se)n(v)o(eral)f(proacti)n(v)o(e)f(approaches)g(ha)n(v)o(e)h
(emer)o(ged.)42 b(These)2018 3049 y(approaches)25 b(can)h
Fq(pr)m(e)o(vent)g Fp(or)h(isolate)g(attacks)f(before)g(an)o(y)f(dam-)
2018 3149 y(age)20 b(is)h(caused)f([9)o(,)h(13)o(,)f(20)o(,)h(28)o(].)
2118 3266 y(Most)27 b(approaches)d(aimed)i(at)h(pre)n(v)o(enting)d
(intrusions)h([9)o(,)i(13)o(,)2018 3366 y(20)o(,)34 b(28)o(])f(are)f
(based)h(on)f(the)h(follo)n(wing)f(observ)n(ation)e(about)i(at-)2018
3466 y(tacks:)24 b(re)o(gardless)16 b(of)h(the)g(nature)f(of)h(an)g
(attack,)g(damage)f(can)h(ulti-)2018 3565 y(mately)j(be)g(ef)n(fected)f
(only)g(via)h(system)h(calls)g(made)e(by)h(processes)2018
3665 y(running)29 b(on)h(the)g(tar)o(get)f(system.)56
b(It)31 b(is)g(thus)g(possible)f(to)g(iden-)2018 3764
y(tify)c(\(and)f(pre)n(v)o(ent\))e(damage)i(if)h(we)g(can)g(monitor)e
(e)n(v)o(ery)g(system)2018 3864 y(call)h(made)e(by)h(e)n(v)o(ery)e
(process,)j(and)e(launch)g(actions)h(to)g(preempt)2018
3964 y(an)o(y)18 b(damage,)g(e.g.,)g(abort)g(the)g(system)h(call,)g
(change)f(its)h(operands)2018 4063 y(\(e.g.,)f(open)f(a)h(dif)n(ferent)
f(\002le)h(from)f(one)h(that)g(is)h(speci\002ed\))f(or)g(e)n(v)o(en)
2018 4163 y(terminate)i(the)g(process.)2118 4281 y(In)i(addition)e(to)i
(the)h(pre)n(v)o(enti)n(v)o(e)c(approaches,)h(system)i(call)h(in-)2018
4380 y(terception)30 b(can)h(signi\002cantly)f(enhance)f(the)i(po)n
(wer)f(and)h(ef)n(fec-)2018 4480 y(ti)n(v)o(eness)25
b(of)g(most)g(of)n(\003ine)g(intrusion)f(detection)g(techniques)f(that)
2018 4579 y(mak)o(e)18 b(use)g(of)g(system)g(audit)f(data.)24
b(This)19 b(is)g(because)e(system)h(audit)2018 4679 y(logs)24
b(often)e(do)h(not)h(pro)o(vide)d(all)j(of)f(the)h(information)d
(needed)h(for)2018 4779 y(intrusion)e(detection.)25 b(F)o(or)20
b(instance,)g(we)h(may)f(need)g(to)h(kno)n(w)f(the)2018
4878 y(v)n(alue)k(of)f(a)i(string)e(that)h(w)o(as)h(read)f(from)f(a)h
(netw)o(ork)f(connection,)2018 4978 y(the)30 b(tar)o(get)f(of)h(a)g
(symbolic)f(link)g(or)h(contents)f(of)g(a)i(\002le.)54
b(While)2018 5078 y(it)33 b(may)f(be)g(possible)g(to)g(identify)f(and)h
(record)e(all)j(such)f(poten-)2018 5177 y(tially)23 b(useful)f
(information)e(in)j(the)g(audit)f(log,)h(such)f(an)h(approach)2018
5277 y(is)29 b(lik)o(ely)f(to)g(be)g(impractical)f(due)g(to)h(e)o
(xcessi)n(v)o(e)g(o)o(v)o(erheads)d(and)2018 5376 y(disk)e(space)g
(required.)32 b(Consequently)-5 b(,)22 b(e)n(v)o(en)g(of)n(\003ine)g
(techniques)2018 5476 y(can)31 b(bene\002t)f(from)f(acti)n(v)o(e)h
(system)h(call)g(interception,)g(as)g(it)g(en-)2018 5576
y(ables)24 b(them)g(to)g(access)g(all)h(the)e(data)h(needed)f(for)g
(identifying)f(in-)2018 5675 y(trusions,)d(without)h(incurring)d(the)j
(o)o(v)o(erhead)d(for)j(accessing)f(irrel-)2018 5775
y(e)n(v)n(ant)h(information.)1904 6024 y(1)p eop
%%Page: 2 2
2 1 bop -38 533 a Fp(F)o(or)28 b(reasons)g(mentioned)e(abo)o(v)o(e,)i
(the)h(problem)d(of)j(de)n(v)o(elop-)-138 633 y(ing)c(infrastructures)e
(for)i(acti)n(v)o(e)g(interception)e(and)i(modi\002cation)-138
732 y(of)39 b(system)h(calls)g(has)f(attracted)g(a)h(lot)g(of)f
(research)f(attention)-138 832 y([9)o(,)28 b(11)o(,)h(13)o(,)f(20)o(].)
48 b(Modi\002cation)26 b(is)j(ef)n(fected)e(by)g(user)n(-speci\002ed)
-138 932 y(code)f(fragments)g(\(sometimes)g(referred)f(to)j(as)f
Fq(wr)o(apper)o(s)g Fp(or)g Fq(e)n(x-)-138 1031 y(tensions)p
Fp(\))32 b(that)g(are)g(interposed)f(at)h(the)g(system)h(call)g(entry)e
(and)-138 1131 y(e)o(xit)26 b(points.)44 b(These)26 b(research)f(ef)n
(forts)h(ha)n(v)o(e)g(demonstrated)e(that)-138 1230 y(such)29
b(e)o(xtensions)g(can)g(be)g(used)h(to)f(enhance)g(application)f(func-)
-138 1330 y(tionality)d(in)g(a)h(v)n(ariety)e(of)i(w)o(ays,)g(e.g.,)g
(application-speci\002c)d(ac-)-138 1430 y(cess)g(control,)e(intrusion)g
(detection,)h(transparent)e(enhancements)-138 1529 y(for)27
b(security)g(\(e.g.,)h(data)g(encryption\))d(or)i(f)o(ault-tolerance)e
(\(e.g.,)-138 1629 y(data)20 b(replication\).)k(It)d(is)h(important)d
(to)h(note)g(that)h(all)g(of)f(these)h(en-)-138 1729
y(hancements)e(can)h(be)h(obtained)e(using)g(system)i(call)g
(interposition)-138 1828 y Fq(without)16 b(making)g(any)g(c)o(hang)o
(es)f(to)i(the)g(applications)d Fp(themselv)o(es.)-38
1933 y(This)23 b(paper)g(presents)g(a)i(ne)n(w)e(approach)f(for)h
(implementation)-138 2032 y(of)36 b(a)g(system)h(call)f(e)o(xtension)f
(infrastructure.)71 b(Our)35 b(approach)-138 2132 y(is)d(characterized)
e(by)h(a)h(user)n(-le)n(v)o(el)f(implementation)e(lik)o(e)j([13)n(],)
-138 2232 y(where)22 b(the)g(system)g(calls)h(performed)c(by)j(one)g
(process)g(are)g(inter)n(-)-138 2331 y(cepted)17 b(\(and)f(possibly)g
(modi\002ed\))g(by)h(another)f(process.)23 b(This)18
b(ap-)-138 2431 y(proach)k(contrasts)h(with)h(a)g(majority)e(of)h
(approaches)f(in)i(this)g(area)-138 2531 y(that)e(emplo)o(y)f(an)h
(in-k)o(ernel)e(implementation)g(of)i(system-call)g(in-)-138
2630 y(terposition.)28 b(Our)22 b(w)o(ork)f(impro)o(v)o(es)e(upon)i
([13)n(])h(by)g(\(a\))f(pro)o(viding)-138 2730 y(a)k(more)e(e)o(xtensi)
n(v)o(e)g(set)i(of)f(capabilities)g(for)g(e)o(xtension)f(code,)h(\(b\))
-138 2829 y(de)n(v)o(eloping)e(an)j(architecture)e(and)i
(implementation)d(that)j(is)h(eas-)-138 2929 y(ily)e(ported)f(to)h(dif)
n(ferent)e(v)o(ersions)h(of)g(the)h(UNIX)g(operating)e(sys-)-138
3029 y(tem,)28 b(and)e(\(c\))g(presenting)f(a)h(comprehensi)n(v)o(e)e
(e)n(v)n(aluation)g(of)i(the)-138 3128 y(performance)20
b(o)o(v)o(erheads)g(associated)j(with)f(e)o(xtensions.)32
b(Belo)n(w)-5 b(,)-138 3228 y(we)23 b(describe)f(pre)n(vious)f(w)o(ork)
i(in)f(system)h(call)h(interposition)d(and)-138 3328
y(summarize)e(the)h(main)g(bene\002ts)g(of)g(our)f(approach.)-138
3550 y Fl(1.1)90 b(Pr)n(e)o(vious)21 b(W)-7 b(ork)23
b(in)f(System\255Call)h(Inter)o(position)-38 3773 y Fp(In)17
b(this)h(section)f(we)h(re)n(vie)n(w)f(prior)f(research)h(in)h(system)g
(call)g(in-)-138 3872 y(terposition,)25 b(moti)n(v)n(ate)f(user)n(-le)n
(v)o(el)h(implementations)e(of)i(system)-138 3972 y(call)19
b(interception,)e(and)h(summarize)g(the)h(research)f(problems)f(that)
-138 4071 y(ha)n(v)o(e)30 b(not)h(yet)f(been)g(addressed)g(in)h(this)g
(conte)o(xt.)56 b(A)31 b(more)f(e)o(x-)-138 4171 y(tended)19
b(treatment)g(of)h(related)f(w)o(ork)h(can)f(be)h(found)f(in)h(Section)
f(8.)-38 4276 y(Some)j(of)h(the)g(earlier)g(research)f(ef)n(forts)h(in)
g(system)g(call)h(inter)n(-)-138 4375 y(position)16 b(such)g(as)i([16)n
(,)f(15)o(])g(were)g(implemented)e(within)h(libraries.)-138
4475 y(F)o(or)21 b(instance,)h(system)g(calls)h(are)e(accessed)h(via)g
(a)g(wrapper)f(func-)-138 4575 y(tion)27 b(within)h(the)f
Fm(libc)h Fp(library)e(on)h(most)h(UNIX)f(systems.)48
b(By)-138 4674 y(linking)30 b(to)h(a)h(dif)n(ferent)d(library)h(that)i
(contained)d(modi\002ed)h(v)o(er)n(-)-138 4774 y(sions)f(of)f(these)h
(wrapper)e(functions,)i(one)f(could)f(ef)n(fect)h(system)-138
4873 y(call)i(interposition.)50 b(This)30 b(approach)d(has)j(the)f
(bene\002t)g(that)g(it)h(is)-138 4973 y(easy)c(to)g(implement)f(and)g
(v)o(ery)g(ef)n(\002cient.)41 b(An)26 b(important)e(dra)o(w-)-138
5073 y(back)29 b(of)g(this)h(approach)e(is)j(that)e(these)h(wrapper)e
(functions)h(can)-138 5172 y(be)i(bypassed;)j(for)d(instance,)h(it)g
(is)f(possible)g(for)f(a)h(program)d(to)-138 5272 y(directly)d(in)m(v)n
(ok)o(e)f(the)i(system)g(call)g(using)g(a)g(lo)n(wer)f(le)n(v)o(el)g
(mecha-)-138 5372 y(nism)16 b(such)g(as)h(e)o(x)o(ecution)d(of)i(a)h
(softw)o(are)f(interrupt.)22 b(Thus)16 b(this)h(ap-)-138
5471 y(proach)j(is)j(not)e(suitable)h(for)f(security-related)f
(applications)h(such)-138 5571 y(as)g(intrusion)e(detection)g(and)h
(con\002nement.)-38 5675 y(An)34 b(alternati)n(v)o(e)f(approach)f(that)
j(does)f(not)g(suf)n(fer)f(from)g(the)-138 5775 y(abo)o(v)o(e)23
b(dra)o(wback)g(is)j(a)f(k)o(ernel-based)e(implementation.)37
b(In)25 b(par)n(-)2018 533 y(ticular)m(,)i(the)f(system)h(call)g
(interception)d(is)j(implemented)e(within)2018 633 y(the)i(operating)e
(system)i(k)o(ernel,)h(and)e(all)h(of)g(the)g(e)o(xtension)e(code)2018
732 y(\(for)17 b(all)i(processes)f(being)f(monitored\))f(runs)i(in)g
(the)g(k)o(ernel)g(mode.)2018 832 y(This)i(approach)e(has)i(been)f
(adopted)g(by)g(most)h(researchers)f(in)h(this)2018 932
y(area)30 b([9)o(,)g(11)o(,)g(20)o(,)g(28)o(].)54 b(One)29
b(of)h(the)g(primary)e(adv)n(antages)g(of)h(a)2018 1031
y(k)o(ernel-based)g(approach)g(is)j(lo)n(w)e(interception)g(o)o(v)o
(erhead.)54 b(The)2018 1131 y(o)o(v)o(erheads)27 b(for)h(system)h(call)
g(interposition)e(are)i(determined)d(al-)2018 1230 y(most)j(entirely)f
(by)h(the)g(e)o(xtension)f(code.)50 b(Moreo)o(v)o(er)m(,)28
b(a)i(k)o(ernel-)2018 1330 y(based)c(implementation)d(of)n(fers)i(more)
g(po)n(wer)g(in)h(terms)g(of)g(what)2018 1430 y(can)e(be)g(done)f
(within)h(e)o(xtension)f(code,)h(e.g.,)g(e)o(xtensions)f(can)h(be)2018
1529 y(e)o(x)o(ecuted)16 b(with)h(the)g(same)h(process)f(conte)o(xt)f
(as)h(the)h(process)f(being)2018 1629 y(monitored.)50
b(Ho)n(we)n(v)o(er)m(,)29 b(the)g(po)n(wer)f(af)n(forded)f(by)h(k)o
(ernel-mode)2018 1729 y(operation)19 b(brings)g(some)h(serious)g(dra)o
(wbacks)e(as)j(well:)2101 1874 y Fu(\017)41 b Fp(normal)29
b(protection)f(mechanisms)g(that)i(guard)e(against)i(er)n(-)2184
1974 y(rors)21 b(in)g(one)f(process)g(from)g(damaging)e(another)i
(process)g(do)2184 2073 y(not)31 b(apply)g(for)f(code)h(e)o(x)o(ecuted)
e(in)j(k)o(ernel-mode.)55 b(Hence)2184 2173 y(it)29 b(is)f(possible)g
(for)f(errors)f(in)i(the)g(e)o(xtension)e(code)h(for)g(one)2184
2273 y(process)19 b(to)h(corrupt)d(the)j(memory)e(or)h(\002les)h(used)f
(by)g(another)2184 2372 y(process,)24 b(or)f(e)n(v)o(en)f(w)o(orse,)i
(bring)e(do)n(wn)g(the)i(entire)f(system.)2184 2472 y(Unless)e(we)g
(are)f(e)o(xtremely)f(careful,)g(there)h(is)h(thus)f(a)h(poten-)2184
2572 y(tial)e(for)e(making)f(the)i(system)g Fq(less)h(secur)m(e)f
Fp(by)f(adding)g(e)o(xten-)2184 2671 y(sions!)2101 2827
y Fu(\017)41 b Fp(state-of-the-art)g(in)j(k)o(ernel-resident)d(softw)o
(are)i(de)n(v)o(elop-)2184 2927 y(ment)j(lags)h(user)n(-le)n(v)o(el)e
(softw)o(are)h(de)n(v)o(elopment)e(signi\002-)2184 3026
y(cantly)-5 b(.)68 b(This)34 b(mak)o(es)h(it)g(much)f(more)g
(cumbersome)e(and)2184 3126 y(error)n(-prone)17 b(to)k(write)f(the)g(e)
o(xtension)f(code.)2101 3282 y Fu(\017)41 b Fp(addition)24
b(of)h(code)g(at)h(the)f(k)o(ernel-le)n(v)o(el)e(will)j(require)e
(supe-)2184 3381 y(ruser)h(pri)n(vile)o(ges.)37 b(Thus,)25
b(it)h(is)f(dif)n(\002cult)g(in)f(a)i(k)o(ernel-based)2184
3481 y(approach)g(for)h(normal)f(users)i(to)g(de)n(v)o(elop)d(or)j
(deplo)o(y)e(their)2184 3581 y(o)n(wn)20 b(e)o(xtensions.)2101
3736 y Fu(\017)41 b Fp(k)o(ernel-based)14 b(implementations)g(require)h
(k)o(ernel)g(modi\002ca-)2184 3836 y(tions,)20 b(which)e(may)h(be)g
(vie)n(wed)g(as)h(too)f(risk)o(y)g(and)f(hence)h(not)2184
3936 y(widely)h(accepted.)2018 4081 y(These)i(f)o(actors)f(moti)n(v)n
(ated)g([13)n(])h(to)g(de)n(v)o(elop)e(a)i(user)n(-le)n(v)o(el)f
(imple-)2018 4181 y(mentation)27 b(of)g(an)g(infrastructure)f(for)h
(con\002ning)f(the)h(actions)h(of)2018 4281 y(helper)21
b(applications)f(launched)g(from)h(a)h(web-bro)n(wser)d(or)i(a)h(mail)
2018 4380 y(reader)-5 b(.)37 b(Speci\002cally)-5 b(,)24
b(the)o(y)f(used)h(the)g(capabilities)g(pro)o(vided)e(by)2018
4480 y(the)31 b(Solaris)h(operating)d(system)i(to)g(intercept)f(the)i
(system)f(calls)2018 4579 y(made)k(by)f(a)i(helper)e(application)f
(\(i.e.,)38 b(a)e(monitored)c(process\))2018 4679 y(within)19
b(a)h(monitoring)d(process.)24 b(T)-7 b(ypically)i(,)18
b(the)i(monitoring)d(pro-)2018 4779 y(cess)i(runs)e(with)g(the)h(same)f
(pri)n(vile)o(ges)f(as)j(the)e(monitored)e(process.)2018
4878 y(Ho)n(we)n(v)o(er)m(,)28 b(due)g(to)g(their)g(focus)f(on)h
(helper)f(applications)g(on)h(the)2018 4978 y(Solaris)e(operating)d
(system,)k(se)n(v)o(eral)e(important)f(problems)g(such)2018
5078 y(as)39 b(the)g(portability)-5 b(,)40 b(e)o(xpressi)n(v)o(e)d(po)n
(wer)h(and)f(performance)f(of)2018 5177 y(user)n(-le)n(v)o(el)23
b(system)h(call)h(interposition)d(were)i(not)g(e)o(xplored.)34
b(F)o(or)2018 5277 y(instance,)40 b(the)o(y)35 b(study)g(performance)e
(of)j(CPU-intensi)n(v)o(e)f(code)2018 5376 y(that)41
b(mak)o(es)f(fe)n(w)h(system)g(calls,)46 b(e.g.,)f Fm(ghostscript)39
b Fp(and)2018 5476 y Fm(mpeg)p 2223 5476 25 4 v 29 w(play)p
Fp(.)65 b(Ov)o(erheads)31 b(for)i(system-call)g(intensi)n(v)o(e)f
(appli-)2018 5576 y(cations)c(such)f(as)h(netw)o(ork)f(and)g(\002le)h
(serv)o(ers)f(were)g(not)g(studied.)2018 5675 y(In)e(addition,)g(their)
g(focus)g(on)g(application-speci\002c)e(access)i(con-)2018
5775 y(trol)16 b(requires)f(only)g(limited)h(capabilities)g(for)f(the)h
(e)o(xtension)f(code,)p eop
%%Page: 3 3
3 2 bop 155 513 1364 4 v 153 605 4 92 v 170 605 V 222
577 a Fk(Application)p 623 605 V 144 w(Real)18 b(time)p
1054 605 V 158 w(Real)h(time)p 1501 605 V 1517 605 V
153 696 V 170 696 V 623 696 V 674 669 a(\(Lo)n(w)g(load\))p
1054 696 V 100 w(\(High)g(load\))p 1501 696 V 1517 696
V 155 699 1364 4 v 153 791 4 92 v 170 791 V 222 763 a(gzip)p
623 791 V 497 w Fj(<)p Fk(2\045)p 1054 791 V 287 w Fj(<)p
Fk(2\045)p 1501 791 V 1517 791 V 153 882 V 170 882 V
222 855 a(ghostscript)p 623 882 V 298 w Fj(<)p Fk(5\045)p
1054 882 V 250 w Fj(<)p Fk(10\045)p 1501 882 V 1517 882
V 153 973 V 170 973 V 222 946 a(tar)p 623 973 V 606 w(5\045)p
1054 973 V 309 w(10\045)p 1501 973 V 1517 973 V 153 1065
V 170 1065 V 222 1037 a(cp)g(-r)p 623 1065 V 546 w(5\045)p
1054 1065 V 309 w(10\045)p 1501 1065 V 1517 1065 V 153
1156 V 170 1156 V 222 1129 a(ftpd)p 623 1156 V 505 w
Fj(<)p Fk(2\045)p 1054 1156 V 309 w(30\045)p 1501 1156
V 1517 1156 V 153 1247 V 170 1247 V 222 1220 a(httpd)p
623 1247 V 472 w Fj(<)p Fk(5\045)p 1054 1247 V 309 w(35\045)p
1501 1247 V 1517 1247 V 155 1251 1364 4 v -38 1402 a
Fi(Figure)30 b(1.)g(Overhead)g(f)n(or)g(system)h(call)f(inter)n
(cep\255)-38 1502 y(tion)22 b(f)n(or)h(diff)o(erent)f(applications.)
-138 1742 y Fp(e.g.,)e(no)g(attempt)g(w)o(as)i(made)e(to)h(modify)e
(system)i(call)g(data)f(or)h(re-)-138 1841 y(turn)i(code.)37
b(Finally)-5 b(,)24 b(the)o(y)g(did)f(not)h(address)g(portability)f(of)
h(their)-138 1941 y(system)30 b(to)g(other)e(popular)g(v)n(ariants)h
(of)g(UNIX)h(such)f(as)i(Linux.)-138 2041 y(Consequently)-5
b(,)29 b(a)i(comprehensi)n(v)o(e)26 b(treatment)j(of)g(the)h(issues)g
(in)-138 2140 y(user)n(-le)n(v)o(el)d(implementation)f(of)i(system)g
(call)g(e)o(xtension)f(infras-)-138 2240 y(tructures)h(has)h(remained)e
(open.)50 b(W)-7 b(e)30 b(address)f(this)g(problem)e(in)-138
2340 y(this)d(paper)e(and)g(sho)n(w)h(that)g(we)h(can)e(in)i(f)o(act)f
(b)n(uild)g(po)n(werful)e(and)-138 2439 y(ef)n(\002cient)h
(infrastructures)e(at)j(the)f(user)g(le)n(v)o(el.)31
b(The)21 b(k)o(e)o(y)h(contrib)n(u-)-138 2539 y(tions)e(of)g(this)h
(paper)e(are)h(summarized)f(belo)n(w)-5 b(.)-138 2740
y Fl(1.2)90 b(Summary)22 b(of)h(Results)-38 2941 y Fp(In)h(this)h
(paper)m(,)f(we)g(present)g(an)g(approach)f(for)g(implementing)-138
3041 y(a)30 b(system-call)f(interposition)e(infrastructure)g(at)j(the)f
(user)g(le)n(v)o(el.)-138 3140 y(The)20 b(k)o(e)o(y)f(issues)j
(addressed)d(in)h(this)h(paper)e(are:)-55 3294 y Fu(\017)41
b Fq(P)-7 b(ortability)34 b(of)h(e)n(xtension)f(code:)53
b Fp(Clearly)-5 b(,)37 b(an)e(e)o(xtension)28 3393 y(cannot)g(be)h
(used)g(across)h(dif)n(ferent)d(UNIX)i(v)n(ariants)g(if)h(it)28
3493 y(mak)o(es)23 b(use)h(of)g(features)e(unique)h(to)g(one)g(of)h
(these)f(v)n(ariants.)28 3593 y(One)17 b(approach)f(to)h(mak)o(e)h(e)o
(xtensions)e(portable)g(is)j(to)e(restrict)28 3692 y(the)27
b(interf)o(ace)g(pro)o(vided)e(by)i(the)g(interposition)f(infrastruc-)
28 3792 y(ture)35 b(so)g(that)g(it)g(only)f(e)o(xposes)g(features)h
(common)e(to)i(all)28 3892 y(UNIX)24 b(v)n(ariants.)34
b(Ho)n(we)n(v)o(er)m(,)22 b(such)i(an)f(approach)e(is)k(unnec-)28
3991 y(essarily)19 b(restricti)n(v)o(e.)24 b(A)19 b(better)g(alternati)
n(v)o(e)f(is)i(to)f(permit)f(e)o(x-)28 4091 y(tensions)24
b(to)g(access)h(system-speci\002c)f(features,)g(yet)g(assure)28
4190 y(that)19 b(those)f(e)o(xtensions)f(that)i(operate)f(using)g(only)
f(those)i(fea-)28 4290 y(tures)27 b(common)f(across)h(UNIX)h(v)n
(ariants)e(can)h(be)h(used)f(\223as)28 4390 y(is\224)21
b(on)f(these)g(v)n(ariants.)28 4519 y(W)-7 b(e)17 b(tackle)e(this)h
(problem)e(by)h(designing)f(an)h(object-oriented)28 4619
y(interf)o(ace)21 b(that)h(encapsulates)f(OS-dependencies)e(\(in)i
(terms)28 4719 y(of)27 b(system)g(call)g(names)f(as)i(well)f(ar)o
(guments\))e(so)i(that)g(the)o(y)28 4818 y(are)32 b(hidden)f(from)g(e)o
(xtension)f(code.)60 b(Moreo)o(v)o(er)m(,)32 b(our)g(ap-)28
4918 y(proach)j(enables)g(similar)i(system)f(calls)h(\(e.g.,)i(the)e
(man)o(y)28 5018 y(dif)n(ferent)c(system)i(calls)g(for)f(reading)f
(from)g(a)i(\002le\))g(to)f(be)28 5117 y(grouped)c(together)h(so)i
(that)f(the)o(y)g(can)g(be)g(handled)f(in)h(the)28 5217
y(same)22 b(w)o(ay)-5 b(.)29 b(By)22 b(v)n(arying)e(the)i(grouping)d
(as)j(needed)f(for)g(dif-)28 5316 y(ferent)i(UNIX)g(v)n(ariants,)h(it)g
(is)h(possible)e(to)h(write)g(e)o(xtension)28 5416 y(code)17
b(that)g(can)g(be)h(used)f(without)g(an)o(y)f(modi\002cations)g(across)
28 5516 y(these)23 b(v)n(ariants.)33 b(A)23 b(detailed)f(description)g
(of)g(our)g(approach)28 5615 y(in)e(this)h(conte)o(xt)e(can)h(be)g
(found)f(in)h(Section)g(3.)-55 5775 y Fu(\017)41 b Fq(P)-7
b(ortability)40 b(of)h(the)f(inter)m(ception)f(infr)o(astructur)m(e:)65
b Fp(Most)2184 533 y(modern)26 b(v)o(ersions)h(of)h(the)g(UNIX)g
(operating)e(system)i(such)2184 633 y(as)k(Solaris,)i(Linux,)e(IRIX)g
(and)e(OSF/1)i(pro)o(vide)d(a)j(mech-)2184 732 y(anism)i(for)g(one)f
(user)h(process)f(to)i(trace)e(another)g(process)2184
832 y(with)h(the)g(same)g(userid,)j(or)c(if)i(the)e(\002rst)i(process)e
(has)i(the)2184 932 y(permissions)20 b(of)g(the)h(superuser)-5
b(.)24 b(An)d(user)n(-le)n(v)o(el)e(infrastruc-)2184
1031 y(ture)i(can)g(be)h(implemented)d(using)i(this)h(mechanism.)27
b(Ho)n(w-)2184 1131 y(e)n(v)o(er)m(,)34 b(since)e(this)g(mechanism)f
(is)h(intended)f(primarily)f(for)2184 1230 y(deb)n(ugging,)37
b(it)f(does)f(not)g(operate)f(in)i(the)f(same)h(w)o(ay)f(on)2184
1330 y(dif)n(ferent)e(UNIX)i(v)n(ariants,)i(thus)e(posing)f(a)h
(challenge)e(in)2184 1430 y(terms)f(of)g(portability)f(of)h(the)g
(infrastructure.)58 b(W)-7 b(e)34 b(tackle)2184 1529
y(the)27 b(portability)d(problem)h(by)h(partitioning)e(the)i
(infrastruc-)2184 1629 y(ture)17 b(into)g(an)f
(OS/architecture-dependent)d(component)h(and)2184 1729
y(a)47 b(second)d(component)g(that)i(is)g(independent)e(of)h(them.)2184
1828 y(The)36 b(OS-independent)c(component)i(comprises)g(the)i(b)n(ulk)
2184 1928 y(of)30 b(the)f(functionality)f(of)h(our)g(infrastructure.)51
b(It)29 b(uses)i(the)2184 2027 y(primiti)n(v)o(e)18 b(capabilities)g
(pro)o(vided)e(by)j(the)f(OS/architecture-)2184 2127
y(dependent)42 b(component)f(that)j(may)g(ha)n(v)o(e)f(to)h(be)g
(imple-)2184 2227 y(mented)21 b(dif)n(ferently)e(on)i(dif)n(ferent)e
(OS')-5 b(s)23 b(and)d(processor)h(ar)n(-)2184 2326 y(chitectures.)62
b(Our)32 b(approach)f(for)h(making)f(infrastructure)2184
2426 y(portability)19 b(is)i(detailed)f(further)e(in)j(Section)f(4.)
2101 2591 y Fu(\017)41 b Fq(Capabilities)24 b(of)g(e)n(xtension)f
(code:)32 b Fp(e)n(v)o(en)22 b(though)g(most)i(op-)2184
2691 y(erating)h(systems)g(pro)o(vide)f(an)h(ability)g(to)g(intercept)f
(system)2184 2791 y(calls,)31 b(the)o(y)c(do)h(not)g(al)o(w)o(ays)h
(pro)o(vide)d(adequate)h(or)h(con)m(v)o(e-)2184 2890
y(nient)22 b(mechanisms)g(for)g(accessing)g(or)g(modifying)e(the)i
(sys-)2184 2990 y(tem)f(call)f(data.)25 b(F)o(or)20 b(instance:)2284
3155 y Fh(\226)41 b Fp(Some)26 b(UNIX)g(v)n(ariants)g(such)g(as)h
(Linux)f(do)g(not)g(pro-)2367 3255 y(vide)33 b(a)h(w)o(ay)f(to)h(abort)
e(system)i(calls,)j(yet)c(we)h(need)2367 3354 y(these)j(capabilities)g
(to)h(con\002ne)e(applications)g(or)h(to)2367 3454 y(pre)n(v)o(ent)18
b(intrusions.)2284 3586 y Fh(\226)41 b Fp(Modi\002cation)18
b(of)h(v)n(ariable-size)f(data)h(such)g(as)h(strings)2367
3686 y(poses)29 b(a)f(problem,)h(as)g(the)g(ne)n(w)f(v)n(alue)g(may)g
(occup)o(y)2367 3785 y(more)j(space)g(than)g(what)h(w)o(as)g
(originally)e(a)n(v)n(ailable.)2367 3885 y(Thus,)37 b(the)d(ob)o(vious)
e(approach)g(of)h(o)o(v)o(erwriting)f(the)2367 3985 y(data)20
b(will)h(not)f(w)o(ork.)2284 4117 y Fh(\226)41 b Fp(Malicious)c
(applications)f(may)h(attempt)h(to)f(modify)2367 4216
y(system)43 b(call)f(ar)o(guments)f(between)g(the)i(time)f(the)o(y)2367
4316 y(are)27 b(check)o(ed)e(by)i(the)f(monitoring)f(program)f(and)j
(the)2367 4416 y(time)e(the)f(system)h(call)h(is)f(e)o(x)o(ecuted.)37
b(\(Such)24 b(changes)2367 4515 y(are)32 b(possible)h(if)g(the)f
(malicious)g(program)f(is)i(multi-)2367 4615 y(threaded.\))2284
4747 y Fh(\226)41 b Fp(Since)19 b(the)g(monitoring)d(process)j(and)f
(monitored)f(pro-)2367 4847 y(cess)31 b(typically)f(run)f(with)i(the)f
(same)h(pri)n(vile)o(ges,)g(we)2367 4946 y(need)25 b(to)i(guard)d
(against)i(a)g(monitored)e(process)i(from)2367 5046 y(interfering)36
b(with)i(the)g(operation)f(of)g(a)i(monitoring)2367 5145
y(process,)30 b(e.g.,)f(by)f(attempting)f(to)h(kill)h(the)f(monitor)n
(-)2367 5245 y(ing)20 b(process)g(or)f(reduce)g(its)j(priority)-5
b(.)2184 5410 y(Our)17 b(approach)e(for)i(addressing)f(these)h
(problems)f(is)i(also)g(de-)2184 5510 y(scribed)i(in)g(Section)g(4.)
2101 5675 y Fu(\017)41 b Fq(Ef)o(\002ciency:)23 b Fp(As)d(compared)d
(to)i(a)g(k)o(ernel)f(implementation,)f(a)2184 5775 y(user)n(-le)n(v)o
(el)27 b(implementation)f(of)i(system)g(call)g(interception)p
eop
%%Page: 4 4
4 3 bop 15 1962 a @beginspecial 0 @llx 0 @lly 531 @urx
223 @ury 4320 @rwi @setspecial
%%BeginDocument: intercept.eps
%!PS-Adobe-2.0 EPSF-2.0
%%Title: ovu.fig
%%Creator: fig2dev Version 3.1 Patchlevel 2
%%CreationDate: Wed Jun 23 15:56:42 1999
%%For: sekar@rcs-sgi (R. Sekar)
%Magnification: 1.00
%%Orientation: Portrait
%%BoundingBox: 0 0 531 223
%%Pages: 0
%%BeginSetup
%%IncludeFeature: *PageSize Letter
%%EndSetup
%%EndComments
/$F2psDict 200 dict def
$F2psDict begin
$F2psDict /mtrx matrix put
/col-1 {0 setgray} bind def
/col0 {0.000 0.000 0.000 srgb} bind def
/col1 {0.000 0.000 1.000 srgb} bind def
/col2 {0.000 1.000 0.000 srgb} bind def
/col3 {0.000 1.000 1.000 srgb} bind def
/col4 {1.000 0.000 0.000 srgb} bind def
/col5 {1.000 0.000 1.000 srgb} bind def
/col6 {1.000 1.000 0.000 srgb} bind def
/col7 {1.000 1.000 1.000 srgb} bind def
/col8 {0.000 0.000 0.560 srgb} bind def
/col9 {0.000 0.000 0.690 srgb} bind def
/col10 {0.000 0.000 0.820 srgb} bind def
/col11 {0.530 0.810 1.000 srgb} bind def
/col12 {0.000 0.560 0.000 srgb} bind def
/col13 {0.000 0.690 0.000 srgb} bind def
/col14 {0.000 0.820 0.000 srgb} bind def
/col15 {0.000 0.560 0.560 srgb} bind def
/col16 {0.000 0.690 0.690 srgb} bind def
/col17 {0.000 0.820 0.820 srgb} bind def
/col18 {0.560 0.000 0.000 srgb} bind def
/col19 {0.690 0.000 0.000 srgb} bind def
/col20 {0.820 0.000 0.000 srgb} bind def
/col21 {0.560 0.000 0.560 srgb} bind def
/col22 {0.690 0.000 0.690 srgb} bind def
/col23 {0.820 0.000 0.820 srgb} bind def
/col24 {0.500 0.190 0.000 srgb} bind def
/col25 {0.630 0.250 0.000 srgb} bind def
/col26 {0.750 0.380 0.000 srgb} bind def
/col27 {1.000 0.500 0.500 srgb} bind def
/col28 {1.000 0.630 0.630 srgb} bind def
/col29 {1.000 0.750 0.750 srgb} bind def
/col30 {1.000 0.880 0.880 srgb} bind def
/col31 {1.000 0.840 0.000 srgb} bind def

end
save
-54.0 348.0 translate
1 -1 scale

/cp {closepath} bind def
/ef {eofill} bind def
/gr {grestore} bind def
/gs {gsave} bind def
/sa {save} bind def
/rs {restore} bind def
/l {lineto} bind def
/m {moveto} bind def
/rm {rmoveto} bind def
/n {newpath} bind def
/s {stroke} bind def
/sh {show} bind def
/slc {setlinecap} bind def
/slj {setlinejoin} bind def
/slw {setlinewidth} bind def
/srgb {setrgbcolor} bind def
/rot {rotate} bind def
/sc {scale} bind def
/sd {setdash} bind def
/ff {findfont} bind def
/sf {setfont} bind def
/scf {scalefont} bind def
/sw {stringwidth} bind def
/tr {translate} bind def
/tnt {dup dup currentrgbcolor
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add srgb}
  bind def
/shd {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
  4 -2 roll mul srgb} bind def
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def
%%EndProlog

$F2psBegin
10 setmiterlimit
n 0 792 m 0 0 l 612 0 l 612 792 l cp clip
 0.06000 0.06000 sc
/Times-Roman ff 240.00 scf sf
2625 3075 m
gs 1 -1 sc (Stop P2, awake P1) col0 sh gr
7.500 slw
% Polyline
n 1425 2400 m 2925 2400 l 2925 5700 l 1425 5700 l cp gs col0 s gr 
% Polyline
n 4275 2400 m 5850 2400 l 5850 5775 l 4275 5775 l cp gs col0 s gr 
% Polyline
n 5025 5025 m 5025 5025 l gs col0 s gr
/Times-Roman ff 240.00 scf sf
3075 4725 m
gs 1 -1 sc (awake P1) col0 sh gr
/Times-Roman ff 300.00 scf sf
4575 2250 m
gs 1 -1 sc (Kernel) col0 sh gr
/Times-Roman ff 300.00 scf sf
2100 2250 m
gs 1 -1 sc (P) col0 sh gr
% Polyline
n 7425 2400 m 9727 2400 l 9727 5700 l 7425 5700 l cp gs col0 s gr 
/Times-Roman ff 300.00 scf sf
7950 2250 m
gs 1 -1 sc (P) col0 sh gr
/Times-Roman ff 240.00 scf sf
900 5025 m
gs 1 -1 sc (Post-syscall) col-1 sh gr
% Polyline
gs  clippath
7532 2970 m 7506 3115 l 7472 2972 l 7477 3158 l 7537 3156 l  cp clip
n 7500 2895 m 7507 3142 l gs col-1 s gr gr

% arrowhead
n 7532 2970 m 7506 3115 l 7472 2972 l 7503 2995 l 7532 2970 l  cp gs 0.00 setgray ef gr  col-1 s
/Times-Roman ff 240.00 scf sf
975 3675 m
gs 1 -1 sc (extensions) col-1 sh gr
% Polyline
gs  clippath
7537 3429 m 7507 3573 l 7477 3429 l 7477 3615 l 7537 3615 l  cp clip
n 7507 3195 m 7507 3600 l gs col-1 s gr gr

% arrowhead
n 7537 3429 m 7507 3573 l 7477 3429 l 7507 3453 l 7537 3429 l  cp gs 0.00 setgray ef gr  col-1 s
% Polyline
gs  clippath
8774 2922 m 8915 2884 l 8801 2976 l 8967 2892 l 8940 2838 l  cp clip
n 7507 3592 m 8940 2872 l gs col-1 s gr gr

% arrowhead
n 8774 2922 m 8915 2884 l 8801 2976 l 8809 2938 l 8774 2922 l  cp gs 0.00 setgray ef gr  col-1 s
/Times-Roman ff 240.00 scf sf
975 3375 m
gs 1 -1 sc (Pre-syscall) col-1 sh gr
/Times-Roman ff 180.00 scf sf
2205 2340 m
gs 1 -1 sc (1) col-1 sh gr
/Times-Roman ff 180.00 scf sf
6967 2939 m
gs 1 -1 sc (open:) col-1 sh gr
/Times-Roman ff 180.00 scf sf
9016 2827 m
gs 1 -1 sc (open\(...\)) col-1 sh gr
/Times-Roman ff 180.00 scf sf
9203 2940 m
gs 1 -1 sc (.) col-1 sh gr
/Times-Roman ff 180.00 scf sf
9218 3224 m
gs 1 -1 sc (.) col-1 sh gr
/Times-Roman ff 180.00 scf sf
9217 3090 m
gs 1 -1 sc (.) col-1 sh gr
/Times-Roman ff 180.00 scf sf
4574 2963 m
gs 1 -1 sc (entry processing) col-1 sh gr
/Times-Roman ff 240.00 scf sf
975 5325 m
gs 1 -1 sc (extensions) col-1 sh gr
/Times-Roman ff 180.00 scf sf
8070 2355 m
gs 1 -1 sc (2) col-1 sh gr
/Times-Roman ff 180.00 scf sf
7620 4470 m
gs 1 -1 sc (libc) col-1 sh gr
/Times-Roman ff 180.00 scf sf
7566 3202 m
gs 1 -1 sc (int 0x80) col-1 sh gr
/Times-Roman ff 180.00 scf sf
4507 5610 m
gs 1 -1 sc (exit processing) col-1 sh gr
% Polyline
gs  clippath
4980 5491 m 4950 5635 l 4920 5491 l 4920 5677 l 4980 5677 l  cp clip
n 4950 5392 m 4950 5662 l gs col-1 s gr gr

% arrowhead
n 4980 5491 m 4950 5635 l 4920 5491 l 4950 5515 l 4980 5491 l  cp gs 0.00 setgray ef gr  col-1 s
/Times-Roman ff 240.00 scf sf
5100 4125 m
gs 1 -1 sc (syscall) col-1 sh gr
/Times-Roman ff 180.00 scf sf
9188 2497 m
gs 1 -1 sc (.) col-1 sh gr
/Times-Roman ff 180.00 scf sf
9188 2624 m
gs 1 -1 sc (.) col-1 sh gr
% Polyline
n 7425 2700 m 8333 2700 l 8333 4553 l 7425 4553 l cp gs col-1 s gr 
/Times-Roman ff 240.00 scf sf
5100 4425 m
gs 1 -1 sc (processing) col-1 sh gr
/Times-Roman ff 240.00 scf sf
3000 3975 m
gs 1 -1 sc (next syscall) col-1 sh gr
/Times-Roman ff 240.00 scf sf
3300 3675 m
gs 1 -1 sc (Await ) col-1 sh gr
/Times-Roman ff 240.00 scf sf
3000 5625 m
gs 1 -1 sc (next syscall) col-1 sh gr
/Times-Roman ff 240.00 scf sf
3300 5325 m
gs 1 -1 sc (Await ) col-1 sh gr
/Times-Roman ff 240.00 scf sf
5100 3825 m
gs 1 -1 sc (Normal ) col-1 sh gr
% Polyline
n 7425 2887 m 8333 2887 l 8333 3592 l 7425 3592 l cp gs col-1 s gr 
% Polyline
gs  clippath
2280 5229 m 2250 5373 l 2220 5229 l 2220 5415 l 2280 5415 l  cp clip
n 2250 5400 m 2250 4800 l gs col-1 s gr gr

% arrowhead
n 2280 5229 m 2250 5373 l 2220 5229 l 2250 5253 l 2280 5229 l  cp gs 0.00 setgray ef gr  col-1 s
% Polyline
gs  clippath
4771 5363 m 4915 5392 l 4771 5423 l 4957 5422 l 4957 5362 l  cp clip
n 4942 5392 m 2250 5400 l gs col-1 s gr gr

% arrowhead
n 4771 5363 m 4915 5392 l 4771 5423 l 4795 5392 l 4771 5363 l  cp gs 0.00 setgray ef gr  col-1 s
% Polyline
gs  clippath
7356 3292 m 7480 3213 l 7398 3335 l 7532 3206 l 7490 3163 l  cp clip
n 4935 5662 m 7500 3195 l gs col-1 s gr gr

% arrowhead
n 7356 3292 m 7480 3213 l 7398 3335 l 7394 3297 l 7356 3292 l  cp gs 0.00 setgray ef gr  col-1 s
% Polyline
gs  clippath
4995 2964 m 4965 3108 l 4935 2964 l 4935 3150 l 4995 3150 l  cp clip
n 4965 2775 m 4965 3135 l gs col-1 s gr gr

% arrowhead
n 4995 2964 m 4965 3108 l 4935 2964 l 4965 2988 l 4995 2964 l  cp gs 0.00 setgray ef gr  col-1 s
% Polyline
gs  clippath
7665 2899 m 7518 2878 l 7661 2839 l 7475 2851 l 7479 2911 l  cp clip
n 8925 2790 m 7492 2880 l gs col-1 s gr gr

% arrowhead
n 7665 2899 m 7518 2878 l 7661 2839 l 7639 2871 l 7665 2899 l  cp gs 0.00 setgray ef gr  col-1 s
% Polyline
gs  clippath
2346 4830 m 2201 4800 l 2346 4770 l 2160 4770 l 2160 4830 l  cp clip
n 2175 4800 m 4950 4807 l gs col-1 s gr gr

% arrowhead
n 2346 4830 m 2201 4800 l 2346 4770 l 2322 4800 l 2346 4830 l  cp gs 0.00 setgray ef gr  col-1 s
% Polyline
gs  clippath
5107 2822 m 4968 2770 l 5116 2762 l 4932 2735 l 4923 2794 l  cp clip
n 4942 2767 m 7492 3142 l gs col-1 s gr gr

% arrowhead
n 5107 2822 m 4968 2770 l 5116 2762 l 5087 2788 l 5107 2822 l  cp gs 0.00 setgray ef gr  col-1 s
% Polyline
gs  clippath
2346 3180 m 2202 3150 l 2346 3120 l 2160 3120 l 2160 3180 l  cp clip
n 2175 3150 m 4965 3150 l gs col-1 s gr gr

% arrowhead
n 2346 3180 m 2202 3150 l 2346 3120 l 2322 3150 l 2346 3180 l  cp gs 0.00 setgray ef gr  col-1 s
% Polyline
gs  clippath
2280 3579 m 2250 3723 l 2220 3579 l 2220 3765 l 2280 3765 l  cp clip
n 2250 3750 m 2250 3150 l gs col-1 s gr gr

% arrowhead
n 2280 3579 m 2250 3723 l 2220 3579 l 2250 3603 l 2280 3579 l  cp gs 0.00 setgray ef gr  col-1 s
% Polyline
gs  clippath
4824 3712 m 4968 3742 l 4824 3772 l 5010 3772 l 5010 3712 l  cp clip
n 4995 3742 m 2250 3750 l gs col-1 s gr gr

% arrowhead
n 4824 3712 m 4968 3742 l 4824 3772 l 4848 3742 l 4824 3712 l  cp gs 0.00 setgray ef gr  col-1 s
% Polyline
gs  clippath
4980 4629 m 4950 4773 l 4920 4629 l 4920 4815 l 4980 4815 l  cp clip
n 4950 4800 m 4950 3750 l gs col-1 s gr gr

% arrowhead
n 4980 4629 m 4950 4773 l 4920 4629 l 4950 4653 l 4980 4629 l  cp gs 0.00 setgray ef gr  col-1 s
$F2psEnd
rs

%%EndDocument
 @endspecial 510 2145 a Fi(Figure)23 b(2.)g(System)g(call)h(e)o(x)o
(ecution)e(sequence)i(when)e(a)h(pr)n(ocess)h(is)f(monitored.)28
2494 y Fp(incurs)h(the)h(follo)n(wing)e(additional)g(costs.)39
b(First,)26 b(tw)o(o)f(addi-)28 2594 y(tional)20 b(conte)o(xt)g
(switches)h(are)f(introduced)f(for)h(each)g(system)28
2694 y(call)f(in)f(a)h(user)n(-le)n(v)o(el)e(implementation.)22
b(Second,)17 b(the)i(opera-)28 2793 y(tions)f(to)g(access)g(or)g
(modify)e(the)i(memory)e(of)i(the)f(monitored)28 2893
y(process)h(are)h(generally)e(less)j(ef)n(\002cient)e(than)g(those)h(a)
n(v)n(ailable)28 2993 y(to)k(a)h(k)o(ernel)e(implementation.)32
b(T)-7 b(o)23 b(obtain)g(acceptable)f(per)n(-)28 3092
y(formance,)31 b(we)g(adopt)f(the)h(follo)n(wing)e(techniques.)55
b(First,)28 3192 y(we)18 b(emplo)o(y)f(the)h(f)o(astest)h(mechanism)e
(a)n(v)n(ailable)g(under)g(each)28 3292 y(OS)30 b(for)g(implementing)d
(the)j(memory)e(access)i(operations.)28 3391 y(Second,)i(we)e(mak)o(e)g
(use)h(of)f(selecti)n(v)o(e)g(interception)e(capa-)28
3491 y(bility)d(\(where)f(a)h(selected)g(subset)h(of)e(the)h(system)h
(calls)f(are)28 3590 y(intercepted\))16 b(to)i(minimize)f(conte)o(xt)g
(switches)i(on)e(OS')-5 b(s)19 b(that)28 3690 y(pro)o(vide)27
b(this)i(capability)-5 b(.)50 b(Finally)-5 b(,)30 b(we)f(use)g(lazy)g
(derefer)n(-)28 3790 y(encing)24 b(of)i(accesses)g(to)g(the)f
(monitored)f(process)h(memory)-5 b(,)28 3889 y(i.e.,)19
b(operations)e(to)i(access)h(system)f(call)g(ar)o(guments)e(are)i(de-)
28 3989 y(ferred)g(until)i(their)f(v)n(alues)g(are)h(really)f(needed.)
25 b(Using)20 b(these)28 4089 y(techniques,)26 b(we)g(ha)n(v)o(e)g
(been)f(able)h(to)g(obtain)f(good)g(perfor)n(-)28 4188
y(mance)30 b(for)h(user)n(-le)n(v)o(el)f(system)h(call)g(interception,)
h(as)g(de-)28 4288 y(scribed)20 b(further)e(belo)n(w)-5
b(.)-55 4480 y Fu(\017)41 b Fq(P)-7 b(erformance)36 b(analysis:)59
b Fp(F)o(or)36 b(applications)g(such)h(as)h(in-)28 4579
y(trusion)30 b(detection)h(and)f(con\002nement,)i(the)f(o)o(v)o(erhead)
e(due)28 4679 y(to)j(conte)o(xt)f(switch)h(\(typically)e(in)i(the)g
(range)f(of)g(the)h(time)28 4779 y(needed)c(to)i(e)o(x)o(ecute)e
(thousands)g(of)h(instructions\))g(f)o(ar)g(out-)28 4878
y(weighs)e(the)f(o)o(v)o(erhead)e(of)j(memory)e(access)i(operations)f
(or)28 4978 y(e)o(x)o(ecuting)c(the)j(e)o(xtension)e(code)g([25)o(].)38
b(\(See)24 b(Section)g(5)h(for)28 5078 y(details.\))48
b(Thus)27 b(our)g(performance)e(analysis)j(in)g(Section)f(6)28
5177 y(focuses)d(primarily)g(on)g(the)h(o)o(v)o(erhead)d(due)i(to)h
(interception)28 5277 y(alone,)k(while)f(lea)n(ving)f(out)h(the)g(o)o
(v)o(erheads)d(due)j(to)g(e)o(x)o(ecu-)28 5376 y(tion)e(of)g(e)o
(xtension)f(code.)42 b(\(Measuring)24 b(the)i(o)o(v)o(erhead)e(due)28
5476 y(to)30 b(e)o(xtension)f(code)g(e)o(x)o(ecution)f(is)j(not)f
(useful)f(for)h(a)g(com-)28 5576 y(parison)c(of)g(in-k)o(ernel)f(v)o
(ersus)h(user)n(-le)n(v)o(el)g(implementation)28 5675
y(of)20 b(system)g(call)h(interposition.\))h(Figure)e(1)g(summarizes)f
(our)28 5775 y(performance)g(results)j(on)g(a)g(350MHz)f(Pentium)g(II)g
(PC)i(run-)2184 2494 y(ning)e(RedHat)g(5.2)f(Linux.)26
b(The)21 b(table)g(sho)n(ws)g(the)g(o)o(v)o(erhead)2184
2594 y(in)k(terms)f(of)g(increase)g(in)h(percei)n(v)o(ed)d(e)o(x)o
(ecution)g(time)j(\(also)2184 2694 y(kno)n(wn)30 b(as)i(real)f(time\).)
58 b(F)o(or)31 b(measuring)f(real)h(time,)j(light)2184
2793 y(load)25 b(corresponded)e(to)i(one)g(instance)h(of)f(a)h(process)
f(in)h(the)2184 2893 y(case)g(of)g Fm(gzip,)49 b(ghostscript,)e(tar)26
b Fp(and)f Fm(cp)50 b(-r)p Fp(,)2184 2993 y(and)33 b(a)h(throughput)d
(of)i(20Mb/s)g(for)g Fm(httpd)g Fp(and)g Fm(ftpd)p Fp(.)2184
3092 y(A)d(high)f(load)g(corresponds)f(to)i(ten)f(instances)h(of)f(the)
h(pro-)2184 3192 y(cesses)39 b(\(for)d Fm(gzip,)49 b(ghostscript,)f
(tar,)h(cp)g(-)2184 3292 y(r)p Fp(\))25 b(and)g(o)o(v)o(er)e(100Mb/s)h
(throughput)e(for)i(the)h(serv)o(ers.)39 b(Our)2184 3391
y(results)26 b(sho)n(w)f(that)g(for)g(CPU)h(and)e(disk-intensi)n(v)o(e)
g(applica-)2184 3491 y(tions,)19 b(the)f(o)o(v)o(erheads)e(due)i(to)h
(system)f(call)h(interception)e(are)2184 3590 y(v)o(ery)29
b(small.)56 b(Ev)o(en)29 b(for)g(serv)o(ers,)j(where)e(the)g(o)o(v)o
(erhead)e(is)2184 3690 y(moderate)f(under)f(high)i(loads,)h(we)g(belie)
n(v)o(e)e(that)h(the)g(o)o(v)o(er)n(-)2184 3790 y(heads)d(are)h(well-w)
o(orth)e(the)i(increase)f(in)g(security)g(that)h(can)2184
3889 y(be)20 b(obtained)f(using)h(system)g(call)h(interposition.)2018
4043 y(W)-7 b(e)19 b(note)f(that)g(our)g(approach)d(for)j(tackling)f
(portability)g(issues)i(are)2018 4143 y(lar)o(gely)g(applicable)g(to)h
(k)o(ernel-based)e(implementations)g(as)j(well.)2018
4370 y Fr(2)100 b(System)25 b(Ov)o(er)o(view)2118 4579
y Fp(Almost)j(all)g(v)o(ersions)e(of)i(UNIX)f(pro)o(vide)f(a)i
(mechanism)e(for)2018 4679 y(one)k(process)g(to)h(trace)f(and)g
(control)f(the)i(e)o(x)o(ecution)d(of)i(another)2018
4779 y(process)38 b(and/or)e(access)j(its)g(memory)d(using)i(the)g
(system)g(call)2018 4878 y Fm(ptrace)p Fp(.)67 b(The)34
b(primary)e(use)j(of)f(this)h(mechanism)e(has)h(been)2018
4978 y(in)27 b(implementing)d(deb)n(uggers.)40 b(Some)26
b(UNIX)g(v)n(ariants)g(such)g(as)2018 5078 y(Linux)f(pro)o(vide)e(an)i
(enhancement)f(to)h(this)h(mechanism)e(that)i(en-)2018
5177 y(able)c(one)f(process)g(to)h(trace)g(the)g(system)g(calls)g(made)
f(by)h(another)-5 b(.)2018 5277 y(System)23 b(V)g(Release)g(4)g
(\(SVR4\))f(compatible)g(v)o(ersions)f(of)i(UNIX)2018
5376 y(support)14 b(a)i(more)e(po)n(werful)g(and)g(con)m(v)o(enient)f
(mechanism)h(for)g(sys-)2018 5476 y(tem)21 b(call)f(interception)f(via)
h(the)g Fm(/proc)g Fp(interf)o(ace.)2118 5576 y(The)k(sequence)g(of)g
(actions)g(in)m(v)n(olv)o(ed)f(in)i(system)f(call)h(tracing)2018
5675 y(is)34 b(sho)n(wn)e(in)g(Figure)g(2.)62 b(A)33
b(user)g(process)f Fg(P)3427 5687 y Ff(2)3498 5675 y
Fp(in)m(v)n(ok)o(es)f(a)i(sys-)2018 5775 y(tem)e(call)f(such)h(as)g
Fm(open)p Fp(,)h(which)e(refers)g(to)g(an)g(entry)g(point)f(in)p
eop
%%Page: 5 5
5 4 bop 225 1673 a @beginspecial 0 @llx 0 @lly 583 @urx
198 @ury 4320 @rwi @setspecial
%%BeginDocument: arch.eps
%!PS-Adobe-2.0 EPSF-2.0
%%Title: arch.fig
%%Creator: fig2dev Version 3.1 Patchlevel 2
%%CreationDate: Tue Jun 22 16:27:19 1999
%%For: sekar@rcs-sgi (R. Sekar)
%Magnification: 1.00
%%Orientation: Portrait
%%BoundingBox: 0 0 583 198
%%Pages: 0
%%BeginSetup
%%IncludeFeature: *PageSize Letter
%%EndSetup
%%EndComments
/$F2psDict 200 dict def
$F2psDict begin
$F2psDict /mtrx matrix put
/col-1 {0 setgray} bind def
/col0 {0.000 0.000 0.000 srgb} bind def
/col1 {0.000 0.000 1.000 srgb} bind def
/col2 {0.000 1.000 0.000 srgb} bind def
/col3 {0.000 1.000 1.000 srgb} bind def
/col4 {1.000 0.000 0.000 srgb} bind def
/col5 {1.000 0.000 1.000 srgb} bind def
/col6 {1.000 1.000 0.000 srgb} bind def
/col7 {1.000 1.000 1.000 srgb} bind def
/col8 {0.000 0.000 0.560 srgb} bind def
/col9 {0.000 0.000 0.690 srgb} bind def
/col10 {0.000 0.000 0.820 srgb} bind def
/col11 {0.530 0.810 1.000 srgb} bind def
/col12 {0.000 0.560 0.000 srgb} bind def
/col13 {0.000 0.690 0.000 srgb} bind def
/col14 {0.000 0.820 0.000 srgb} bind def
/col15 {0.000 0.560 0.560 srgb} bind def
/col16 {0.000 0.690 0.690 srgb} bind def
/col17 {0.000 0.820 0.820 srgb} bind def
/col18 {0.560 0.000 0.000 srgb} bind def
/col19 {0.690 0.000 0.000 srgb} bind def
/col20 {0.820 0.000 0.000 srgb} bind def
/col21 {0.560 0.000 0.560 srgb} bind def
/col22 {0.690 0.000 0.690 srgb} bind def
/col23 {0.820 0.000 0.820 srgb} bind def
/col24 {0.500 0.190 0.000 srgb} bind def
/col25 {0.630 0.250 0.000 srgb} bind def
/col26 {0.750 0.380 0.000 srgb} bind def
/col27 {1.000 0.500 0.500 srgb} bind def
/col28 {1.000 0.630 0.630 srgb} bind def
/col29 {1.000 0.750 0.750 srgb} bind def
/col30 {1.000 0.880 0.880 srgb} bind def
/col31 {1.000 0.840 0.000 srgb} bind def

end
save
-56.0 335.0 translate
1 -1 scale

/cp {closepath} bind def
/ef {eofill} bind def
/gr {grestore} bind def
/gs {gsave} bind def
/sa {save} bind def
/rs {restore} bind def
/l {lineto} bind def
/m {moveto} bind def
/rm {rmoveto} bind def
/n {newpath} bind def
/s {stroke} bind def
/sh {show} bind def
/slc {setlinecap} bind def
/slj {setlinejoin} bind def
/slw {setlinewidth} bind def
/srgb {setrgbcolor} bind def
/rot {rotate} bind def
/sc {scale} bind def
/sd {setdash} bind def
/ff {findfont} bind def
/sf {setfont} bind def
/scf {scalefont} bind def
/sw {stringwidth} bind def
/tr {translate} bind def
/tnt {dup dup currentrgbcolor
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add srgb}
  bind def
/shd {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
  4 -2 roll mul srgb} bind def
 /DrawEllipse {
	/endangle exch def
	/startangle exch def
	/yrad exch def
	/xrad exch def
	/y exch def
	/x exch def
	/savematrix mtrx currentmatrix def
	x y tr xrad yrad sc 0 0 1 startangle endangle arc
	closepath
	savematrix setmatrix
	} def

/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def
%%EndProlog

$F2psBegin
10 setmiterlimit
n 0 792 m 0 0 l 612 0 l 612 792 l cp clip
 0.06000 0.06000 sc
7.500 slw
% Polyline
n 6330 3110 m 6225 3110 6225 3630 105 arcto 4 {pop} repeat
  6225 3735 7545 3735 105 arcto 4 {pop} repeat
  7650 3735 7650 3215 105 arcto 4 {pop} repeat
  7650 3110 6330 3110 105 arcto 4 {pop} repeat
 cp gs col0 s gr 
% Polyline
n 4755 3110 m 4650 3110 4650 3630 105 arcto 4 {pop} repeat
  4650 3735 5895 3735 105 arcto 4 {pop} repeat
  6000 3735 6000 3215 105 arcto 4 {pop} repeat
  6000 3110 4755 3110 105 arcto 4 {pop} repeat
 cp gs col0 s gr 
% Polyline
n 3330 3110 m 3225 3110 3225 3630 105 arcto 4 {pop} repeat
  3225 3735 4320 3735 105 arcto 4 {pop} repeat
  4425 3735 4425 3215 105 arcto 4 {pop} repeat
  4425 3110 3330 3110 105 arcto 4 {pop} repeat
 cp gs col0 s gr 
% Polyline
gs  clippath
6925 3053 m 7024 3124 l 6902 3108 l 7053 3168 l 7075 3113 l  cp clip
n 6300 2835 m 7050 3135 l gs col0 s gr gr

% arrowhead
n 6925 3053 m 7024 3124 l 6902 3108 l 6914 3080 l 6925 3053 l  cp gs 0.00 setgray ef gr  col0 s
% Polyline
gs  clippath
3820 3096 m 3699 3122 l 3793 3042 l 3648 3115 l 3675 3169 l  cp clip
n 4275 2835 m 3675 3135 l gs col0 s gr gr

% arrowhead
n 3820 3096 m 3699 3122 l 3793 3042 l 3806 3069 l 3820 3096 l  cp gs 0.00 setgray ef gr  col0 s
% Polyline
gs  clippath
7962 4320 m 7842 4290 l 7962 4260 l 7800 4260 l 7800 4320 l  cp clip
n 7815 4290 m 8490 4290 l gs col0 s gr gr

% arrowhead
n 7962 4320 m 7842 4290 l 7962 4260 l 7962 4290 l 7962 4320 l  cp gs 0.00 setgray ef gr  col0 s
/Times-Roman ff 230.00 scf sf
8556 4372 m
gs 1 -1 sc (Runtime System) col0 sh gr
/Times-Roman ff 270.00 scf sf
4425 2835 m
gs 1 -1 sc (Supervisor objects) col0 sh gr
/Times-Roman ff 230.00 scf sf
8325 3810 m
gs 1 -1 sc (Supervisor Interface) col0 sh gr
/Times-Roman ff 210.00 scf sf
3613 4687 m
gs 1 -1 sc (OS/Architecture Dependent Functions) col0 sh gr
/Times-Roman ff 270.00 scf sf
6180 2497 m
gs 1 -1 sc (Monitoring process) col0 sh gr
/Times-Roman ff 270.00 scf sf
5078 5272 m
gs 1 -1 sc (Kernel) col0 sh gr
% Polyline
gs  clippath
5307 2911 m 5316 3034 l 5250 2930 l 5301 3084 l 5358 3065 l  cp clip
n 5250 2835 m 5325 3060 l gs col0 s gr gr

% arrowhead
n 5307 2911 m 5316 3034 l 5250 2930 l 5279 2921 l 5307 2911 l  cp gs 0.00 setgray ef gr  col0 s
% Ellipse
n 1514 4575 562 150 0 360 DrawEllipse gs col0 s gr

/Times-Roman ff 270.00 scf sf
1027 5225 m
gs 1 -1 sc (File) col0 sh gr
% Polyline
n 3150 4425 m 7800 4425 l 7800 4800 l 3150 4800 l cp gs col0 s gr 
/Times-Roman ff 270.00 scf sf
1027 4925 m
gs 1 -1 sc (Mapping) col0 sh gr
% Polyline
gs  clippath
7722 3765 m 7602 3735 l 7722 3705 l 7560 3705 l 7560 3765 l  cp clip
n 7575 3735 m 8250 3735 l gs col0 s gr gr

% arrowhead
n 7722 3765 m 7602 3735 l 7722 3705 l 7722 3735 l 7722 3765 l  cp gs 0.00 setgray ef gr  col0 s
% Polyline
n 3150 3795 m 7800 3795 l 7800 4800 l 3150 4800 l cp gs col0 s gr 
% Polyline
n 952 4575 m 952 5400 l gs col-1 s gr 
% Polyline
n 2077 4575 m 2077 5400 l gs col-1 s gr 
% Arc
gs n 1514.5 4425.0 1125.6 120.0 60.0 arcn
gs col-1 s gr
 gr

/Times-Roman ff 210.00 scf sf
3389 4176 m
gs 1 -1 sc (\(Mostly\) Arch/OS Independent Functions) col-1 sh gr
30.000 slw
% Polyline
n 2955 2557 m 2850 2557 2850 4770 105 arcto 4 {pop} repeat
  2850 4875 7920 4875 105 arcto 4 {pop} repeat
  8025 4875 8025 2662 105 arcto 4 {pop} repeat
  8025 2557 2955 2557 105 arcto 4 {pop} repeat
 cp gs col-1 s gr 
7.500 slw
% Arc
gs  clippath
2976 4117 m 3123 4122 l 2986 4176 l 3170 4145 l 3160 4086 l  cp clip
1677 4553 m 1531 4579 l 1654 4497 l 1482 4568 l 1505 4623 l  cp clip
n 4236.2 10994.6 6961.9 -113.1 -99.0 arc
gs col-1 s gr
 gr

% arrowhead
n 2976 4117 m 3123 4122 l 2986 4176 l 3005 4142 l 2976 4117 l  cp gs 0.00 setgray ef gr  col-1 s
% arrowhead
n 1677 4553 m 1531 4579 l 1654 4497 l 1643 4534 l 1677 4553 l  cp gs 0.00 setgray ef gr  col-1 s
30.000 slw
% Polyline
n 2505 4875 m 2400 4875 2400 5445 105 arcto 4 {pop} repeat
  2400 5550 8370 5550 105 arcto 4 {pop} repeat
  8475 5550 8475 4980 105 arcto 4 {pop} repeat
  8475 4875 2505 4875 105 arcto 4 {pop} repeat
 cp gs col-1 s gr 
$F2psEnd
rs

%%EndDocument
 @endspecial 1207 1855 a Fi(Figure)23 b(3.)g(Components)f(of)g(the)h
(system)-138 2205 y Fm(libc)p Fp(.)41 b(After)25 b(setting)h(up)f(the)h
(ar)o(guments)d(and)i(the)h(system)g(call)-138 2305 y(number)c(in)j
(appropriate)c(re)o(gisters,)k(this)g(code)e(transfers)h(control)-138
2405 y(into)g(the)h(k)o(ernel)f(by)g(using)g(a)h(processor)f(trap)g(or)
g(softw)o(are)h(inter)n(-)-138 2504 y(rupt)e(\(e.g.,)g
Fm(int)49 b(0x80)23 b Fp(in)h(Linux/i386\).)31 b(In)24
b(the)f(k)o(ernel)g(mode,)-138 2604 y(the)f(entry)e(processing)g(code)h
(w)o(ak)o(es)h(up)f(the)h(monitoring)d(process)-138 2703
y Fg(P)-85 2715 y Ff(1)-47 2703 y Fp(,)26 b(which)f(can)f(no)n(w)h(e)o
(xamine)f(or)g(modify)g(the)h(re)o(gisters)g(or)f(the)-138
2803 y(memory)i(of)h Fg(P)317 2815 y Ff(2)355 2803 y
Fp(.)48 b(After)28 b(whate)n(v)o(er)e(processing)g(desired)h(by)g
Fg(P)1772 2815 y Ff(1)1810 2803 y Fp(,)-138 2903 y(it)d(transfers)g
(control)e(back)h(to)h(k)o(ernel,)g(where)f(the)h(actual)f(system)-138
3002 y(call)28 b(functionality)d(is)k(performed.)43 b(Before)27
b(e)o(xiting)g(the)g(system)-138 3102 y(call,)32 b(control)c(is)j
(transferred)d(back)h(into)g Fg(P)1175 3114 y Ff(1)1212
3102 y Fp(,)k(where)c(additional)-138 3202 y(actions)19
b(such)g(as)h(e)o(xamination/modi\002cation)15 b(of)k(the)g(system)h
(call)-138 3301 y(return)27 b(parameters)f(and)h(return)g(code)g(may)g
(be)h(performed.)45 b(Fi-)-138 3401 y(nally)-5 b(,)19
b(control)g(is)i(returned)e(back)g(to)h Fg(P)1009 3413
y Ff(2)1047 3401 y Fp(.)-38 3542 y(In)30 b(order)g(for)h
Fg(P)451 3554 y Ff(1)520 3542 y Fp(to)g(trace)g Fg(P)862
3554 y Ff(2)900 3542 y Fp(,)j(the)d(ef)n(fecti)n(v)o(e)f(userid)g(of)h
Fg(P)1793 3554 y Ff(1)-138 3641 y Fp(must)e(be)g Fm(root)p
Fp(,)i(or)e(the)g(same)g(as)h(the)f(ef)n(fecti)n(v)o(e)f(userid)h(of)f
Fg(P)1772 3653 y Ff(2)1810 3641 y Fp(.)-138 3741 y(One)22
b(of)h(the)f(primary)f(bene\002ts)h(of)h(a)g(user)n(-le)n(v)o(el)e
(interception)g(ap-)-138 3841 y(proach)15 b(is)i(that)f(the)g
(monitoring)e(process)i(does)g(not)g(need)f(the)h(pri)n(v-)-138
3940 y(ile)o(ges)22 b(of)g(superuser)-5 b(.)31 b(This)22
b(means)g(that)h(ordinary)d(users)j(can)f(de-)-138 4040
y(v)o(elop)i(and)g(use)h(system)g(call)g(e)o(xtensions)e(in)i(w)o(ays)g
(the)o(y)f(choose.)-138 4140 y(Equally)15 b(important,)f(the)i
(potential)f(damage)f(caused)h(by)h(the)f(mon-)-138 4239
y(itoring)31 b(process)h(can)g(be)g(no)g(more)f(than)h(what)g(can)g(be)
g(caused)-138 4339 y(by)g(the)h(monitored)d(process.)62
b(Note)33 b(that)f(this)h(is)h(not)e(the)h(case)-138
4438 y(with)21 b(a)g(k)o(ernel-based)d(implementation)h(of)h
(interposition,)f(where)-138 4538 y(\(f)o(aulty\))d(e)o(xtension)h
(code)g(can)g(cause)h(damage)e(that)i(is)h(be)o(yond)c(the)-138
4638 y(damage)k(that)h(can)g(be)g(caused)g(e)n(v)o(en)f(by)h(a)h
(root-o)n(wned)c(process.)-38 4779 y(Our)29 b(system)g(call)h
(interception/e)o(xtension)c(infrastructure)h(is)-138
4878 y(b)n(uilt)21 b(on)g(top)f(of)h(the)g(system)g(call)h(tracing)e(f)
o(acilities)h(pro)o(vided)e(by)-138 4978 y(the)g(dif)n(ferent)f(UNIX)i
(v)n(ariants.)k(The)19 b(o)o(v)o(erall)f(architecture)g(of)h(our)-138
5078 y(system)j(is)h(sho)n(wn)e(in)i(Figure)e(3.)30 b(An)23
b(instance)e(of)h(the)g(infrastruc-)-138 5177 y(ture)h(resides)h
(within)f(a)h(single)f(user)g(process)g(that)g(we)h(call)g
Fq(moni-)-138 5277 y(toring)f(pr)l(ocess)p Fp(.)33 b(A)24
b(single)f(process)f(may)h(monitor)e(\(and)i(control)-138
5376 y(the)c(beha)n(vior)f(of\))g(one)h(or)f(more)h(processes.)24
b(The)19 b(actual)g(code)f(for)-138 5476 y(monitoring)k(a)k(process)e
(resides)h(in)g(a)h Fq(supervisor)f(object)p Fp(,)g(which)-138
5576 y(in)16 b(our)g(implementation)d(is)18 b(a)e(C++)h(object.)23
b(There)15 b(will)i(be)f(se)n(v)o(eral)-138 5675 y(monitoring)27
b(processes)i(running)e(on)i(a)g(system,)j(each)d(monitor)n(-)-138
5775 y(ing)22 b(one)g(or)h(more)f(processes.)32 b(\(There)21
b(will)j(lik)o(ely)e(be)h(at)g(least)h(as)2018 2205 y(man)o(y)e
(monitoring)f(processes)i(as)h(the)f(number)e(of)i(distinct)g(users)
2018 2305 y(that)e(ha)n(v)o(e)e(processes)h(running)e(on)i(the)g
(system.\))2118 2409 y(All)33 b(supervisor)f(classes)i(are)f(deri)n(v)o
(ed)e(from)h(the)h(base)g(class)2018 2508 y Fm(SupIfc)p
Fp(.)24 b(Communication)18 b(between)h(the)h(runtime)e(system)i(and)
2018 2608 y(supervisor)29 b(object)h(happens)f(via)h(method)f(in)m(v)n
(ocations)g(on)h(this)2018 2708 y(interf)o(ace.)58 b(The)31
b(supervisor)f(classes)j(are)e(dynamically)f(loaded)2018
2807 y(into)22 b(the)g(monitoring)e(process)i(as)h(ne)n(w)e(processes)h
(are)g(identi\002ed)2018 2907 y(for)h(monitoring.)30
b(A)24 b(mapping)d(\002le)i(maps)g(a)g(fully-quali\002ed)e(e)o(x)o(e-)
2018 3006 y(cutable)26 b(name)f(into)h(a)g(shared)g(library)f
(containing)f(the)i(code)f(for)2018 3106 y(a)30 b(supervisor)e(class.)
53 b(This)29 b(pro)o(vides)e(a)j(\(static\))f(mechanism)f(to)2018
3206 y(identify)h(which)h(supervisor)e(class)j(will)g(be)f(used)g(to)h
(monitor)d(a)2018 3305 y(process.)61 b(A)33 b(second)f(\(and)f(more)h
(dynamic\))f(mechanism)g(pro-)2018 3405 y(vides)h(for)f(a)h(parent)f
(process)g(to)h(determine)e(which)h(supervisor)2018 3505
y(object)20 b(will)h(be)f(used)g(for)f(monitoring)f(its)j(child.)2118
3608 y(The)c(supervisor)e(objects)i(reside)g(on)f(top)h(of)g(a)g
(runtime)f(support)2018 3708 y(infrastructure)28 b(which)h(consists)i
(of)e(tw)o(o)h(parts.)54 b(Lo)n(wer)29 b(part)h(of)2018
3808 y(the)25 b(runtime)e(system)i(consists)g(of)g(code)f(that)h(is)g
(lar)o(gely)e(speci\002c)2018 3907 y(to)c(dif)n(ferent)e(operating)g
(systems)j(and)e(architectures.)23 b(The)c(dif)n(fer)n(-)2018
4007 y(ences)28 b(here)f(arise)h(not)g(only)f(due)g(to)h(the)f(dif)n
(ferences)f(in)i(system)2018 4106 y(call)19 b(interception)d
(mechanisms)g(\(i.e.,)i(v)n(ariations)f(of)h Fm(ptrace)f
Fp(or)2018 4206 y Fm(/proc)24 b Fp(interf)o(ace\),)g(b)n(ut)g(also)h
(because)e(these)h(interf)o(aces)g(do)g(not)2018 4306
y(typically)f(pro)o(vide)f(all)i(of)g(the)f(capabilities)h(needed)e
(for)i(modify-)2018 4405 y(ing)j(the)f(beha)n(vior)f(of)i(system)f
(calls.)45 b(As)28 b(such,)f(our)f(implemen-)2018 4505
y(tation)21 b(has)g(to)f(access)i(re)o(gisters)e(and)g(other)g
(architecture-speci\002c)2018 4605 y(aspects)k(of)f(the)g(system.)35
b(The)23 b(rest)h(of)f(the)h(runtime)e(system)h(con-)2018
4704 y(sists)h(of)e(code)f(that)h(mak)o(es)g(use)g(of)g(the)g
(OS/architecture-speci\002c)2018 4804 y(functions.)38
b(This)25 b(code)f(remains)g(the)h(same)g(across)g(dif)n(ferent)f(ar)n
(-)2018 4903 y(chitectures)i(and)g(operating)e(systems,)k(e)o(xcept)e
(for)f(minor)g(v)n(aria-)2018 5003 y(tions)j(due)g(to)g(the)g(f)o(act)h
(that)f(the)g(system)g(call)h(names)f(and)f(ar)o(gu-)2018
5103 y(ments)20 b(v)n(ary)g(slightly)f(across)i(dif)n(ferent)d(UNIX)i
(v)n(ariants.)2018 5348 y Fr(3)100 b(Super)o(visor)26
b(Interface)2118 5576 y Fp(The)j(supervisor)f(interf)o(ace)g(is)j
(designed)d(so)i(that)f(supervisor)2018 5675 y(classes)g(can)e(be)h
(written)f(without)g(ha)n(ving)f(intimate)i(kno)n(wledge)2018
5775 y(of)p eop
%%Page: 6 6
6 5 bop -76 533 a Fp(1.)41 b(ho)n(w)20 b(system)g(call)h(interception)d
(is)j(performed)-76 710 y(2.)41 b(internal)19 b(codes)h(used)g(to)h
(identify)e(dif)n(ferent)f(system)i(calls)-76 888 y(3.)41
b(architecture/OS-speci\002c)16 b(w)o(ays)j(to)f(access)h(system)g
(call)f(ar)n(-)28 988 y(guments)h(or)h(return)f(v)n(alue)-76
1165 y(4.)41 b(OS-speci\002c)24 b(mechanisms)f(to)h(read)f(or)h(modify)
e(monitored)28 1265 y(process)e(data)-138 1459 y(In)g(addition,)f(the)h
(interf)o(ace)f(should)g(pro)o(vide:)-76 1653 y(5.)41
b(support)14 b(functions)g(to)i(control)e(e)o(x)o(ecution)g(of)h(the)g
(monitored)28 1752 y(process)-76 1930 y(6.)41 b(abstraction)23
b(mechanisms)g(for)g(writing)h(a)g(supervisor)e(class)28
2029 y(without)i(ha)n(ving)h(to)g(hard-code)e(system)i(call)h(names)e
(or)h(ar)n(-)28 2129 y(gument)16 b(types)i(speci\002c)f(to)h(one)f(or)g
(more)g(v)n(ariants)g(of)g(UNIX)-38 2323 y(Our)30 b(\002rst)h(step)g
(is)h(to)e(de\002ne)g(a)h(base)g(class)g(called)g Fm(SupIfc)-138
2423 y Fp(from)17 b(which)h(all)h(supervisor)e(classes)j(are)e(deri)n
(v)o(ed.)23 b(F)o(or)18 b(each)g(sys-)-138 2522 y(tem)k(call)g(there)f
(are)h(tw)o(o)f(methods)g(in)h(the)f(interf)o(ace)g(correspond-)-138
2622 y(ing)k(to)h(the)g(entry)f(and)h(e)o(xit)f(for)g(the)h(system)g
(call.)42 b(F)o(or)26 b(instance,)-138 2722 y(corresponding)14
b(to)j(the)g Fm(read)g Fp(system)g(call,)h(the)f(follo)n(wing)e(meth-)
-138 2821 y(ods)20 b(are)g(de\002ned)f(in)i Fm(SupIfc)p
Fp(:)-138 3010 y Fe(void)44 b(read_entry\(Integer&)e(fd,)i(CharPtr&)g
(buf,)579 3101 y(Integer&)g(count\))-138 3193 y(void)g
(read_exit\(Integer&)e(fd,)i(CharPtr&)g(buf,)534 3284
y(Integer&)g(count,)g(Integer&)f(rv\))-38 3478 y Fp(Whene)n(v)o(er)14
b(a)i(monitored)e(process)i Fg(P)28 b Fp(enters)16 b(or)g(e)o(xits)g(a)
g(system)-138 3578 y(call)25 b(\(say)-5 b(,)24 b Fm(read)p
Fp(\))g(the)g(runtime)g(system)g(identi\002es)g(the)h(supervi-)-138
3677 y(sor)c(object)g Fg(S)261 3689 y Fd(P)338 3677 y
Fp(monitoring)e Fg(P)34 b Fp(and)21 b(in)m(v)n(ok)o(es)f(the)i
(corresponding)-138 3777 y(entry)27 b(or)h(e)o(xit)g(\(i.e.,)i
Fm(read)p 697 3777 25 4 v 29 w(entry)e Fp(or)g Fm(read)p
1302 3777 V 29 w(exit)p Fp(\))g(method)-138 3876 y(on)19
b(it.)26 b(This)19 b(approach)f(addresses)h(issues)h(\(1\))f(and)g
(\(2\))g(mentioned)-138 3976 y(abo)o(v)o(e.)30 b(T)-7
b(o)23 b(address)f(issue)h(\(3\),)f(the)h(system)f(call)h(ar)o(guments)
e(and)-138 4076 y(return)g(v)n(alue)h(are)h(passed)f(e)o(xplicitly)f
(as)j(ar)o(guments)c(to)j(the)f(entry)-138 4175 y(or)e(e)o(xit)g
(methods.)-38 4278 y(Issue)h(\(4\))g(is)i(addressed)d(by)h
(encapsulating)f(each)h(system)h(call)-138 4377 y(ar)o(gument)15
b(in)j(an)f(object.)24 b(This)17 b(frees)h(the)f(supervisor)f(object)h
(from)-138 4477 y(ha)n(ving)22 b(to)h(deal)f(with)h(the)g(details)g(of)
f(layouts)h(of)f(system)h(call)g(ar)n(-)-138 4577 y(guments)18
b(data)g(on)g(a)i(particular)d(OS/architecture,)g(or)i(the)f(mecha-)
-138 4676 y(nisms)k(to)g(be)f(used)h(to)f(read)g(the)h(memory)e(of)h
(the)h(monitored)d(pro-)-138 4776 y(cess.)41 b(Instead,)26
b(it)g(relies)g(on)f(methods)f(pro)o(vided)f(by)i(the)g(system)-138
4876 y(call)32 b(ar)o(gument)e(classes)j(to)g(con)m(v)o(eniently)28
b(e)o(xamine)j(or)h(modify)-138 4975 y(system)j(call)f(ar)o(guments.)66
b(Finally)-5 b(,)37 b(encapsulation)32 b(of)i(system)-138
5075 y(call)28 b(ar)o(guments)e(in)i(class)h(objects)f(enables)g(lazy)f
(dereferencing)-138 5174 y(of)33 b(ar)o(guments.)62 b(F)o(or)32
b(instance,)k(an)d Fm(Integer)g Fp(object)f(can)h(be)-138
5274 y(constructed)22 b(with)i(a)g(\002eld)g(recording)d(the)j(re)o
(gister)e(in)i(which)f(the)-138 5374 y(ar)o(gument)g(is)k(located.)40
b(If)25 b(the)h(v)n(alue)f(of)g(the)h(re)o(gister)e(is)j(needed,)-138
5473 y(the)21 b(supervisor)e(method)g(will)j(in)m(v)n(ok)o(e)d(a)i
Fm(get)g Fp(operation)e(on)h(it,)i(at)-138 5573 y(which)e(point)f(the)h
(re)o(gister)g(contents)f(can)h(be)g(fetched.)-38 5675
y(T)-7 b(o)32 b(illustrate)g(system)g(call)h(ar)o(gument)d(classes,)36
b(we)c(gi)n(v)o(e)f(an)-138 5775 y(e)o(xample)19 b(of)h(the)g
Fm(CharPtr)f Fp(class)j(belo)n(w:)2018 533 y Fe(class)44
b(CharPtr)g({)2108 624 y(int)g(get\(char)g(*buf,)g(int)g(len\);)2108
716 y(int)g(put\(char)g(*buf,)g(int)g(len\);)2108 807
y(int)g(lockVal\(\);)f(/*)i(ensure)f(that)g(value)g(can't)2198
898 y(be)g(modified)g(by)g(a)h(thread)f(of)g(the)g(monitored)2198
990 y(process)f(before)h(syscall)g(completion)f(*/)2018
1081 y(})2118 1252 y Fp(The)29 b Fm(get)h Fp(and)f Fm(put)h
Fp(ha)n(v)o(e)f(ob)o(vious)f(meanings.)52 b(T)-7 b(o)30
b(under)n(-)2018 1352 y(stand)c(the)g Fm(lockVal)f Fp(operation,)g
(note)g(that)h(if)g(the)g(system)g(call)2018 1452 y(ar)o(gument)h(is)k
(from)d(a)i(re)o(gion)e(of)h(memory)f(shared)g(by)h(multiple)2018
1551 y(threads)38 b(or)g(processes,)k(it)e(may)d(be)i(possible)f(for)g
(one)f(of)i(the)2018 1651 y(threads/processes)33 b(\(other)g(than)h
(the)g(one)g(making)f(the)h(system)2018 1751 y(call\))29
b(to)f(modify)f(the)h(contents)g(referenced)e(by)i(a)g(pointer)f(ar)o
(gu-)2018 1850 y(ment)20 b(between)f(the)g(time)h(it)h(is)g(e)o
(xamined)d(by)h(the)h(supervisor)e(and)2018 1950 y(the)24
b(time)h(it)f(is)h(fetched)e(by)h(the)g(k)o(ernel)f(when)h(the)g
(system)g(call)h(is)2018 2049 y(e)o(x)o(ecuted.)33 b(The)23
b Fm(lockVal)g Fp(method)f(is)i(used)g(to)f(indicate)g(to)h(the)2018
2149 y(runtime)g(system)h(that)g(this)h(must)f(not)f(happen.)38
b(The)24 b(implemen-)2018 2249 y(tations)c(of)f(these)h(system)g(call)g
(ar)o(gument)d(classes)k(is)g(pro)o(vided)c(by)2018 2348
y(the)j(runtime)f(system,)i(as)g(described)d(in)j(the)f(ne)o(xt)f
(section.)2118 2448 y(Issue)k(\(5\))f(is)i(addressed)d(by)i(de\002ning)
e(a)j(symmetric)d(interf)o(ace)2018 2548 y(to)d Fm(SupIfc)e
Fp(called)h Fm(RtIfc)g Fp(that)g(de\002nes)g(se)n(v)o(eral)g(support)f
(func-)2018 2647 y(tions)k(such)g(as:)2101 2804 y Fu(\017)41
b Fm(kill)22 b Fp(sends)g(the)f(speci\002ed)h(signal)f(to)h(the)g
(monitored)e(pro-)2184 2904 y(cess.)2101 3065 y Fu(\017)41
b Fm(abort)p Fp(,)i(which)38 b(can)g(be)g(in)m(v)n(ok)o(ed)f(only)h
(from)f(within)h(a)2184 3165 y(method)18 b(in)m(v)n(ok)o(ed)g(on)h
(system)g(call)h(entry)-5 b(,)18 b(pre)n(v)o(ents)g(the)h(sys-)2184
3265 y(tem)e(call)g(from)f(completing.)22 b(An)17 b(ar)o(gument)d(to)j
Fm(abort)g Fp(will)2184 3364 y(specify)f(the)g(v)n(alue)g(to)g(which)g
(the)g(return)f(code)g(should)h(be)g(set)2184 3464 y(to)21
b(before)d(returning)h(control)g(to)h(the)g(calling)g(program.)2101
3625 y Fu(\017)41 b Fm(switch)23 b Fp(action)g(replaces)g(the)g
(current)f(supervisor)g(object)2184 3725 y(with)28 b(a)g(ne)n(w)g
(object)f(belonging)f(to)i(the)g(class)g(speci\002ed)g(as)2184
3825 y(the)e(ar)o(gument.)38 b(This)25 b(ability)h(to)f(dynamically)e
(change)i(the)2184 3924 y(supervisor)i(object)h(is)h(particularly)e
(useful)h(when)g(we)g(sus-)2184 4024 y(pect)h(\(or)f(kno)n(w)g(for)g(a)
h(f)o(act\))g(that)g(a)g(monitored)d(process)j(is)2184
4124 y(misbeha)n(ving,)16 b(and)f(we)i(wish)g(to)g(monitor)e(the)h
(process)g(more)2184 4223 y(closely)36 b(\(or)g(e)n(v)o(en)f(better)m
(,)k(con\002ne)c(its)i(actions\).)72 b(More-)2184 4323
y(o)o(v)o(er)m(,)26 b(the)g(switch)h(capability)e(is)i(useful)e(to)i
(implement)e(so-)2184 4422 y(phisticated)d(policies)h(re)o(garding)d
(which)i(supervisor)f(object)2184 4522 y(should)32 b(monitor)f(a)i
(process)f(after)g(it)h Fm(execve)p Fp(')-5 b(s)32 b(another)2184
4622 y(program.)2018 4779 y(The)24 b(approach)e(presented)i(so)g(f)o
(ar)h(has)f(not)g(addressed)f(issue)i(\(6\),)2018 4878
y(since)35 b(it)g(requires)f(the)g(supervisor)f(class)j(to)e(support)g
(methods)2018 4978 y(with)h(names)f(that)g(e)o(xactly)g(match)g(the)g
(system)h(call)f(names)g(in)2018 5078 y(a)k(particular)f(\(v)o(ersion)f
(of)h(an\))h(operating)d(system.)78 b(T)-7 b(o)38 b(o)o(v)o(er)n(-)2018
5177 y(come)26 b(this)i(problem,)e(we)h(ha)n(v)o(e)f(de)n(v)o(eloped)e
(a)j(higher)f(le)n(v)o(el)g(lan-)2018 5277 y(guage)g(that)h(pro)o
(vides)e(an)h(abstraction)g(by)g(which)g(groups)f(of)i(re-)2018
5376 y(lated)39 b(system)h(calls)g(can)f(be)g(abstracted)f(into)h(a)h
(higher)e(le)n(v)o(el)2018 5476 y(e)n(v)o(ent.)55 b(This)30
b(abstraction)g(mechanism)f(is)i(one)f(of)g(the)g(features)2018
5576 y(of)h(our)g(beha)n(vioral)e(speci\002cation)i(language)e(for)i
(intrusion)f(de-)2018 5675 y(tection/pre)n(v)o(ention)21
b(described)j(in)h([25)o(].)39 b(The)24 b(basic)h(form)f(of)h(an)2018
5775 y(abstract)20 b(e)n(v)o(ent)f(de\002nition)h(is:)p
eop
%%Page: 7 7
7 6 bop -138 533 a Fg(ev)s(entN)9 b(ame)p Fc(\()p 327
466 76 4 v Fg(X)c Fc(\))23 b(::=)3 633 y(\()p Fg(s)74
645 y Ff(1)111 633 y Fc(\()p 143 566 67 4 v Fg(Y)210
645 y Ff(1)247 633 y Fc(\))p Fu(j)p Fg(C)6 b(ond)500
645 y Ff(1)539 633 y Fc(\))p Fu(jj)14 b(\001)g(\001)g(\001)f(jj)p
Fc(\()p Fg(s)858 645 y Fd(n)904 633 y Fc(\()p 936 566
V Fg(Y)1003 645 y Fd(n)1048 633 y Fc(\))p Fu(j)p Fg(C)6
b(ond)1301 645 y Fd(n)1347 633 y Fc(\))-138 774 y Fp(W)-7
b(e)32 b(ha)n(v)o(e)d(used)i(the)f(shorthand)p 860 708
76 4 v 28 w Fg(X)38 b Fp(to)30 b(denote)f(a)i(list)h
Fg(x)1562 786 y Ff(1)1599 774 y Fg(;)14 b(:::;)g(x)1789
786 y Fd(k)-138 874 y Fp(of)26 b(ar)o(guments,)g(and)g
Fg(s)538 886 y Ff(1)575 874 y Fg(;)14 b(:::;)g(s)757
886 y Fd(n)829 874 y Fp(denote)25 b(either)h(a)h(system)g(call)g(or)
-138 974 y(another)e(abstract)g(e)n(v)o(ent.)42 b(\(But)26
b(c)o(yclic)g(de\002nitions)f(are)h(not)g(per)n(-)-138
1073 y(mitted.\))60 b(Each)31 b Fg(C)6 b(ond)580 1085
y Fd(i)641 1073 y Fp(pro)o(vides)30 b(a)i(binding)f(for)g(each)h(of)f
(the)-138 1173 y(v)n(ariables)25 b(in)p 277 1106 V 26
w Fg(X)33 b Fp(in)26 b(terms)g(of)g(the)g(v)n(alues)f(of)h(one)f(or)h
(more)f(v)n(ari-)-138 1272 y(ables)20 b(in)p 138 1206
67 4 v 20 w Fg(Y)205 1284 y Fd(i)232 1272 y Fp(.)26 b(Additionally)-5
b(,)17 b Fg(C)6 b(ond)932 1284 y Fd(i)981 1272 y Fp(may)19
b(consist)h(of)g(conditions)-138 1372 y(on)h(the)g(v)n(ariables)f(in)p
495 1305 V 21 w Fg(Y)f Fp(.)28 b(The)21 b(condition)e(and)i(e)o
(xpression)e(syntax)-138 1472 y(are)h(similar)h(to)f(that)g(of)g(C++.)
-38 1582 y(An)28 b(abstract)g(e)n(v)o(ent)f(that)h(denotes)g
(operations)e(to)i(read)g(a)h(\002le)-138 1681 y(using)18
b(a)i(\002le)g(descriptor)d(operand)g(can)i(be)g(de\002ned)f(as)h
(follo)n(ws)g(for)-138 1781 y(Linux:)-138 2008 y Fe(readFd\(Integer)42
b(fd\))j(::=)-48 2100 y(read\(fd,_,_\)||readdir\(fd,_,_\)||)41
2191 y(getdents\(fd,_,_\)||readv\(fd,)c(_,)j(_\))-38
2416 y Fp(Here,)37 b(\223)p 224 2416 25 4 v 30 w(\224)e(denotes)f(an)g
(ar)o(gument)e(whose)i(v)n(alue)g(is)h(not)g(of)-138
2515 y(interest)27 b(for)g(de\002ning)e(the)j(abstract)f(e)n(v)o(ent.)
44 b(The)27 b(same)h(abstract)-138 2615 y(e)n(v)o(ent)19
b(may)h(be)g(de\002ned)f(dif)n(ferently)f(for)i(OSF/1:)-138
2842 y Fe(readFd\(Integer)42 b(fd\))j(::=)-48 2934 y
(read\(fd,_,_\)||pread\(fd,_,_\)||)41 3025 y
(getdirentries\(fd,_,_,_\)||readv\(fd,_,_\))-38 3250
y Fp(Prede\002ned)37 b(collections)g(of)h(such)g(abstract)h(e)n(v)o
(ents)e(can)h(be)-138 3349 y(speci\002ed)f(in)h Fq(interface)f
(de\002nitions)p Fp(,)j(which)d(serv)o(e)g(a)h(purpose)-138
3449 y(similar)18 b(to)g(OS-speci\002c)g(header)f(\002les.)25
b(The)17 b(supervisor)g(class)i(can)-138 3549 y(no)n(w)h(be)g
(de\002ned)g(in)h(an)f(operating)f(system)h(independent)e(f)o(ashion)
-138 3648 y(by)i(pro)o(viding)d(a)j(method)f(for)g(each)h(of)f(the)h
(abstract)g(e)n(v)o(ents)f(in)h(the)-138 3748 y(interf)o(ace)f
(de\002nition,)g(e.g.,)h Fm(readFd)p Fp(.)-38 3858 y(A)34
b(compiler)f(for)g(the)h(interf)o(ace)f(de\002nitions)h(is)h
(responsible)-138 3958 y(for)22 b(arranging)f(to)i(call)h(the)f(code)f
(corresponding)d(to)24 b(the)f(abstract)-138 4057 y(e)n(v)o(ent)31
b Fg(ev)s(entN)9 b(ame)32 b Fp(whene)n(v)o(er)e(an)o(y)h(of)h
Fg(s)1180 4069 y Ff(1)1218 4057 y Fg(;)14 b(:::;)g(s)1400
4069 y Fd(n)1478 4057 y Fp(are)32 b(called,)-138 4157
y(and)19 b(moreo)o(v)o(er)m(,)e(the)j(corresponding)c(condition)i(is)j
(satis\002ed.)26 b(The)-138 4257 y(code)h(for)h Fg(ev)s(entN)9
b(ame)27 b Fp(is)i(in)m(v)n(ok)o(ed)e(with)h(parameter)f(bindings)-138
4356 y(as)32 b(gi)n(v)o(en)e(by)h(the)g(condition.)56
b(In)31 b(ef)n(fect,)i(the)e(compiler)f(gener)n(-)-138
4456 y(ates)23 b(a)f(stub)g(routine)f(for)h(each)f(system)i(call)f
(that)g(in)h(turn)e(ends)h(up)-138 4555 y(calling)27
b(an)g(operation)e(in)i(the)g(supervisor)f(class)i(with)f(the)g(name)
-138 4655 y(corresponding)17 b(to)j(the)g(abstract)g(e)n(v)o(ent)1022
4625 y Fb(1)1054 4655 y Fp(.)-38 4765 y(W)-7 b(e)19 b(note)f(that)g([9)
o(])h(uses)g(a)f(related)g(approach)e(for)i(making)f(their)-138
4865 y(wrappers)k(portable.)28 b(Our)21 b(interf)o(ace)g(de\002nition)g
(\002les)h(are)g(similar)-138 4965 y(to)27 b(their)g
Fq(c)o(har)o(acterization)f Fp(\002les.)47 b(The)o(y)26
b(mak)o(e)g(use)i(of)f(a)h(notion)-138 5064 y(of)f Fq(ta)o(g)o(ging)f
Fp(system)i(calls,)h(and)e(use)g(the)h(tags)f(in)h(a)g(w)o(ay)f
(similar)-138 5164 y(to)22 b(our)e(abstract)i(e)n(v)o(ent)e(names.)29
b(An)21 b(adv)n(antage)f(of)h(our)f(approach)-138 5263
y(is)g(that)f(e)n(v)o(ent)f(abstractions)g(can)h(be)g(composed,)e
(while)i(tagging)e(is)-138 5363 y(not.)p -138 5459 788
4 v -48 5515 a Fa(1)-18 5538 y Fn(If)f(multiple)j(abstract)g(e)n(v)o
(ents)g(match)e(the)h(same)f(system)g(call,)h(all)g(of)e(them)i(are)
-138 5617 y(in)m(v)o(ok)o(ed)i(in)e(some)g(order)l(.)24
b(Undesirable)c(interactions)h(may)d(arise)h(due)f(to)g(interfer)o(-)
-138 5696 y(ence)k(among)f(actions)h(for)f(these)g(dif)n(ferent)i
(abstract)g(e)n(v)o(ents)f(\226)e(this)h(is)g(an)g(area)g(of)-138
5775 y(current)e(research.)2018 533 y Fl(3.1)91 b(Example)22
b(Super)o(visor)e(Class)2118 740 y Fp(W)-7 b(e)18 b(pro)o(vide)c(an)j
(e)o(xample)e(of)i(a)g(supervisor)e(class)i Fm(Untrust-)2018
840 y(edUtility)22 b Fp(to)g(illustrate)h(the)f(API)h(described)e(so)i
(f)o(ar)-5 b(.)31 b(W)-7 b(e)24 b(de-)2018 939 y(scribe)g(a)g(simple)f
(class)i(which)e(restricts)h(the)g(monitored)d(process)2018
1039 y(from)f(performing)f(man)o(y)g(damaging)h(system)h(calls,)h(and)e
(also)i(re-)2018 1139 y(stricts)28 b(the)e(\002les)i(that)f(can)f(be)h
(opened)e(by)h(the)h(application.)42 b(W)-7 b(e)2018
1238 y(be)o(gin)19 b(by)h(de\002ning)f(abstract)h(e)n(v)o(ents)f(of)h
(interest:)2018 1412 y Fe(deniedCalls)43 b(::=)i
(fork||execve||connect||bind)2108 1503 y
(||listen||chmod||chown||chgrp||kill||pt)o(race)2108
1594 y(||sendto||mkdir||utimes||rename||...)2108 1686
y(/*)f(other)g(disallowed)g(calls)g(omitted)f(*/)2018
1777 y(wrOpen\(f\))h(::=)g(\(open\(f,md\)|isWrite\(md\)\))2108
1868 y(||creat\(f\)||truncate\(f\))2118 2050 y Fp(W)-7
b(e)21 b(ha)n(v)o(e)e(omitted)f(some)i(or)f(all)h(of)g(the)f(trailing)g
(ar)o(guments)f(of)2018 2150 y(some)27 b(system)g(calls)h(in)f(the)h
(abo)o(v)o(e)d(de\002nition)h(for)g(conciseness.)2018
2249 y(After)e(de\002ning)f(the)h(abstract)g(e)n(v)o(ents,)g(we)h(can)f
(then)f(pro)o(vide)g(the)2018 2349 y(implementation)i(of)h(just)h(tw)o
(o)g(methods,)g Fm(deniedCalls)e Fp(and)2018 2449 y Fm(wrOpen)p
Fp(.)g(An)o(y)19 b(system)h(call)h(that)f(does)g(not)g(match)f(one)h
(of)f(these)2018 2548 y(abstract)d(e)n(v)o(ent)e(de\002nitions)h(will)h
(be)g(gi)n(v)o(en)e(the)i(def)o(ault)f(treatment,)2018
2648 y(which)28 b(for)g(most)h(system)f(calls)i(is)f(to)g(continue.)48
b(\(The)28 b(runtime)2018 2747 y(will)23 b(include)e(certain)g
(protection)f(mechanisms)h(that)g(ensure)g(that)2018
2847 y(the)34 b(monitored)d(process)i(cannot)g(mak)o(e)g(system)g
(calls)i(such)e(as)2018 2947 y Fm(kill)22 b Fp(on)g(the)g(monitoring)d
(process.\))30 b(The)22 b(implementations)e(of)2018 3046
y(these)h(tw)o(o)f(methods)f(may)h(be)g(as)h(follo)n(ws:)2018
3220 y Fe(void)44 b(UntrustedUtility::deniedCalls_entry\(\))39
b({)2108 3311 y(abort\(EPERM\);)2018 3402 y(})2018 3494
y(void)44 b(UntrustedUtility::wrOpen\(CharPtr)c(f\))k({)2108
3585 y(char)g(*fv)g(=)h(f.get\(\);)2108 3676 y(/*)f(we)h(may)f(want)g
(to)h(lockVal\(\),)e(first)h(*/)2108 3768 y(if)g(\(!isInDir\(fv,)f
("/tmp"\))h(&&)g(\(exists\(fv\)\)\))2198 3859 y(abort\(EPERM\);)2018
3950 y(})2118 4132 y Fp(The)28 b(code)f(for)h Fm(wrOpen)f
Fp(uses)i(support)e(functions)g(to)h(deter)n(-)2018 4232
y(mine)f(whether)g(the)g(\002le)i(being)d(opened)g(for)h(write)h(is)g
(inside)g(the)2018 4331 y Fm(/tmp)c Fp(directory)-5 b(,)22
b(and)h(if)h(not,)g(whether)e(it)j(will)f(end)f(up)h(creating)2018
4431 y(a)d(ne)n(w)f(\002le)h(or)f(modifying)d(an)j(e)o(xisting)g(one.)
2018 4663 y Fr(4)100 b(Runtime)25 b(system)2118 4878
y Fp(A)e(monitoring)e(process)h(is)i(started)e(with)h(the)g(name)f(of)h
(an)f(e)o(x-)2018 4978 y(ecutable)k(to)h(be)f(monitored.)42
b(Optionally)-5 b(,)26 b(the)h(name)f(of)g(the)h(su-)2018
5078 y(pervisor)21 b(class)h(to)g(be)g(used)f(for)g(monitoring)f(the)h
(e)o(x)o(ecutable)f(and)2018 5177 y(the)g(name)f(of)g(the)g(\002le)i
(containing)c(the)j(object)f(code)g(for)g(this)h(class)2018
5277 y(may)c(be)h(speci\002ed.)23 b(Otherwise)16 b(an)h(appropriate)d
(supervisor)h(class)2018 5376 y(is)22 b(identi\002ed)d(from)g(the)i
(mapping)d(\002le.)26 b(The)20 b(monitoring)e(process)2018
5476 y(then)24 b(loads)f(the)h(supervisor)e(class)j(and)f(then)f(forks)
g(and)g(uses)i(the)2018 5576 y Fm(attach)j Fp(primiti)n(v)o(e)f(pro)o
(vided)f(by)i(OS-speci\002c)h(module)e(to)h(at-)2018
5675 y(tach)c(to)g(the)g(child)f(process.)36 b(F)o(ollo)n(wing)23
b(this,)i(the)f(child)f(process)2018 5775 y(e)o(x)o(ec')-5
b(s)27 b(the)g(e)o(x)o(ecutable,)f(and)h(no)n(w)f(the)h(process)f(is)i
(set)g(up)f(to)g(be)p eop
%%Page: 8 8
8 7 bop -138 453 4125 4 v -4 563 a Fe(while)44 b(there)g(exist)g
(processes)g(to)g(be)h(monitored)e({)131 654 y(pid)h(=)h
(waitForCall\(\);)d(/*)j(wait)f(for)g(a)h(monitored)e(process)h(to)h
(enter/exit)e(sys)h(call*/)131 746 y(call)g(=)h(getscno\(pid\);)131
837 y(if)f(\(isEntry\(call\)\))f({)265 928 y(/*)i(Pre-entry)e
(processing,)g(details)h(omitted)g(*/)265 1019 y(switch)g(\(call\))g
({/*)g(get)h(system)f(call)g(identifier)f(*/)400 1111
y(case)h(OPEN_ENTRY:)534 1202 y
(supObj[id].open_entry\(scInfo[OPEN_ENTRY][0)o(],)803
1293 y(scInfo[OPEN_ENTRY][1],)e(scInfo[OPEN_ENTRY][2]\);)f(break;)400
1385 y(/*)j(cases)g(for)h(other)f(system)g(calls)g(not)g(shown)g(*/)265
1476 y(})265 1567 y(/*)h(Post-entry)e(processing)g(\(omitted\))h(*/)131
1659 y(})131 1750 y(else)g(if)h(\(isExit\(call\)\))d({)265
1841 y(/*)j(Pre-exit)e(processing)h(\(omitted\))f(*/)265
1933 y(switch)h(\(call\))g({/*)g(get)h(system)f(call)g(identifier)f(*/)
400 2024 y(case)h(OPEN_EXIT:)534 2115 y
(supObj[id].open_exit\(scInfo[OPEN_EXIT][0],)38 b
(scInfo[OPEN_EXIT][1],)803 2207 y(scInfo[OPEN_EXIT][2],)k
(scInfo[OPEN_EXIT][3]\);)f(break;)400 2298 y(/*)j(cases)g(for)h(other)f
(system)g(calls)g(not)g(shown)g(*/)265 2389 y(})265 2481
y(/*)h(Post-exit)e(processing)g(\(omitted\))h(*/)131
2572 y(})131 2663 y(else)g(if)h(\(isSignal\(call\)\))d({)265
2755 y(/*)j(signal)f(related)f(processing)h(\(omitted\))f(*/)131
2846 y(})-4 2937 y(})p -138 3032 V 1103 3175 a Fi(Figure)23
b(4.)g(Main)h(loop)e(of)g(the)h(runtime)g(system)-138
3442 y Fp(monitored)31 b(by)i(an)g(object)f(of)h(the)g(speci\002ed)g
(supervisor)f(class.)-138 3542 y(When)c(the)g(runtime)f(system)h(is)h
(monitoring)d(one)h(or)h(more)f(pro-)-138 3642 y(cesses,)21
b(it)g(is)g(e)o(x)o(ecuting)d(within)i(a)h(loop)e(sho)n(wn)g(in)i
(Figure)e(4.)-38 3741 y(The)28 b(functions)f Fm(waitForCall)g
Fp(and)h Fm(getscno)g Fp(are)g(pro-)-138 3841 y(vided)16
b(by)g(the)g(architecture/OS-speci\002c)f(component)f(of)i(the)g(run-)
-138 3941 y(time)i(system.)24 b(This)18 b(component)e(also)i(includes)f
(the)h(de\002nition)f(of)-138 4040 y(the)26 b(array)f
Fm(scInfo)g Fp(which)h(speci\002es)g(the)g(re)o(gisters)f(\(or)g(of)n
(fsets)-138 4140 y(into)e(the)g(k)o(ernel-maintained)d(user)j
(structure)g(for)f(the)h(monitored)-138 4239 y(process\))15
b(that)i(contain)e(the)h(system)g(call)h(ar)o(guments.)22
b(System)16 b(call)-138 4339 y(ar)o(gument)29 b(class)j(objects)f(such)
f(as)i Fm(Integer)f Fp(and)f Fm(CharPtr)-138 4439 y Fp(are)16
b(constructed)f(from)g(these)h(re)o(gister)g(numbers.)22
b(\(This)16 b(step)g(hap-)-138 4538 y(pens)h(implicitly)-5
b(,)17 b(thanks)h(to)f(the)h(type)f(con)m(v)o(ersion)e(rules)j(of)f
(C++.\))-138 4638 y(Finally)-5 b(,)28 b(the)f(runtime)f(looks)h(up)g
(its)h(association)f(table)g(to)g(iden-)-138 4738 y(tify)c(the)g
(supervisor)e(object)i(corresponding)c(to)24 b(the)f(process)f(that)
-138 4837 y(made)27 b(the)h(system)g(call,)i(and)d(the)h(corresponding)
c(entry)j(or)g(e)o(xit)-138 4937 y(method)f(is)i(in)m(v)n(ok)o(ed)d(on)
i(this)h(class.)46 b(On)27 b(return)f(from)g(this)i(call,)-138
5036 y(the)20 b(monitoring)e(process)i(goes)g(back)f(into)h
Fm(waitForCall)p Fp(.)-38 5136 y(While)27 b(the)g(action)f(of)g(the)h
(runtime)f(system)g(to)h(most)g(system)-138 5236 y(call)e(entry)f(and)g
(e)o(xit)g(operations)f(are)i(similar)f(to)h(that)g(for)f
Fm(open)p Fp(,)-138 5335 y(some)c(operations)f(require)g(special)h
(treatment:)-55 5476 y Fu(\017)41 b Fm(fork)p Fp(:)27
b(the)21 b(runtime)f(system)i(needs)e(to)i(identify)e(the)h(pid)g(of)28
5576 y(the)28 b(child)g(process,)h(and)f(be)g(ready)f(to)h(monitor)f
(it.)49 b(More-)28 5675 y(o)o(v)o(er)m(,)32 b(the)f(supervisor)f
(object)g(itself)i(is)g(cloned,)h(with)e(one)28 5775
y(cop)o(y)20 b(monitoring)e(the)j(parent)e(process)h(and)g(another)f
(moni-)2184 3442 y(toring)g(the)i(child.)2101 3662 y
Fu(\017)41 b Fm(execve)p Fp(:)25 b(no)19 b(special)h(processing)e(is)i
(required)e(on)h(the)h(part)2184 3762 y(of)h(the)h(runtime)e(system.)28
b(If)21 b(the)g(current)f(supervisor)g(object)2184 3862
y(requires)d(the)g(ne)n(w)g(process)g(to)g(be)g(monitored)f(by)h(a)g
(dif)n(ferent)2184 3961 y(supervisor)g(object,)g(it)i(e)o(xplicitly)e
(in)m(v)n(ok)o(es)g Fm(switch)g Fp(opera-)2184 4061 y(tion)j(from)e
(its)j Fm(execve)p 2919 4061 25 4 v 29 w(entry)e Fp(method)f(with)i
(the)f(appro-)2184 4160 y(priate)j(shared)f(library)f(name)h(and)g
(class)i(name)e(for)g(the)h(ne)n(w)2184 4260 y(supervisor)d(class.)27
b(Alternati)n(v)o(ely)-5 b(,)18 b(the)j Fm(switch)e Fp(operation)2184
4360 y(may)32 b(specify)g(a)g(mapping)f(\002le)h(that)h(is)g(look)o(ed)
e(up)h(to)g(de-)2184 4459 y(termine)24 b(the)g(supervisor)f(based)h(on)
g(the)h(e)o(x)o(ecutable)d(name.)2184 4559 y(Switching)d(to)h(a)g(ne)n
(w)g(object)f(will)h(be)g(done)f(as)h(part)g(of)f(post-)2184
4659 y(supervisor)g(processing.)2101 4878 y Fu(\017)41
b Fm(kill)p Fp(:)23 b(since)16 b(the)g(runtime)e(system)i(typically)f
(runs)g(with)h(the)2184 4978 y(same)26 b(userid)g(as)g(the)g(process)f
(being)g(monitored,)g(we)h(ha)n(v)o(e)2184 5078 y(to)21
b(be)f(careful)g(to)g(ensure)g(that)g(the)h(monitored)d(process)i(can-)
2184 5177 y(not)30 b(kill)h(the)f(monitoring)e(process)i(or)g
(otherwise)g(damage)2184 5277 y(its)d(ability)f(to)g(monitor)f(it.)43
b(This)26 b(is)h(ensured)d(by)i(intercept-)2184 5376
y(ing)e(e)n(v)o(ery)f(\223potentially)g(dangerous\224)f(system)i(call)h
(such)f(as)2184 5476 y Fm(kill)p Fp(,)30 b(and)e(permitting)f(it)i(to)f
(go)g(through)f(only)g(if)i(it)g(will)2184 5576 y(not)24
b(af)n(fect)g(this)h(or)f(other)f(monitoring)f(processes.)37
b(A)24 b(simi-)2184 5675 y(lar)17 b(remark)e(applies)i(to)g(se)n(v)o
(eral)f(other)g(system)h(calls)g(that)g(can)2184 5775
y(interfere)i(with)i(the)f(monitoring)e(process.)p eop
%%Page: 9 9
9 8 bop -55 533 a Fu(\017)41 b Fm(exit)p Fp(:)27 b(on)20
b(completion)f(of)i(the)g(entry)f(function,)f(the)i(super)n(-)28
633 y(visor)h(object)g(for)g(the)h(monitored)d(process)i(is)i(destro)o
(yed)d(by)28 732 y(the)f(runtime)f(system.)-138 932 y
Fl(4.1)90 b(Implementation)97 b(of)g(System)g(Call)g(Ar)o(gu\255)67
1032 y(ment)23 b(Classes)-38 1232 y Fp(The)c(runtime)f(system)i(also)g
(pro)o(vides)e(the)h(implementation)f(of)-138 1332 y(the)29
b(system)h(call)f(ar)o(gument)e(classes.)53 b(These)29
b(implementations)-138 1431 y(are)d(made)f(independent)f(of)h(the)h(OS)
h(and)e(machine)g(architecture)-138 1531 y(by)20 b(using)f(the)h
(functions)f(pro)o(vided)e(by)j(the)g(architecture-speci\002c)-138
1631 y(module.)j(The)18 b(implementation)e(of)j(these)f(classes)i(is)f
(mostly)f(rou-)-138 1730 y(tine,)f(e)o(xcept)e(for)h(the)g(w)o(ay)h(in)
f(which)g(we)h(deal)f(with)h(modi\002cations)-138 1830
y(to)24 b(the)f(memory)f(referenced)f(by)i(pointer)f(ar)o(guments,)g
(which)h(we)-138 1930 y(discuss)e(further)d(belo)n(w)-5
b(.)-38 2029 y(F)o(or)19 b(instance,)f(if)i(we)f(ha)n(v)o(e)g(a)h
(\002lename)f(ar)o(gument,)d(and)j(w)o(ould)-138 2129
y(lik)o(e)j(to)g(modify)e(it,)j(this)f(can)g(be)f(done)g(in)h(place)g
(if)g(the)f(ne)n(w)h(name)-138 2228 y(is)h(smaller)g(than)f(the)g(old)g
(one.)31 b(Otherwise,)23 b(we)f(need)g(to)h(allocate)-138
2328 y(ne)n(w)g(storage,)f(and)g(change)g(the)h(system)f(call)i(ar)o
(gument)c(v)n(alue)i(to)-138 2428 y(point)h(to)h(this)h(ne)n(w)f
(location.)35 b(The)24 b(catch)f(is)i(that)f(this)h(ne)n(w)f(loca-)-138
2527 y(tion)19 b(must)h(be)g(within)f(the)h(address)f(space)h(of)f(the)
h(monitored)d(pro-)-138 2627 y(cess,)25 b(and)d(it)i(is)h(dif)n
(\002cult)d(to)i(identify)e(unused)g(sections)h(of)g(mem-)-138
2727 y(ory)i(from)f(the)i(monitoring)d(process.)41 b(Our)25
b(approach)e(is)k(to)f(allo-)-138 2826 y(cate)e(ne)n(w)g(storage)g(on)f
(the)h(stack)h(be)o(yond)d(the)i(top)f(of)h(stack.)37
b(W)-7 b(e)-138 2926 y(\002nd)26 b(that)h(normally)-5
b(,)26 b(the)h(allo)n(w)o(able)f(stack)h(size)g(is)h(much)e(lar)o(ger)
-138 3025 y(\(by)f(se)n(v)o(eral)h(MBs\))h(than)f(the)g(v)n(alue)g(of)g
(stack)g(pointer)m(,)g(so)h(all)g(of)-138 3125 y(this)21
b(space)f(can)g(be)g(used.)-38 3225 y(Re)o(gardless)f(of)h(whether)f
(the)h(ne)n(w)g(v)n(alue)g(requires)f(more)g(stor)n(-)-138
3324 y(age)25 b(space)h(than)f(old)g(v)n(alue,)h(we)f(may)g(choose)g
(to)h(store)f(the)h(ne)n(w)-138 3424 y(v)n(alue)20 b(at)h(a)g(random)d
(location)i(on)g(the)g(stack.)26 b(The)20 b(moti)n(v)n(ation)f(for)-138
3524 y(this)27 b(is)g(as)g(follo)n(ws.)42 b(There)25
b(is)i(a)g(windo)n(w)e(of)h(time)g(between)f(the)-138
3623 y(assignment)j(of)g(a)h(ne)n(w)f(v)n(alue)g(to)h(a)g(system)g
(call)g(ar)o(gument)d(and)-138 3723 y(the)31 b(time)h(when)e(these)i
(ar)o(guments)d(are)i(actually)g(fetched)f(from)-138
3822 y(user)g(memory)f(for)h(system)h(call)g(e)o(x)o(ecution)d(by)i
(the)h(k)o(ernel.)55 b(In)-138 3922 y(a)26 b(multithreaded)d(en)m
(vironment,)g(one)i(of)g(the)h(threads)f(can)g(mak)o(e)-138
4022 y(a)33 b(system)h(call,)i(while)d(the)g(other)f(tries)i(to)f
(locate)f(and)h(modify)-138 4121 y(the)28 b(system)g(call)h(ar)o
(gument)d(back)h(to)h(its)h(original)e(v)n(alue.)48 b(Ev)o(en)-138
4221 y(w)o(orse,)34 b(the)e(\002rst)h(thread)d(may)i(pro)o(vide)d(a)j
(v)n(alid-looking)d(ar)o(gu-)-138 4321 y(ment)24 b(\(e.g.,)g(a)h
(\002le)g(name\))f(which)g(is)h(permitted)e(by)h(the)h(supervi-)-138
4420 y(sor)k(object,)h(while)e(the)h(second)f(thread)f(changes)h(the)h
(\002le)g(name)-138 4520 y(to)g(an)f(unacceptable)e(v)n(alue.)49
b(Putting)28 b(the)h(modi\002ed)e(v)n(alue)h(at)h(a)-138
4619 y(random)23 b(location)g(on)h(the)h(stack)g(implies)f(that)h(the)f
(rogue)f(thread)-138 4719 y(has)g(to)g(search)g(through)e(the)h(entire)
h(stack)g(to)g(identify)f(where)g(the)-138 4819 y(v)n(alue)h(is)h
(stored.)34 b(If)23 b(there)g(is)h(suf)n(\002cient)f(stack)g(space,)h
(say)f(1MB,)-138 4918 y(this)30 b(may)e(tak)o(e)i(millions)f(of)f
(instructions)h(to)g(complete.)51 b(Com-)-138 5018 y(pared)26
b(with)i(this,)i(the)d(time)h(windo)n(w)e(being)h(e)o(xploited)f(is)i
(prob-)-138 5118 y(ably)c(much)g(smaller)m(,)h(say)-5
b(,)26 b(se)n(v)o(eral)e(hundred)e(instructions.)38 b(This)-138
5217 y(implies)24 b(that)h(the)f(probability)e(of)i(the)g(rogue)f
(thread)g(succeeding)-138 5317 y(in)d(its)i(ef)n(fort)d(is)i(v)o(ery)e
(small)673 5287 y Fb(2)706 5317 y Fp(.)p -138 5381 788
4 v -48 5436 a Fa(2)-18 5460 y Fn(A)c(rogue)i(program)f(may)g(try)g(to)
g(circumv)o(ent)j(this)d(approach)i(by)e(lea)o(ving)i(v)o(ery)-138
5538 y(little)26 b(room)d(on)g(the)h(stack)h(where)f(the)g(runtime)h
(system)e(may)h(store)g(ar)o(guments.)-138 5617 y(Since)c(typical)g
(programs)f(e)o(x)o(ecute)i(with)e(se)n(v)o(eral)i(MBs)d(of)g(a)o(v)n
(ailable)k(stack)d(space)-138 5696 y(at)h(all)h(times,)f(we)g(may)g
(simply)g(terminate)i(the)e(process)h(when)f(insuf)n(\002cient)i(stack)
-138 5775 y(space)c(\(say)l(,)f(less)g(than)h(1MB\))f(is)g(detected.)
2118 533 y Fp(The)29 b(race)h(condition)d(with)j(respect)f(to)h
(checking)e(of)h(system)2018 633 y(call)f(parameter)d(v)n(alues)h
(stored)h(within)f(user)h(memory)e(w)o(as)j(\002rst)2018
732 y(addressed)22 b(in)h([11)n(].)33 b(The)o(y)22 b(identi\002ed)g
(their)g(ability)h(to)g(deal)f(with)2018 832 y(the)i(race)g(conditions)
f(reliably)g(as)i(one)f(of)g(the)g(bene\002ts)g(of)g(an)g(in-)2018
932 y(k)o(ernel)17 b(implementation.)k(While)d(a)g(similar)g(guarantee)
d(can)i(prob-)2018 1031 y(ably)25 b(ne)n(v)o(er)f(be)i(pro)o(vided)d
(in)i(a)h(user)n(-le)n(v)o(el)f(implementation,)f(we)2018
1131 y(belie)n(v)o(e)f(that)g(approaches)f(such)h(as)h(ours)f(that)h(e)
o(xploit)e(some)h(sort)2018 1230 y(of)18 b(randomization)d(can)j
(reduce)e(the)i(success)g(probability)e(of)i(such)2018
1330 y(race)24 b(attacks)h(to)f(a)h(ne)o(gligible)d(v)n(alue.)36
b(Ne)n(v)o(ertheless,)24 b(it)h(must)g(be)2018 1430 y(noted)g(that)h
(successful)f(attacks)h(can)f(go)h(undetected,)f(in)g(the)h(ab-)2018
1529 y(sence)20 b(of)g(k)o(ernel)g(support.)2018 1750
y Fl(4.2)91 b(Ar)n(chitectur)n(e)21 b(dependent)g(primiti)o(v)o(es)2118
1971 y Fp(This)28 b(module)f(contains)g(the)h(lo)n(west)h(le)n(v)o(el)e
(functions)g(whose)2018 2071 y(implementations)19 b(will)j(v)n(ary)d
(signi\002cantly)h(across)h(dif)n(ferent)e(op-)2018 2170
y(erating)28 b(systems)h(and/or)e(processor)g(architectures.)49
b(The)28 b(func-)2018 2270 y(tions)20 b(pro)o(vided)e(by)i(this)h
(module)d(include:)2101 2449 y Fu(\017)41 b Fm(getScNum,)48
b(isEntry,)h(isExit,)f(isSignal)p Fp(:)2184 2549 y(get)42
b(the)g(system)g(call)h(number)d(\(or)h(signal)h(recei)n(v)o(ed)e(by)
2184 2649 y(the)33 b(monitored)d(process\))i(as)h(an)f(OS-independent)d
(v)n(alue,)2184 2748 y(identify)21 b(if)h(we)h(intercepted)d(a)i
(system)g(call)h(entry)-5 b(,)21 b(e)o(xit)g(or)h(a)2184
2848 y(signal.)31 b(This)23 b(module)e(also)h(needs)g(to)h(identify)e
(the)h(re)o(gister)2184 2947 y(numbers)d(where)h(the)g(system)g(call)h
(ar)o(guments)d(are)i(stored.)2101 3131 y Fu(\017)41
b Fm(getReg,)49 b(setReg)p Fp(:)h(get)32 b(or)h(set)h(the)e(v)n(alues)h
(of)f(re)o(gis-)2184 3231 y(ters.)80 b(W)-7 b(e)39 b(note)f(that)g(re)o
(gister)g(numbers)e(do)i(not)g(neces-)2184 3331 y(sarily)26
b(correspond)d(to)i(the)h(processor)e(hardw)o(are)g(re)o(gisters.)2184
3430 y(The)o(y)k(are)i(simply)f(handles)f(created)g(by)h(the)g
(architecture-)2184 3530 y(dependent)19 b(module)g(to)i(refer)f(to)h
(some)f(location)g(within)h(the)2184 3629 y(user)37 b(structure)g(\(or)
f(an)o(ywhere)f(else)j(within)f(the)g(process)2184 3729
y(control)24 b(block\))g(that)h(can)f(be)h(read)g(or)f(modi\002ed)g(by)
h(the)g(ar)n(-)2184 3829 y(chitecture)19 b(dependent)f(module.)2101
4013 y Fu(\017)41 b Fm(getData,)49 b(setData,)f(getText)p
Fp(:)i(Read)34 b(or)f(mod-)2184 4112 y(ify)28 b(the)g(memory)f(of)h
(the)g(monitored)e(process.)48 b(Its)29 b(imple-)2184
4212 y(mentation)h(is)j(dif)n(ferent)c(for)i Fm(ptrace)g
Fp(and)g(SVR4)h(based)2184 4311 y(OSes.)47 b(F)o(or)27
b Fm(ptrace)p Fp(-based)e(interf)o(ace,)j(reading)e(or)h(writ-)2184
4411 y(ing)21 b(b)n(ulk)g(data)h(can)f(be)g(inef)n(\002cient,)g(so)g
(we)h(emplo)o(y)e(an)o(y)h(OS)2184 4511 y(or)e(architecture)e
(speci\002c)i(enhancements)d(to)j(these)g(capabil-)2184
4610 y(ities,)35 b(e.g.,)f(we)e(use)g(the)f Fm(/mem)h
Fp(f)o(acility)f(in)h(Linux)e(which)2184 4710 y(permits)20
b(ef)n(\002cient)g(reads)g(b)n(ut)g(not)g(writes.)2101
4894 y Fu(\017)41 b Fm(attachProcess,)47 b(waitForCall)p
Fp(:)94 b(Again,)63 b(the)2184 4993 y(implementations)53
b(of)i(these)h(operations)d(are)i(dif)n(ferent)2184 5093
y(across)21 b Fm(ptrace)e Fp(and)h Fm(/proc)g Fp(interf)o(aces.)2101
5277 y Fu(\017)41 b Fm(abort)p Fp(:)h(SVR4-compatible)27
b(UNIX)h(v)o(ersions)g(pro)o(vide)e(a)2184 5376 y(special)j(operation)d
(for)i(aborting)e(system)j(calls.)50 b(Still,)31 b(we)2184
5476 y(needed)22 b(to)h(de)n(v)o(elop)e(a)i(w)o(ay)g(to)g(modify)e(the)
i(return)f(code)g(so)2184 5576 y(that)j(an)o(y)e(v)n(alue)h(chosen)f
(by)h(the)h(supervisor)e(object)g(can)i(be)2184 5675
y(pro)o(vided)17 b(to)i(the)f(monitored)f(program,)g(rather)h(than)g
(the)h(de-)2184 5775 y(f)o(ault)27 b(v)n(alue)f(in)h(SVR4)h(which)e
(indicates)g(an)h(error)f Fm(EINTR)p eop
%%Page: 10 10
10 9 bop 18 453 1656 4 v 16 553 4 100 v 68 523 a Fp(T)-6
b(estCase)p 415 553 V 134 w(Normal)p 835 553 V 204 w(T)m(ime)p
1252 553 V 171 w(Ov)o(erhead)p 1673 553 V 16 653 V 415
653 V 466 623 a(e)o(x)o(ecution)p 835 653 V 126 w(spent)20
b(in)p 1252 653 V 1673 653 V 16 752 V 415 752 V 553 722
a(time)p 835 752 V 185 w(e)o(xtension)p 1252 752 V 1673
752 V 18 756 1656 4 v 16 855 4 100 v 151 825 a(ftpd)p
415 855 V 273 w(2.2s)p 835 855 V 260 w(0.03s)p 1252 855
V 242 w(1.5\045)p 1673 855 V 18 858 1656 4 v 16 958 4
100 v 105 928 a(telnetd)p 415 958 V 227 w(3.1s)p 835
958 V 260 w(0.04s)p 1252 958 V 242 w(1.3\045)p 1673 958
V 18 961 1656 4 v 16 1061 4 100 v 132 1031 a(httpd)p
415 1061 V 271 w(5.8)p 835 1061 V 276 w(0.09s)p 1252
1061 V 242 w(1.5\045)p 1673 1061 V 18 1064 1656 4 v -36
1214 a Fi(Figure)i(5.)i(System)f(call)h(interposition)e(o)n(verhead.)28
1393 y Fp(\(system)28 b(call)h(interrupted\).)46 b(The)28
b Fm(ptrace)f Fp(implementa-)28 1493 y(tion)i(in)g(Linux)f(pro)o(vides)
f(no)i(w)o(ay)g(to)g(abort)g(system)g(calls.)28 1593
y(Our)19 b(approach)f(is)i(to)g(modify)e(the)h(system)h(call)g(ar)o
(gument)d(to)28 1692 y(a)j(v)n(alue)f(that)g(w)o(ould)g(cause)h(the)f
(call)h(to)g(f)o(ail.)25 b(W)-7 b(e)21 b(then)e(inter)n(-)28
1792 y(cept)24 b(the)g(system)h(call)f(e)o(xit)g(and)g(set)h(the)f
(return)f(v)n(alues)h(and)28 1892 y(parameters)f(as)i(appropriate.)35
b(Identifying)22 b(such)i(ar)o(gument)28 1991 y(v)n(alues)f(\(that)g
(cause)g(system)h(calls)g(to)g(f)o(ail\))f(is)h(f)o(airly)f(simple)28
2091 y(in)28 b(most)g(cases,)j(e.g.,)e(null)f(pointer)f(v)n(alue)h(for)
f(\002le)i(names.)28 2190 y(Ho)n(we)n(v)o(er)m(,)16 b(some)i(calls)h
(do)e(not)h(tak)o(e)g(ar)o(guments,)e(so)i(this)h(ap-)28
2290 y(proach)d(f)o(ails.)24 b(F)o(ortunately)-5 b(,)15
b(most)j(such)f(system)g(calls)h(either)28 2390 y(do)h(not)g(change)f
(system)h(state)h(\(so)f(no)g(harm)f(in)i(letting)f(them)28
2489 y(complete,)d(plus)h(we)g(can)g(modify)e(the)i(return)f(v)n
(alues\),)h(or)f(are)28 2589 y(not)k(permitted)e(to)i(be)g(e)o(x)o
(ecuted)e(e)n(v)o(en)h(by)g(superuser)n(-o)n(wned)28
2689 y(processes)j(\(e.g.,)h Fm(setup)f Fp(and)g Fm(idle)h
Fp(in)g(Linux\).)31 b(Notable)28 2788 y(e)o(xceptions)d(are)i
Fm(fork)g Fp(and)f Fm(exit)p Fp(.)54 b(W)m(ith)30 b(fork,)h(our)e(ap-)
28 2888 y(proach)d(is)i(to)f(kill)g(the)g(child)g(before)e(it)j
(completes)f(its)h(\002rst)28 2987 y(system)e(call.)41
b(W)m(ith)25 b(e)o(xit,)h(it)h(is)f(ar)o(guable)d(whether)h(there)h(is)
28 3087 y(an)o(y)19 b(merit)h(in)h(aborting)d(it,)j(so)f(we)h(simply)f
(let)h(it)g(complete.)-138 3333 y Fr(5)99 b(An)31 b(A)n(pplication)f
(in)g(Intrusion)g(Detection)h(and)11 3449 y(Con\002nement)-38
3678 y Fp(W)-7 b(e)35 b(ha)n(v)o(e)e(b)n(uilt)h(a)g(system)g(for)f
(intrusion)f(detection,)k(appli-)-138 3778 y(cation)27
b(con\002nement)e(and)h(application-speci\002c)f(access)j(control)-138
3878 y(based)e(on)f(system)i(call)f(interposition)f([25)n(,)i(26)o(].)
43 b(Our)25 b(approach)-138 3977 y(is)k(based)f(on)g(specifying)f
(security-rele)n(v)n(ant)f(properties)g(of)i(pro-)-138
4077 y(grams)d(as)h(patterns)f(o)o(v)o(er)f(sequences)g(of)h(system)h
(calls)g(e)o(x)o(ecuted)-138 4177 y(by)19 b(processes.)25
b(Our)19 b(speci\002cation)g(language)f(enables)i(us)g(to)g(cap-)-138
4276 y(ture)j(conditions)f(on)h(system)h(call)g(names)f(as)i(well)f(as)
g(their)f(ar)o(gu-)-138 4376 y(ments.)29 b(Response)22
b(actions)g(can)f(be)h(associated)f(with)h(each)g(secu-)-138
4475 y(rity)28 b(property)-5 b(,)27 b(and)g(these)h(responses)f(will)h
(be)g(triggered)e(when-)-138 4575 y(e)n(v)o(er)18 b(the)h(property)d
(is)k(violated.)j(These)c(actions)f(may)h(be)f(used)h(for)-138
4675 y(a)j(v)n(ariety)f(of)h(purposes)e(such)i(as)h(disallo)n(wing)d
(the)i(violating)f(sys-)-138 4774 y(tem)d(call,)h(modifying)c(its)k(ar)
o(gument)d(so)i(that)g(a)g(dif)n(ferent)f(resource)-138
4874 y(from)j(the)i(one)e(speci\002ed)h(in)h(the)f(system)g(call)h(is)g
(manipulated,)e(or)-138 4974 y(terminating)i(the)h(process.)33
b(A)24 b(compiler)e(translates)h(these)g(speci-)-138
5073 y(\002cations)i(into)g(C++)g(code)g(for)f(a)h(supervisor)f
(object.)39 b(This)25 b(code)-138 5173 y(is)20 b(compiled)d(with)i(the)
f(C++)i(compiler)d(and)h(then)g(link)o(ed)g(with)h(the)-138
5272 y(system)k(call)g(interposition)e(infrastructure)f(to)j(pro)o
(vide)e(intrusion)-138 5372 y(detection)e(and)h(con\002nement.)-38
5476 y(The)g(results)i(sho)n(wn)e(in)h(Figure)f(5)h(were)g(obtained)f
(with)h(a)g(run-)-138 5576 y(time)c(system)f(that)h(uses)g(in-k)o
(ernel)e(system)h(call)h(interposition)e([4)o(].)-138
5675 y(Thus)i(an)o(y)g(o)o(v)o(erhead)e(measurements)i(relating)g(to)g
(system)h(call)h(in-)-138 5775 y(terception)f(or)h(data)g(access)h
(cannot)e(be)h(e)o(xtrapolated)e(to)i(the)g(user)n(-)2018
533 y(le)n(v)o(el)31 b(interposition)e(approach.)56 b(Ho)n(we)n(v)o(er)
m(,)32 b(the)f(results)g(do)g(es-)2018 633 y(tablish)21
b(that)g(our)f(approach)f(of)i(achie)n(ving)e(portability)h(of)g
(system)2018 732 y(call)f(e)o(xtensions)e(\(using)g(the)h
Fm(SupIfc)g Fp(interf)o(ace)f(and)h(the)g(system)2018
832 y(call)26 b(ar)o(gument)e(classes,)k(which)d(are)g(implemented)f
(in)i(the)f(same)2018 932 y(w)o(ay)f(in)g(both)f(runtime)g(systems\))h
(is)h(ef)n(fecti)n(v)o(e.)35 b(The)o(y)23 b(also)h(sho)n(w)2018
1031 y(that)32 b(the)g(o)o(v)o(erhead)d(due)j(to)g(the)g(e)o(x)o
(ecution)d(of)j(e)o(xtension)e(code)2018 1131 y(is)c(v)o(ery)d(small)i
(\227)g(in)f(f)o(act,)h(it)h(is)f(ne)o(gligible)e(as)i(compared)d(to)j
(the)2018 1230 y(o)o(v)o(erheads)15 b(for)i(system)h(call)g
(interception)d(and)i(ar)o(gument)e(access.)2018 1330
y(Consequently)-5 b(,)25 b(in)h(a)g(user)n(-le)n(v)o(el)e(approach)g
(such)h(as)i(ours,)f(o)o(v)o(er)n(-)2018 1430 y(all)18
b(performance)d(for)i(applications)f(such)h(as)i(intrusion)d
(detection,)2018 1529 y(con\002nement)23 b(and)h(access)i(control)d
(can)i(be)f(measured)g(purely)f(in)2018 1629 y(terms)c(of)g(the)g(o)o
(v)o(erheads)e(for)i(system)g(call)h(interception)d(and)i(data)2018
1729 y(access.)44 b(\(This)25 b(is)j(precisely)d(ho)n(w)h(we)g(analyze)
f(performance)e(in)2018 1828 y(the)d(ne)o(xt)g(section.\))2118
1929 y(The)29 b(results)g(sho)n(wn)g(in)g(Figure)f(5)h(were)g(tak)o(en)
g(on)g(350MHz)2018 2029 y(Pentium)20 b(II)h(Linux)f(PC)i(with)f(128MB)f
(memory)f(and)i(8GB)g(EIDE)2018 2128 y(disk.)56 b(The)o(y)29
b(include)g(only)h(the)g(time)h(spent)f(within)g(the)h(e)o(xten-)2018
2228 y(sion)f(code.)54 b(Sample)30 b(speci\002cation)f(for)h(the)g
Fm(ftpd)g Fp(serv)o(er)f(can)2018 2328 y(be)k(found)d(in)j([25)n(].)62
b(This)32 b(speci\002cation)g(consists)h(of)f(approxi-)2018
2427 y(mately)23 b(15)f(properties)g(that)h(restrict)g(the)g
(operations)e(of)i(the)g(FTP)2018 2527 y(serv)o(er)17
b(so)g(that)g(it)h(\(a\))f(accesses)h(only)e(certain)h(\002les)h
(before)e(user)h(lo-)2018 2627 y(gin,)g(and)g(certain)f(other)h
(\002les)h(after)e(user)h(login,)g(\(b\))f(e)o(x)o(ecutes)g(only)2018
2726 y(certain)25 b(\002les,)i(\(c\))d(performs)g(host)h(and)f(user)h
(authentication,)f(\(d\))2018 2826 y(allo)n(ws)d(connections)e(back)h
(to)g(the)h(FTP)g(client,)f(b)n(ut)h(not)f(arbitrary)2018
2926 y(hosts,)36 b(\(e\))c(does)g(not)g(use)h(pri)n(vile)o(ged)d
(system)j(calls)g(or)f(system)2018 3025 y(calls)19 b(e)o(xcept)d(for)h
(binding)f(to)i(a)g(pri)n(vile)o(ged)d(TCP)k(port,)e(and)g(\(f\))g(en-)
2018 3125 y(forces)25 b(additional)e(restrictions)i(for)f(certain)g
(users,)i(e.g.,)g(anon)o(y-)2018 3224 y(mous)15 b(users)h(and)f(super)g
(user)-5 b(.)24 b(The)15 b(speci\002cations)g(for)g Fm(telnetd)2018
3324 y Fp(and)20 b Fm(httpd)g Fp(were)g(similar)g(in)h(terms)f(of)g
(comple)o(xity)-5 b(.)2018 3561 y Fr(6)100 b(P)n(erf)n(ormance)25
b(Results)2118 3781 y Fp(The)g(primary)f(goal)i(of)f(our)g(performance)
e(e)o(xperiments)h(is)i(to)2018 3881 y(assess)39 b(the)e(impact)g(of)g
(additional)f(o)o(v)o(erheads)f(introduced)g(by)2018
3980 y(user)n(-le)n(v)o(el)28 b(system)i(call)f(interposition)f(as)i
(compared)d(to)i(k)o(ernel)2018 4080 y(based)h(interposition.)53
b(As)31 b(mentioned)d(earlier)m(,)k(the)e(time)h(spent)2018
4180 y(inside)j(the)g(e)o(xtension)e(code)h(remains)h(the)g(same)g(for)
f(both)g(ap-)2018 4279 y(proaches,)20 b(b)n(ut)h(additional)f(o)o(v)o
(erheads)f(are)i(incurred)e(in)j(the)f(user)n(-)2018
4379 y(le)n(v)o(el)k(approach)e(due)i(to)g(conte)o(xt)f(switches)i(and)
e(relati)n(v)o(ely)g(inef-)2018 4478 y(\002cient)i(operations)f(to)h
(access)g(the)g(memory)e(of)i(monitored)e(pro-)2018 4578
y(cess.)54 b(Therefore)27 b(our)i(e)o(xperiments)f(were)h(designed)f
(with)i(null)2018 4678 y(e)o(xtension)16 b(bodies,)h(or)g(e)o
(xtensions)f(that)h(simply)g(access)h(\(and)e(pos-)2018
4777 y(sibly)23 b(modify\))d(system)j(call)g(ar)o(guments.)30
b(F)o(or)22 b(k)o(ernel-based)f(im-)2018 4877 y(plementations,)c(the)i
(o)o(v)o(erheads)d(due)i(to)h(such)f(e)o(xtensions)f(will)j(be)2018
4977 y(ne)o(gligible)d(as)i(compared)d(to)j(the)f(o)o(v)o(erheads)e
(for)i(a)g(user)n(-le)n(v)o(el)g(im-)2018 5076 y(plementation.)2118
5177 y(Measuring)29 b(the)i(o)o(v)o(erhead)d(due)j(to)g(e)o(x)o
(ecution)d(of)j(e)o(xtension)2018 5277 y(code)23 b(will)h(serv)o(e)f
(to)g(measure)g(whether)f(computationally)e(inten-)2018
5376 y(si)n(v)o(e)36 b(tasks)h(were)f(performed)d(within)j(e)o
(xtension)e(code.)72 b(Such)2018 5476 y(measurements)17
b(w)o(ould)h(be)h(useful)f(for)g(determining)e(the)j(suitabil-)2018
5576 y(ity)26 b(of)f(system)g(call)h(interposition)e(for)g
(accomplishing)g(a)h(partic-)2018 5675 y(ular)f(task.)35
b(Prior)23 b(research)g(in)h([9)o(,)g(20)o(],)g(as)h(well)f(our)f
(results)h([25)n(])2018 5775 y(summarized)g(in)h(the)h(pre)n(vious)e
(section,)i(pro)o(vide)d(adequate)h(e)n(vi-)p eop
%%Page: 11 11
11 10 bop -43 513 1761 4 v -45 605 4 92 v -28 605 V 23
577 a Fk(Application)p 424 605 V 101 w(CPU)18 b(time)p
821 605 V 143 w(Real)h(time)p 1253 605 V 157 w(Real)g(time)p
1699 605 V 1715 605 V -45 696 V -28 696 V 424 696 V 821
696 V 872 669 a(\(Lo)n(w)g(load\))p 1253 696 V 100 w(\(High)g(load\))p
1699 696 V 1715 696 V -43 699 1761 4 v -45 791 4 92 v
-28 791 V 23 763 a(gzip)p 424 791 V 462 w Fj(<)p Fk(2\045)p
821 791 V 273 w Fj(<)p Fk(2\045)p 1253 791 V 287 w Fj(<)p
Fk(2\045)p 1699 791 V 1715 791 V -45 882 V -28 882 V
23 855 a(ghostscript)p 424 882 V 286 w(10\045)p 821 882
V 273 w Fj(<)p Fk(5\045)p 1253 882 V 250 w Fj(<)p Fk(10\045)p
1699 882 V 1715 882 V -45 973 V -28 973 V 23 946 a(tar)p
424 973 V 534 w(30\045)p 821 973 V 333 w(5\045)p 1253
973 V 310 w(10\045)p 1699 973 V 1715 973 V -45 1065 V
-28 1065 V 23 1037 a(cp)h(-r)p 424 1065 V 473 w(50\045)p
821 1065 V 333 w(5\045)p 1253 1065 V 310 w(10\045)p 1699
1065 V 1715 1065 V -45 1156 V -28 1156 V 23 1129 a(ftpd)p
424 1156 V 493 w(70\045)p 821 1156 V 273 w Fj(<)p Fk(2\045)p
1253 1156 V 310 w(30\045)p 1699 1156 V 1715 1156 V -45
1247 V -28 1247 V 23 1220 a(httpd)p 424 1247 V 460 w(65\045)p
821 1247 V 273 w Fj(<)p Fk(5\045)p 1253 1247 V 310 w(35\045)p
1699 1247 V 1715 1247 V -43 1251 1761 4 v -38 1402 a
Fi(Figure)30 b(6.)g(Overhead)g(f)n(or)g(system)h(call)f(inter)n
(cep\255)-38 1502 y(tion)22 b(f)n(or)h(diff)o(erent)f(applications.)
-138 1732 y Fp(dence)h(to)g(the)h(ef)n(\002cienc)o(y)e(and)h(ef)n
(fecti)n(v)o(eness)f(of)h(the)g(system)h(call)-138 1831
y(interposition)15 b(approach)g(for)i(applications)f(such)h(as)h
(intrusion)e(de-)-138 1931 y(tection,)21 b(con\002nement)f(and)h
(access)h(control.)28 b(Ho)n(we)n(v)o(er)m(,)20 b(measur)n(-)-138
2031 y(ing)e(the)g(e)o(x)o(ecution)f(time)h(within)g(e)o(xtension)f
(code)h(will)h(not)f(in)g(an)o(y)-138 2130 y(w)o(ay)f(help)g(assess)i
(the)e(performance)d(of)j(the)h(infrastructure)d(de)n(v)o(el-)-138
2230 y(oped)23 b(in)h(this)h(paper)-5 b(.)36 b(This)24
b(is)h(another)d(reason)i(for)f(our)g(focus)h(on)-138
2329 y(v)o(ery)19 b(simple)h(e)o(xtensions)f(in)i(our)e(performance)e
(study)-5 b(.)-38 2429 y(Most)33 b(of)f(the)h(results)h(presented)d(in)
i(this)h(section)e(were)h(ob-)-138 2529 y(tained)h(for)g(Linux)g
(running)f(on)h(a)h(350MHz)e(Pentium)i(II)f(with)-138
2628 y(128MB)17 b(memory)f(and)h(8GB)g(EIDE)h(disk,)f(while)h(the)f
(others)g(were)-138 2728 y(obtained)f(on)h(IRIX)g(running)e(on)i(SGI)g
(R10000)f(150MHz)g(128MB)-138 2828 y(4GB)g(SCSI,)h(and)f(OSF/1)g
(running)e(on)h(DEC)i(alpha)e(500MHz)g(with)-138 2927
y(1GB)k(memory)-5 b(.)22 b(Whene)n(v)o(er)17 b(the)i(measurements)e
(pertain)g(to)i(IRIX)-138 3027 y(or)30 b(OSF/1,)k(we)d(indicate)e(this)
j(e)o(xplicitly;)i(otherwise)c(the)h(mea-)-138 3126 y(surements)19
b(pertain)h(to)g(Linux.)-138 3323 y Fl(6.1)90 b(Ov)o(erhead)21
b(f)n(or)h(System)g(Call)h(Inter)n(ception)-38 3519 y
Fp(F)o(or)j(performance)f(analysis,)j(we)g(consider)e(three)g(cate)o
(gories)-138 3618 y(of)g(applications)f(to)h(monitor:)35
b(CPU-intensi)n(v)o(e,)27 b(disk)f(I/O)g(inten-)-138
3718 y(si)n(v)o(e,)k(and)d(netw)o(ork-intensi)n(v)o(e)e(applications.)
47 b(The)28 b(o)o(v)o(erhead)d(is)-138 3818 y(measured)19
b(in)i(terms)f(of)g(increase)g(in)h(CPU)g(time,)g(as)g(gi)n(v)o(en)e
(by)h(the)-138 3917 y(formula:)-40 4032 y Fk(CPU)e(time)h(for)g
(monitored)g(app)h(AND)f(monitoring)g(process)p -40 4069
1630 4 v 310 4145 a(CPU)f(time)h(for)f(unmonitored)j(app)1618
4088 y Fu(\000)d Fc(1)-138 4281 y Fp(CPU)38 b(time)f(is)h(tak)o(en)f
(to)g(be)g(the)h(sum)f(of)g(the)g(times)g(spent)g(in)-138
4380 y(user)31 b(and)f(system)h(mode)f(by)g(the)h(system)g(on)g(behalf)
f(of)g(a)h(pro-)-138 4480 y(cess.)f(W)-7 b(e)23 b(also)f(measure)f(the)
h(percei)n(v)o(ed)d(de)o(gradation)g(in)j(perfor)n(-)-138
4579 y(mance,)17 b(which)g(is)h(computed)e(using)h(real)g(time)h
(\(otherwise)e(called)-138 4679 y(elapsed)k(time\))g(instead)g(of)g
(CPU)i(time.)j(The)20 b(percei)n(v)o(ed)f(de)o(grada-)-138
4779 y(tion)k(is)g(sho)n(wn)g(under)e(lightly)h(loaded)g(and)g(hea)n
(vily)g(loaded)g(con-)-138 4878 y(ditions)29 b(in)h(T)-7
b(able)29 b(6.)53 b(In)29 b(the)h(table,)h(lightly)e(loaded)g
(conditions)-138 4978 y(refer)18 b(to)g(a)h(single)g(instance)f(of)g(a)
h(running)d(application)h(for)h Fm(gzip)p Fp(,)-138 5078
y Fm(ghostscript)p Fp(,)d Fm(tar)g Fp(and)f Fm(cp)50
b(-r)p Fp(,)16 b(and)f(a)g(deli)n(v)o(ered)f(through-)-138
5177 y(put)29 b(less)i(than)f(20Mb/s)f(for)g Fm(ftpd)h
Fp(and)f Fm(httpd)p Fp(.)53 b(Hea)n(vy)30 b(load)-138
5277 y(corresponds)25 b(to)j(running)e(ten)h(instances)h(of)f(an)h
(application)e(for)-138 5376 y Fm(gzip)p Fp(,)f Fm(ghostscript)p
Fp(,)f Fm(tar)g Fp(and)g Fm(cp)50 b(-r)p Fp(,)25 b(and)f(a)h(deli)n(v)o
(ered)-138 5476 y(throughput)17 b(of)j(100Mb/s)f(or)h(higher)f(for)g
Fm(ftpd)h Fp(and)g Fm(httpd)p Fp(.)-38 5576 y(The)26
b(graph)g(in)h(Figure)f(7)h(sho)n(ws)g(the)g(increase)g(in)g(CPU)h
(time)-138 5675 y(as)i(a)f(function)f(of)h(the)g(number)e(of)i(system)h
(calls)g(made)e(by)h(dif-)-138 5775 y(ferent)e(applications.)49
b(W)-7 b(e)29 b(e)o(xpect)e(the)i(o)o(v)o(erhead)c(to)k(be)f(mainly)
2152 1383 y @beginspecial 50 @llx 100 @lly 410 @urx 300
@ury 2016 @rwi @setspecial
%%BeginDocument: overhead.eps
%!PS-Adobe-2.0 EPSF-2.0
%%Title: overhead6.eps
%%Creator: gnuplot 3.5 (pre 3.6) patchlevel beta 347
%%CreationDate: Thu Jun 17 04:33:51 1999
%%DocumentFonts: (atend)
%%BoundingBox: 50 100 410 300
%%Orientation: Portrait
%%EndComments
/gnudict 120 dict def
gnudict begin
/Color false def
/Solid false def
/gnulinewidth 5.000 def
/userlinewidth gnulinewidth def
/vshift -80 def
/dl {10 mul} def
/hpt_ 31.5 def
/vpt_ 31.5 def
/hpt hpt_ def
/vpt vpt_ def
/M {moveto} bind def
/L {lineto} bind def
/R {rmoveto} bind def
/V {rlineto} bind def
/vpt2 vpt 2 mul def
/hpt2 hpt 2 mul def
/Lshow { currentpoint stroke M
  0 vshift R show } def
/Rshow { currentpoint stroke M
  dup stringwidth pop neg vshift R show } def
/Cshow { currentpoint stroke M
  dup stringwidth pop -2 div vshift R show } def
/UP { dup vpt_ mul /vpt exch def hpt_ mul /hpt exch def
  /hpt2 hpt 2 mul def /vpt2 vpt 2 mul def } def
/DL { Color {setrgbcolor Solid {pop []} if 0 setdash }
 {pop pop pop Solid {pop []} if 0 setdash} ifelse } def
/BL { stroke gnulinewidth 2 mul setlinewidth } def
/AL { stroke gnulinewidth 2 div setlinewidth } def
/UL { gnulinewidth mul /userlinewidth exch def } def
/PL { stroke userlinewidth setlinewidth } def
/LTb { BL [] 0 0 0 DL } def
/LTa { AL [1 dl 2 dl] 0 setdash 0 0 0 setrgbcolor } def
/LT0 { PL [] 1 0 0 DL } def
/LT1 { PL [4 dl 2 dl] 0 1 0 DL } def
/LT2 { PL [2 dl 3 dl] 0 0 1 DL } def
/LT3 { PL [1 dl 1.5 dl] 1 0 1 DL } def
/LT4 { PL [5 dl 2 dl 1 dl 2 dl] 0 1 1 DL } def
/LT5 { PL [4 dl 3 dl 1 dl 3 dl] 1 1 0 DL } def
/LT6 { PL [2 dl 2 dl 2 dl 4 dl] 0 0 0 DL } def
/LT7 { PL [2 dl 2 dl 2 dl 2 dl 2 dl 4 dl] 1 0.3 0 DL } def
/LT8 { PL [2 dl 2 dl 2 dl 2 dl 2 dl 2 dl 2 dl 4 dl] 0.5 0.5 0.5 DL } def
/Pnt { stroke [] 0 setdash
   gsave 1 setlinecap M 0 0 V stroke grestore } def
/Dia { stroke [] 0 setdash 2 copy vpt add M
  hpt neg vpt neg V hpt vpt neg V
  hpt vpt V hpt neg vpt V closepath stroke
  Pnt } def
/Pls { stroke [] 0 setdash vpt sub M 0 vpt2 V
  currentpoint stroke M
  hpt neg vpt neg R hpt2 0 V stroke
  } def
/Box { stroke [] 0 setdash 2 copy exch hpt sub exch vpt add M
  0 vpt2 neg V hpt2 0 V 0 vpt2 V
  hpt2 neg 0 V closepath stroke
  Pnt } def
/Crs { stroke [] 0 setdash exch hpt sub exch vpt add M
  hpt2 vpt2 neg V currentpoint stroke M
  hpt2 neg 0 R hpt2 vpt2 V stroke } def
/TriU { stroke [] 0 setdash 2 copy vpt 1.12 mul add M
  hpt neg vpt -1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt 1.62 mul V closepath stroke
  Pnt  } def
/Star { 2 copy Pls Crs } def
/BoxF { stroke [] 0 setdash exch hpt sub exch vpt add M
  0 vpt2 neg V  hpt2 0 V  0 vpt2 V
  hpt2 neg 0 V  closepath fill } def
/TriUF { stroke [] 0 setdash vpt 1.12 mul add M
  hpt neg vpt -1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt 1.62 mul V closepath fill } def
/TriD { stroke [] 0 setdash 2 copy vpt 1.12 mul sub M
  hpt neg vpt 1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt -1.62 mul V closepath stroke
  Pnt  } def
/TriDF { stroke [] 0 setdash vpt 1.12 mul sub M
  hpt neg vpt 1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt -1.62 mul V closepath fill} def
/DiaF { stroke [] 0 setdash vpt add M
  hpt neg vpt neg V hpt vpt neg V
  hpt vpt V hpt neg vpt V closepath fill } def
/Pent { stroke [] 0 setdash 2 copy gsave
  translate 0 hpt M 4 {72 rotate 0 hpt L} repeat
  closepath stroke grestore Pnt } def
/PentF { stroke [] 0 setdash gsave
  translate 0 hpt M 4 {72 rotate 0 hpt L} repeat
  closepath fill grestore } def
/Circle { stroke [] 0 setdash 2 copy
  hpt 0 360 arc stroke Pnt } def
/CircleF { stroke [] 0 setdash hpt 0 360 arc fill } def
/C0 { BL [] 0 setdash 2 copy moveto vpt 90 450  arc } bind def
/C1 { BL [] 0 setdash 2 copy        moveto
       2 copy  vpt 0 90 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C2 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 90 180 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C3 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 0 180 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C4 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 180 270 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C5 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 0 90 arc
       2 copy moveto
       2 copy  vpt 180 270 arc closepath fill
               vpt 0 360 arc } bind def
/C6 { BL [] 0 setdash 2 copy moveto
      2 copy  vpt 90 270 arc closepath fill
              vpt 0 360 arc closepath } bind def
/C7 { BL [] 0 setdash 2 copy moveto
      2 copy  vpt 0 270 arc closepath fill
              vpt 0 360 arc closepath } bind def
/C8 { BL [] 0 setdash 2 copy moveto
      2 copy vpt 270 360 arc closepath fill
              vpt 0 360 arc closepath } bind def
/C9 { BL [] 0 setdash 2 copy moveto
      2 copy  vpt 270 450 arc closepath fill
              vpt 0 360 arc closepath } bind def
/C10 { BL [] 0 setdash 2 copy 2 copy moveto vpt 270 360 arc closepath fill
       2 copy moveto
       2 copy vpt 90 180 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C11 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 0 180 arc closepath fill
       2 copy moveto
       2 copy  vpt 270 360 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C12 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 180 360 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C13 { BL [] 0 setdash  2 copy moveto
       2 copy  vpt 0 90 arc closepath fill
       2 copy moveto
       2 copy  vpt 180 360 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C14 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 90 360 arc closepath fill
               vpt 0 360 arc } bind def
/C15 { BL [] 0 setdash 2 copy vpt 0 360 arc closepath fill
               vpt 0 360 arc closepath } bind def
/Rec   { newpath 4 2 roll moveto 1 index 0 rlineto 0 exch rlineto
       neg 0 rlineto closepath } bind def
/Square { dup Rec } bind def
/Bsquare { vpt sub exch vpt sub exch vpt2 Square } bind def
/S0 { BL [] 0 setdash 2 copy moveto 0 vpt rlineto BL Bsquare } bind def
/S1 { BL [] 0 setdash 2 copy vpt Square fill Bsquare } bind def
/S2 { BL [] 0 setdash 2 copy exch vpt sub exch vpt Square fill Bsquare } bind def
/S3 { BL [] 0 setdash 2 copy exch vpt sub exch vpt2 vpt Rec fill Bsquare } bind def
/S4 { BL [] 0 setdash 2 copy exch vpt sub exch vpt sub vpt Square fill Bsquare } bind def
/S5 { BL [] 0 setdash 2 copy 2 copy vpt Square fill
       exch vpt sub exch vpt sub vpt Square fill Bsquare } bind def
/S6 { BL [] 0 setdash 2 copy exch vpt sub exch vpt sub vpt vpt2 Rec fill Bsquare } bind def
/S7 { BL [] 0 setdash 2 copy exch vpt sub exch vpt sub vpt vpt2 Rec fill
       2 copy vpt Square fill
       Bsquare } bind def
/S8 { BL [] 0 setdash 2 copy vpt sub vpt Square fill Bsquare } bind def
/S9 { BL [] 0 setdash 2 copy vpt sub vpt vpt2 Rec fill Bsquare } bind def
/S10 { BL [] 0 setdash 2 copy vpt sub vpt Square fill 2 copy exch vpt sub exch vpt Square fill
       Bsquare } bind def
/S11 { BL [] 0 setdash 2 copy vpt sub vpt Square fill 2 copy exch vpt sub exch vpt2 vpt Rec fill
       Bsquare } bind def
/S12 { BL [] 0 setdash 2 copy exch vpt sub exch vpt sub vpt2 vpt Rec fill Bsquare } bind def
/S13 { BL [] 0 setdash 2 copy exch vpt sub exch vpt sub vpt2 vpt Rec fill
       2 copy vpt Square fill Bsquare } bind def
/S14 { BL [] 0 setdash 2 copy exch vpt sub exch vpt sub vpt2 vpt Rec fill
       2 copy exch vpt sub exch vpt Square fill Bsquare } bind def
/S15 { BL [] 0 setdash 2 copy Bsquare fill Bsquare } bind def
/D0 { gsave translate 45 rotate 0 0 S0 stroke grestore } bind def
/D1 { gsave translate 45 rotate 0 0 S1 stroke grestore } bind def
/D2 { gsave translate 45 rotate 0 0 S2 stroke grestore } bind def
/D3 { gsave translate 45 rotate 0 0 S3 stroke grestore } bind def
/D4 { gsave translate 45 rotate 0 0 S4 stroke grestore } bind def
/D5 { gsave translate 45 rotate 0 0 S5 stroke grestore } bind def
/D6 { gsave translate 45 rotate 0 0 S6 stroke grestore } bind def
/D7 { gsave translate 45 rotate 0 0 S7 stroke grestore } bind def
/D8 { gsave translate 45 rotate 0 0 S8 stroke grestore } bind def
/D9 { gsave translate 45 rotate 0 0 S9 stroke grestore } bind def
/D10 { gsave translate 45 rotate 0 0 S10 stroke grestore } bind def
/D11 { gsave translate 45 rotate 0 0 S11 stroke grestore } bind def
/D12 { gsave translate 45 rotate 0 0 S12 stroke grestore } bind def
/D13 { gsave translate 45 rotate 0 0 S13 stroke grestore } bind def
/D14 { gsave translate 45 rotate 0 0 S14 stroke grestore } bind def
/D15 { gsave translate 45 rotate 0 0 S15 stroke grestore } bind def
/DiaE { stroke [] 0 setdash vpt add M
  hpt neg vpt neg V hpt vpt neg V
  hpt vpt V hpt neg vpt V closepath stroke } def
/BoxE { stroke [] 0 setdash exch hpt sub exch vpt add M
  0 vpt2 neg V hpt2 0 V 0 vpt2 V
  hpt2 neg 0 V closepath stroke } def
/TriUE { stroke [] 0 setdash vpt 1.12 mul add M
  hpt neg vpt -1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt 1.62 mul V closepath stroke } def
/TriDE { stroke [] 0 setdash vpt 1.12 mul sub M
  hpt neg vpt 1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt -1.62 mul V closepath stroke } def
/PentE { stroke [] 0 setdash gsave
  translate 0 hpt M 4 {72 rotate 0 hpt L} repeat
  closepath stroke grestore } def
/CircE { stroke [] 0 setdash 
  hpt 0 360 arc stroke } def
/Opaque { gsave closepath 1 setgray fill grestore 0 setgray closepath } def
/DiaW { stroke [] 0 setdash vpt add M
  hpt neg vpt neg V hpt vpt neg V
  hpt vpt V hpt neg vpt V Opaque stroke } def
/BoxW { stroke [] 0 setdash exch hpt sub exch vpt add M
  0 vpt2 neg V hpt2 0 V 0 vpt2 V
  hpt2 neg 0 V Opaque stroke } def
/TriUW { stroke [] 0 setdash vpt 1.12 mul add M
  hpt neg vpt -1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt 1.62 mul V Opaque stroke } def
/TriDW { stroke [] 0 setdash vpt 1.12 mul sub M
  hpt neg vpt 1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt -1.62 mul V Opaque stroke } def
/PentW { stroke [] 0 setdash gsave
  translate 0 hpt M 4 {72 rotate 0 hpt L} repeat
  Opaque stroke grestore } def
/CircW { stroke [] 0 setdash 
  hpt 0 360 arc Opaque stroke } def
/BoxFill { gsave Rec 1 setgray fill grestore } def
end
%%EndProlog
gnudict begin
gsave
50 50 translate
0.050 0.050 scale
0 setgray
newpath
(Helvetica) findfont 280 scalefont setfont
1.000 UL
LTb
960 720 M
63 0 V
5889 0 R
-63 0 V
816 720 M
(0) Rshow
960 1224 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(0.5) Rshow
960 1728 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(1) Rshow
960 2232 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(1.5) Rshow
960 2736 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(2) Rshow
960 3240 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(2.5) Rshow
960 3744 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(3) Rshow
960 4248 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(3.5) Rshow
960 4752 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(4) Rshow
960 720 M
0 63 V
0 3969 R
0 -63 V
960 480 M
(0) Cshow
1952 720 M
0 63 V
0 3969 R
0 -63 V
0 -4209 R
(20000) Cshow
2944 720 M
0 63 V
0 3969 R
0 -63 V
0 -4209 R
(40000) Cshow
3936 720 M
0 63 V
0 3969 R
0 -63 V
0 -4209 R
(60000) Cshow
4928 720 M
0 63 V
0 3969 R
0 -63 V
0 -4209 R
(80000) Cshow
5920 720 M
0 63 V
0 3969 R
0 -63 V
0 -4209 R
(100000) Cshow
6912 720 M
0 63 V
0 3969 R
0 -63 V
0 -4209 R
%(120000) Cshow
1.000 UL
LTb
960 720 M
5952 0 V
0 4032 V
-5952 0 V
960 720 L
0 2736 M
currentpoint gsave translate 90 rotate 0 -200 M
(Overhead in seconds) Cshow
grestore
3936 100 M
(Number of system calls) Cshow
1.000 UP
1.000 UL
LT0
1808 3944 M
('gzip') Rshow
1153 821 Pls
1842 1426 Pls
2271 3944 Pls
1.000 UP
1.000 UL
LT1
1808 3654 M
('gs') Rshow
1446 1073 Crs
2082 1577 Crs
2820 2131 Crs
2271 3654 Crs
1.000 UP
1.000 UL
LT2
1808 3364 M
('tar') Rshow
1279 962 Star
1388 1022 Star
1900 1405 Star
2515 1829 Star
6330 4137 Star
2271 3364 Star
1.000 UP
1.000 UL
LT3
1808 3074 M
('cp') Rshow
2500 1688 Box
2947 2282 Box
5384 3038 Box
2271 3074 Box
1.000 UP
1.000 UL
LT4
1808 2784 M
('ftp') Rshow
1168 891 BoxF
1295 912 BoxF
1221 932 BoxF
1853 1254 BoxF
4945 3865 BoxF
2271 2784 BoxF
stroke
grestore
end
showpage

%%EndDocument
 @endspecial 2118 1746 a Fi(Figure)f(7.)h(Increase)g(in)g(o)n(verhead)g
(with)e(increase)2118 1846 y(in)d(n)o(umber)f(of)h(system)g(calls.)2018
2102 y Fp(due)f(to)g(conte)o(xt)f(switches,)i(whose)f(cost)h(should)e
(be)h(independent)2018 2202 y(of)j(the)h(cost)f(of)g(the)h(system)f
(call)h(itself.)41 b(Thus)25 b(we)h(e)o(xpect)e(a)i(lin-)2018
2302 y(ear)31 b(relationship)e(between)i(the)f(o)o(v)o(erhead)f(and)h
(the)h(number)e(of)2018 2401 y(system)e(calls)g(made.)43
b(The)26 b(graph)f(sho)n(ws)h(that)h(this)g(o)o(v)o(erhead)d(is)2018
2501 y(between)17 b(26)g(and)g(38)g(microseconds)f(per)h(system)h
(call,)g(with)g(most)2018 2601 y(points)i(concentrated)e(around)g(34)h
(microseconds.)k(The)d(v)n(ariation)2018 2700 y(is)25
b(a)g(result)f(of)f(time)i(measurement)d(errors)h(which)g(get)h
(ampli\002ed)2018 2800 y(since)d(we)g(are)g(taking)e(the)i(dif)n
(ference)e(between)h(CPU)h(times)g(with)2018 2899 y(and)e(without)g
(monitoring.)j(Moreo)o(v)o(er)m(,)17 b(when)i(a)h(process)f(is)i(mon-)
2018 2999 y(itored,)h(we)h(need)e(additional)g(processes)h(for)g
(monitoring,)e(which)2018 3099 y(can)g(in)g(turn)f(lead)h(to)g(poorer)e
(virtual)h(memory)f(and)i(cache)f(perfor)n(-)2018 3198
y(mance.)30 b(The)22 b(impact)g(of)g(this)h(is)g(hard)e(to)i(predict,)e
(and)h(may)g(v)n(ary)2018 3298 y(from)d(application)g(to)h
(application.)2018 3529 y Fh(6.1.1)81 b(CPU-intensi)o(v)o(e)20
b(applications)2018 3689 y Fp(This)28 b(cate)o(gory)e(is)j(meant)e(to)h
(represent)e(typical)h(CPU-intensi)n(v)o(e)2018 3788
y(applications)k(that)g(are)h(used)f(frequently)-5 b(.)56
b(Users)32 b(are)f(typically)2018 3888 y(sensiti)n(v)o(e)46
b(to)g(additional)f(o)o(v)o(erheads)f(for)h(such)h(applications,)2018
3988 y(since)34 b(their)g(running)e(time)i(is)g(long)f(enough)f(to)i
(be)g(percei)n(v)o(ed.)2018 4087 y(W)-7 b(e)33 b(consider)e
Fm(gzip)h Fp(and)f Fm(ghostscript)g Fp(in)h(this)g(cate)o(gory)-5
b(.)2018 4187 y(While)19 b Fm(gzip)g Fp(mak)o(es)f(v)o(ery)g(fe)n(w)h
(system)g(calls,)g Fm(ghostscript)2018 4286 y Fp(mak)o(es)24
b(a)g(moderate)f(number)f(due)h(to)h(the)g(sock)o(et-related)e(opera-)
2018 4386 y(tions)e(needed)f(for)h(displaying)f(on)g(X-windo)n(ws.)2118
4488 y(Our)42 b(o)o(v)o(erhead)d(results)j(con\002rm)f(the)h(results)h
(of)e([13)o(])h(for)2018 4587 y(SVR4)32 b(compatible)e(operating)f
(systems)j(such)f(as)h(IRIX,)g(while)2018 4687 y(establishing)27
b(that)h(similar)f(o)o(v)o(erheads)e(\(almost)j(immeasurable\))2018
4786 y(hold)19 b(for)g(Linux)g(implementation)f(that)h(uses)i(the)e
Fm(ptrace)h Fp(f)o(acil-)2018 4886 y(ity)-5 b(.)2018
5118 y Fh(6.1.2)81 b(Disk)22 b(I/O-intensi)o(v)o(e)e(applications)2018
5277 y Fp(In)f(this)g(cate)o(gory)-5 b(,)16 b(we)j(studied)g
Fm(tar)f Fp(and)g Fm(cp)50 b(-r)19 b Fp(\(i.e.,)f(recursi)n(v)o(e)2018
5376 y(cop)o(y)32 b(of)g(directories\).)61 b(This)33
b(cate)o(gory)e(of)h(applications)g(tends)2018 5476 y(to)h(mak)o(e)e(a)
i(v)o(ery)e(lar)o(ge)g(number)f(of)i(system)h(calls.)61
b(Since)32 b(our)2018 5576 y(main)f(o)o(v)o(erhead)d(is)k(due)e(to)h
(conte)o(xt)f(switching)g(for)h(e)n(v)o(ery)e(sys-)2018
5675 y(tem)21 b(call,)g(higher)f(o)o(v)o(erheads)e(are)j(to)g(be)f(e)o
(xpected)g(for)g(these)h(pro-)2018 5775 y(grams.)45 b(Ho)n(we)n(v)o(er)
m(,)27 b(due)f(to)h(a)h(lar)o(ge)e(amount)f(of)i(I/O)g(operations)p
eop
%%Page: 12 12
12 11 bop -54 1710 a @beginspecial 50 @llx 50 @lly 410
@urx 302 @ury 2160 @rwi @setspecial
%%BeginDocument: ftpthruput.eps
%!PS-Adobe-2.0 EPSF-2.0
%%Title: thruputfinalfinal.eps
%%Creator: gnuplot 3.5 (pre 3.6) patchlevel beta 347
%%CreationDate: Wed Jun 23 09:26:55 1999
%%DocumentFonts: (atend)
%%BoundingBox: 50 50 410 302
%%Orientation: Portrait
%%EndComments
/gnudict 120 dict def
gnudict begin
/Color false def
/Solid false def
/gnulinewidth 5.000 def
/userlinewidth gnulinewidth def
/vshift -80 def
/dl {10 mul} def
/hpt_ 31.5 def
/vpt_ 31.5 def
/hpt hpt_ def
/vpt vpt_ def
/M {moveto} bind def
/L {lineto} bind def
/R {rmoveto} bind def
/V {rlineto} bind def
/vpt2 vpt 2 mul def
/hpt2 hpt 2 mul def
/Lshow { currentpoint stroke M
  0 vshift R show } def
/Rshow { currentpoint stroke M
  dup stringwidth pop neg vshift R show } def
/Cshow { currentpoint stroke M
  dup stringwidth pop -2 div vshift R show } def
/UP { dup vpt_ mul /vpt exch def hpt_ mul /hpt exch def
  /hpt2 hpt 2 mul def /vpt2 vpt 2 mul def } def
/DL { Color {setrgbcolor Solid {pop []} if 0 setdash }
 {pop pop pop Solid {pop []} if 0 setdash} ifelse } def
/BL { stroke gnulinewidth 2 mul setlinewidth } def
/AL { stroke gnulinewidth 2 div setlinewidth } def
/UL { gnulinewidth mul /userlinewidth exch def } def
/PL { stroke userlinewidth setlinewidth } def
/LTb { BL [] 0 0 0 DL } def
/LTa { AL [1 dl 2 dl] 0 setdash 0 0 0 setrgbcolor } def
/LT0 { PL [] 1 0 0 DL } def
/LT1 { PL [4 dl 2 dl] 0 1 0 DL } def
/LT2 { PL [2 dl 3 dl] 0 0 1 DL } def
/LT3 { PL [1 dl 1.5 dl] 1 0 1 DL } def
/LT4 { PL [5 dl 2 dl 1 dl 2 dl] 0 1 1 DL } def
/LT5 { PL [4 dl 3 dl 1 dl 3 dl] 1 1 0 DL } def
/LT6 { PL [2 dl 2 dl 2 dl 4 dl] 0 0 0 DL } def
/LT7 { PL [2 dl 2 dl 2 dl 2 dl 2 dl 4 dl] 1 0.3 0 DL } def
/LT8 { PL [2 dl 2 dl 2 dl 2 dl 2 dl 2 dl 2 dl 4 dl] 0.5 0.5 0.5 DL } def
/Pnt { stroke [] 0 setdash
   gsave 1 setlinecap M 0 0 V stroke grestore } def
/Dia { stroke [] 0 setdash 2 copy vpt add M
  hpt neg vpt neg V hpt vpt neg V
  hpt vpt V hpt neg vpt V closepath stroke
  Pnt } def
/Pls { stroke [] 0 setdash vpt sub M 0 vpt2 V
  currentpoint stroke M
  hpt neg vpt neg R hpt2 0 V stroke
  } def
/Box { stroke [] 0 setdash 2 copy exch hpt sub exch vpt add M
  0 vpt2 neg V hpt2 0 V 0 vpt2 V
  hpt2 neg 0 V closepath stroke
  Pnt } def
/Crs { stroke [] 0 setdash exch hpt sub exch vpt add M
  hpt2 vpt2 neg V currentpoint stroke M
  hpt2 neg 0 R hpt2 vpt2 V stroke } def
/TriU { stroke [] 0 setdash 2 copy vpt 1.12 mul add M
  hpt neg vpt -1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt 1.62 mul V closepath stroke
  Pnt  } def
/Star { 2 copy Pls Crs } def
/BoxF { stroke [] 0 setdash exch hpt sub exch vpt add M
  0 vpt2 neg V  hpt2 0 V  0 vpt2 V
  hpt2 neg 0 V  closepath fill } def
/TriUF { stroke [] 0 setdash vpt 1.12 mul add M
  hpt neg vpt -1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt 1.62 mul V closepath fill } def
/TriD { stroke [] 0 setdash 2 copy vpt 1.12 mul sub M
  hpt neg vpt 1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt -1.62 mul V closepath stroke
  Pnt  } def
/TriDF { stroke [] 0 setdash vpt 1.12 mul sub M
  hpt neg vpt 1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt -1.62 mul V closepath fill} def
/DiaF { stroke [] 0 setdash vpt add M
  hpt neg vpt neg V hpt vpt neg V
  hpt vpt V hpt neg vpt V closepath fill } def
/Pent { stroke [] 0 setdash 2 copy gsave
  translate 0 hpt M 4 {72 rotate 0 hpt L} repeat
  closepath stroke grestore Pnt } def
/PentF { stroke [] 0 setdash gsave
  translate 0 hpt M 4 {72 rotate 0 hpt L} repeat
  closepath fill grestore } def
/Circle { stroke [] 0 setdash 2 copy
  hpt 0 360 arc stroke Pnt } def
/CircleF { stroke [] 0 setdash hpt 0 360 arc fill } def
/C0 { BL [] 0 setdash 2 copy moveto vpt 90 450  arc } bind def
/C1 { BL [] 0 setdash 2 copy        moveto
       2 copy  vpt 0 90 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C2 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 90 180 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C3 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 0 180 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C4 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 180 270 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C5 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 0 90 arc
       2 copy moveto
       2 copy  vpt 180 270 arc closepath fill
               vpt 0 360 arc } bind def
/C6 { BL [] 0 setdash 2 copy moveto
      2 copy  vpt 90 270 arc closepath fill
              vpt 0 360 arc closepath } bind def
/C7 { BL [] 0 setdash 2 copy moveto
      2 copy  vpt 0 270 arc closepath fill
              vpt 0 360 arc closepath } bind def
/C8 { BL [] 0 setdash 2 copy moveto
      2 copy vpt 270 360 arc closepath fill
              vpt 0 360 arc closepath } bind def
/C9 { BL [] 0 setdash 2 copy moveto
      2 copy  vpt 270 450 arc closepath fill
              vpt 0 360 arc closepath } bind def
/C10 { BL [] 0 setdash 2 copy 2 copy moveto vpt 270 360 arc closepath fill
       2 copy moveto
       2 copy vpt 90 180 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C11 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 0 180 arc closepath fill
       2 copy moveto
       2 copy  vpt 270 360 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C12 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 180 360 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C13 { BL [] 0 setdash  2 copy moveto
       2 copy  vpt 0 90 arc closepath fill
       2 copy moveto
       2 copy  vpt 180 360 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C14 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 90 360 arc closepath fill
               vpt 0 360 arc } bind def
/C15 { BL [] 0 setdash 2 copy vpt 0 360 arc closepath fill
               vpt 0 360 arc closepath } bind def
/Rec   { newpath 4 2 roll moveto 1 index 0 rlineto 0 exch rlineto
       neg 0 rlineto closepath } bind def
/Square { dup Rec } bind def
/Bsquare { vpt sub exch vpt sub exch vpt2 Square } bind def
/S0 { BL [] 0 setdash 2 copy moveto 0 vpt rlineto BL Bsquare } bind def
/S1 { BL [] 0 setdash 2 copy vpt Square fill Bsquare } bind def
/S2 { BL [] 0 setdash 2 copy exch vpt sub exch vpt Square fill Bsquare } bind def
/S3 { BL [] 0 setdash 2 copy exch vpt sub exch vpt2 vpt Rec fill Bsquare } bind def
/S4 { BL [] 0 setdash 2 copy exch vpt sub exch vpt sub vpt Square fill Bsquare } bind def
/S5 { BL [] 0 setdash 2 copy 2 copy vpt Square fill
       exch vpt sub exch vpt sub vpt Square fill Bsquare } bind def
/S6 { BL [] 0 setdash 2 copy exch vpt sub exch vpt sub vpt vpt2 Rec fill Bsquare } bind def
/S7 { BL [] 0 setdash 2 copy exch vpt sub exch vpt sub vpt vpt2 Rec fill
       2 copy vpt Square fill
       Bsquare } bind def
/S8 { BL [] 0 setdash 2 copy vpt sub vpt Square fill Bsquare } bind def
/S9 { BL [] 0 setdash 2 copy vpt sub vpt vpt2 Rec fill Bsquare } bind def
/S10 { BL [] 0 setdash 2 copy vpt sub vpt Square fill 2 copy exch vpt sub exch vpt Square fill
       Bsquare } bind def
/S11 { BL [] 0 setdash 2 copy vpt sub vpt Square fill 2 copy exch vpt sub exch vpt2 vpt Rec fill
       Bsquare } bind def
/S12 { BL [] 0 setdash 2 copy exch vpt sub exch vpt sub vpt2 vpt Rec fill Bsquare } bind def
/S13 { BL [] 0 setdash 2 copy exch vpt sub exch vpt sub vpt2 vpt Rec fill
       2 copy vpt Square fill Bsquare } bind def
/S14 { BL [] 0 setdash 2 copy exch vpt sub exch vpt sub vpt2 vpt Rec fill
       2 copy exch vpt sub exch vpt Square fill Bsquare } bind def
/S15 { BL [] 0 setdash 2 copy Bsquare fill Bsquare } bind def
/D0 { gsave translate 45 rotate 0 0 S0 stroke grestore } bind def
/D1 { gsave translate 45 rotate 0 0 S1 stroke grestore } bind def
/D2 { gsave translate 45 rotate 0 0 S2 stroke grestore } bind def
/D3 { gsave translate 45 rotate 0 0 S3 stroke grestore } bind def
/D4 { gsave translate 45 rotate 0 0 S4 stroke grestore } bind def
/D5 { gsave translate 45 rotate 0 0 S5 stroke grestore } bind def
/D6 { gsave translate 45 rotate 0 0 S6 stroke grestore } bind def
/D7 { gsave translate 45 rotate 0 0 S7 stroke grestore } bind def
/D8 { gsave translate 45 rotate 0 0 S8 stroke grestore } bind def
/D9 { gsave translate 45 rotate 0 0 S9 stroke grestore } bind def
/D10 { gsave translate 45 rotate 0 0 S10 stroke grestore } bind def
/D11 { gsave translate 45 rotate 0 0 S11 stroke grestore } bind def
/D12 { gsave translate 45 rotate 0 0 S12 stroke grestore } bind def
/D13 { gsave translate 45 rotate 0 0 S13 stroke grestore } bind def
/D14 { gsave translate 45 rotate 0 0 S14 stroke grestore } bind def
/D15 { gsave translate 45 rotate 0 0 S15 stroke grestore } bind def
/DiaE { stroke [] 0 setdash vpt add M
  hpt neg vpt neg V hpt vpt neg V
  hpt vpt V hpt neg vpt V closepath stroke } def
/BoxE { stroke [] 0 setdash exch hpt sub exch vpt add M
  0 vpt2 neg V hpt2 0 V 0 vpt2 V
  hpt2 neg 0 V closepath stroke } def
/TriUE { stroke [] 0 setdash vpt 1.12 mul add M
  hpt neg vpt -1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt 1.62 mul V closepath stroke } def
/TriDE { stroke [] 0 setdash vpt 1.12 mul sub M
  hpt neg vpt 1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt -1.62 mul V closepath stroke } def
/PentE { stroke [] 0 setdash gsave
  translate 0 hpt M 4 {72 rotate 0 hpt L} repeat
  closepath stroke grestore } def
/CircE { stroke [] 0 setdash 
  hpt 0 360 arc stroke } def
/Opaque { gsave closepath 1 setgray fill grestore 0 setgray closepath } def
/DiaW { stroke [] 0 setdash vpt add M
  hpt neg vpt neg V hpt vpt neg V
  hpt vpt V hpt neg vpt V Opaque stroke } def
/BoxW { stroke [] 0 setdash exch hpt sub exch vpt add M
  0 vpt2 neg V hpt2 0 V 0 vpt2 V
  hpt2 neg 0 V Opaque stroke } def
/TriUW { stroke [] 0 setdash vpt 1.12 mul add M
  hpt neg vpt -1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt 1.62 mul V Opaque stroke } def
/TriDW { stroke [] 0 setdash vpt 1.12 mul sub M
  hpt neg vpt 1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt -1.62 mul V Opaque stroke } def
/PentW { stroke [] 0 setdash gsave
  translate 0 hpt M 4 {72 rotate 0 hpt L} repeat
  Opaque stroke grestore } def
/CircW { stroke [] 0 setdash 
  hpt 0 360 arc Opaque stroke } def
/BoxFill { gsave Rec 1 setgray fill grestore } def
end
%%EndProlog
gnudict begin
gsave
50 50 translate
0.050 0.050 scale
0 setgray
newpath
(Helvetica) findfont 240 scalefont setfont
1.000 UL
LTb
960 720 M
63 0 V
5889 0 R
-63 0 V
816 720 M
(0) Rshow
960 1224 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(50) Rshow
960 1728 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(100) Rshow
960 2232 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(150) Rshow
960 2736 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(200) Rshow
960 3240 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(250) Rshow
960 3744 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(300) Rshow
960 4248 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(350) Rshow
960 4752 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(400) Rshow
960 720 M
0 63 V
0 3969 R
0 -63 V
960 480 M
(0) Cshow
2150 720 M
0 63 V
0 3969 R
0 -63 V
0 -4209 R
(5) Cshow
3341 720 M
0 63 V
0 3969 R
0 -63 V
0 -4209 R
(10) Cshow
4531 720 M
0 63 V
0 3969 R
0 -63 V
0 -4209 R
(15) Cshow
5722 720 M
0 63 V
0 3969 R
0 -63 V
0 -4209 R
(20) Cshow
6912 720 M
0 63 V
0 3969 R
0 -63 V
0 -4209 R
(25) Cshow
1.000 UL
LTb
960 720 M
5952 0 V
0 4032 V
-5952 0 V
960 720 L
0 2736 M
currentpoint gsave translate 90 rotate 0 0 M
(Mbits/sec) Cshow
grestore
3936 240 M
(Number of clients) Cshow
1.000 UP
1.000 UL
LT0
5841 4569 M
('normal') Rshow
5985 4569 M
639 0 V
1198 1397 M
238 29 V
714 82 V
1191 14 V
2381 37 V
1198 1397 Pls
1436 1426 Pls
2150 1508 Pls
3341 1522 Pls
5722 1559 Pls
6304 4569 Pls
1.000 UP
1.000 UL
LT1
5841 4329 M
('monitoring') Rshow
5985 4329 M
639 0 V
1198 1389 M
238 36 V
714 80 V
1191 16 V
2381 34 V
1198 1389 Crs
1436 1425 Crs
2150 1505 Crs
3341 1521 Crs
5722 1555 Crs
6304 4329 Crs
1.000 UP
1.000 UL
LT2
5841 4089 M
('localnormal') Rshow
5985 4089 M
639 0 V
1198 2897 M
238 565 V
714 -10 V
1191 60 V
2381 0 V
1198 2897 Star
1436 3462 Star
2150 3452 Star
3341 3512 Star
5722 3512 Star
6304 4089 Star
1.000 UP
1.000 UL
LT3
5841 3849 M
('localmonitoring') Rshow
5985 3849 M
639 0 V
1198 2290 M
238 436 V
714 -122 V
1191 -92 V
5722 2328 L
1198 2290 Box
1436 2726 Box
2150 2604 Box
3341 2512 Box
5722 2328 Box
6304 3849 Box
stroke
grestore
end
showpage

%%EndDocument
 @endspecial 215 1893 a Fi(Figure)23 b(8.)g(FTP)g(ser)q(ver)h(thr)n
(oughput)-138 2071 y Fp(to)d(the)h(disk,)f(the)g(elapsed)g(time)h(is)g
(much)e(lar)o(ger)g(than)h(CPU)h(time,)-138 2171 y(thus)30
b(the)g(percei)n(v)o(ed)e(increase)i(in)g(o)o(v)o(erhead)e(is)j
(typically)e(small)-138 2270 y(for)c(these)g(applications.)39
b(Due)26 b(to)f(opportunities)e(for)i(multiple)o(x-)-138
2370 y(ing)d(in)g(I/O,)h(the)f(percei)n(v)o(ed)e(o)o(v)o(erhead)g
(increases)i(when)g(multiple)-138 2470 y(concurrent)c(instances)i(of)g
(these)g(applications)f(are)h(run.)-138 2714 y Fh(6.1.3)81
b(Netw)o(ork)20 b(Ser)o(v)o(ers)-138 2877 y Fp(Netw)o(ork)k(serv)o(ers)
g(such)g(as)i Fm(ftpd)e Fp(and)g Fm(httpd)h Fp(are)f(among)f(the)-138
2977 y(most)30 b(important)e(applications)g(that)i(need)f(the)h
(increased)f(secu-)-138 3077 y(rity)e(of)n(fered)d(by)j(system)f(call)h
(monitoring.)42 b(Consequently)-5 b(,)26 b(our)-138 3176
y(performance)j(analysis)k(on)f(these)g(applications)f(is)j(more)d
(com-)-138 3276 y(prehensi)n(v)o(e.)22 b(Rather)d(than)g(measuring)e
(just)j(the)f(increase)f(in)h(CPU)-138 3376 y(time)24
b(due)e(to)i(system)f(call)h(interception,)e(our)h(e)o(xperiments)e
(were)-138 3475 y(geared)c(more)h(to)n(w)o(ards)g(e)n(v)n(aluating)e
(the)j(de)o(gradation)c(in)k(through-)-138 3575 y(put)h(and)f(latenc)o
(y)h(e)o(xperienced)d(by)j(clients)h(of)f(these)g(services.)-38
3679 y(The)i(test)i(suite)f(for)g Fm(ftpd)f Fp(consisted)h(of)f(se)n(v)
o(eral)h(\002les)h(whose)-138 3778 y(sizes)33 b(were)f(uniformly)d
(distrib)n(uted)i(o)o(v)o(er)g(the)g(range)g(of)h(0.5)f(to)-138
3878 y(5MB.)e(First,)j(we)d(ran)g(the)g(serv)o(er)f(and)h(client)g(on)f
(dif)n(ferent)g(ma-)-138 3978 y(chines.W)-7 b(e)26 b(ensured)e(that)i
(all)g(of)f(the)h(requested)e(\002les)j(w)o(ould)e(to-)-138
4077 y(gether)c(\002t)h(within)g(the)g(in-memory)d(\002le)j(cache)f
(for)h(the)f(serv)o(er)m(,)g(so)-138 4177 y(the)e(ef)n(fect)g(of)g
(disk)g(access)h(w)o(as)g(completely)e(eliminated)g(in)h(these)-138
4276 y(tests.)36 b(Figure)23 b(8)h(sho)n(ws)f(ho)n(w)g(the)h
(throughput)c(v)n(aries)j(as)i(a)f(func-)-138 4376 y(tion)32
b(of)g(the)h(number)d(of)i(clients.)62 b(The)32 b(graph)f(sho)n(ws)i
(that)f(the)-138 4476 y(throughput)25 b(is)30 b(limited)e(by)g(netw)o
(ork)g(bandwidth,)g(as)h(the)g(curv)o(e)-138 4575 y(\003attens)c(out)f
(around)f(80Mb/s,)i(which)f(is)h(probably)e(close)i(to)f(the)-138
4675 y(best)g(that)g(can)g(be)g(achie)n(v)o(ed)e(on)h(a)h(100Mb/s)f
(Ethernet,)g(when)h(all)-138 4775 y(of)29 b(the)g(protocol)e(o)o(v)o
(erheads)f(are)j(considered.)49 b(Since)29 b(the)g(CPU)-138
4874 y(utilization)i(remains)g(f)o(airly)g(lo)n(w)h(at)g(this)h(point)e
(\(around)e(20\045\),)-138 4974 y(the)21 b(o)o(v)o(erheads)d(of)j
(monitoring)e(do)h(not)h(af)n(fect)f(the)h(throughput)d(at)-138
5073 y(all;)23 b(thus)f(the)g(throughput)c(with)k(monitoring)e
(coincides)g(with)i(the)-138 5173 y(throughput)17 b(without)j
(monitoring.)-38 5277 y(T)-7 b(o)28 b(simulate)h(what)g(happens)e
(under)g(higher)h(CPU)h(loads)g(\(or)-138 5376 y(f)o(aster)g(netw)o
(orks\),)g(we)g(then)g(ran)f(the)h(client)g(and)f(serv)o(er)g(on)g(the)
-138 5476 y(same)c(machine.)37 b(Moreo)o(v)o(er)m(,)22
b(we)i(speci\002ed)g(the)h(local)f(\002le)h(name)-138
5576 y(on)h(the)h(client)f(to)h(be)g Fm(/dev/null)e Fp(so)i(as)g(to)g
(eliminate)f(the)h(ef-)-138 5675 y(fect)18 b(of)g(disk)g(access.)25
b(In)17 b(this)i(case,)g(the)f(throughput)d(is)k(limited)f(by)-138
5775 y(CPU)i(usage,)f(so)h(there)e(is)j(a)e(signi\002cant)g(de)o
(gradation)d(in)k(through-)2103 1710 y @beginspecial
50 @llx 50 @lly 410 @urx 302 @ury 2160 @rwi @setspecial
%%BeginDocument: httpthruput.eps
%!PS-Adobe-2.0 EPSF-2.0
%%Title: thruputfinal.eps
%%Creator: gnuplot 3.5 (pre 3.6) patchlevel beta 347
%%CreationDate: Tue Jun 22 20:29:10 1999
%%DocumentFonts: (atend)
%%BoundingBox: 50 50 410 302
%%Orientation: Portrait
%%EndComments
/gnudict 120 dict def
gnudict begin
/Color false def
/Solid false def
/gnulinewidth 5.000 def
/userlinewidth gnulinewidth def
/vshift -80 def
/dl {10 mul} def
/hpt_ 31.5 def
/vpt_ 31.5 def
/hpt hpt_ def
/vpt vpt_ def
/M {moveto} bind def
/L {lineto} bind def
/R {rmoveto} bind def
/V {rlineto} bind def
/vpt2 vpt 2 mul def
/hpt2 hpt 2 mul def
/Lshow { currentpoint stroke M
  0 vshift R show } def
/Rshow { currentpoint stroke M
  dup stringwidth pop neg vshift R show } def
/Cshow { currentpoint stroke M
  dup stringwidth pop -2 div vshift R show } def
/UP { dup vpt_ mul /vpt exch def hpt_ mul /hpt exch def
  /hpt2 hpt 2 mul def /vpt2 vpt 2 mul def } def
/DL { Color {setrgbcolor Solid {pop []} if 0 setdash }
 {pop pop pop Solid {pop []} if 0 setdash} ifelse } def
/BL { stroke gnulinewidth 2 mul setlinewidth } def
/AL { stroke gnulinewidth 2 div setlinewidth } def
/UL { gnulinewidth mul /userlinewidth exch def } def
/PL { stroke userlinewidth setlinewidth } def
/LTb { BL [] 0 0 0 DL } def
/LTa { AL [1 dl 2 dl] 0 setdash 0 0 0 setrgbcolor } def
/LT0 { PL [] 1 0 0 DL } def
/LT1 { PL [4 dl 2 dl] 0 1 0 DL } def
/LT2 { PL [2 dl 3 dl] 0 0 1 DL } def
/LT3 { PL [1 dl 1.5 dl] 1 0 1 DL } def
/LT4 { PL [5 dl 2 dl 1 dl 2 dl] 0 1 1 DL } def
/LT5 { PL [4 dl 3 dl 1 dl 3 dl] 1 1 0 DL } def
/LT6 { PL [2 dl 2 dl 2 dl 4 dl] 0 0 0 DL } def
/LT7 { PL [2 dl 2 dl 2 dl 2 dl 2 dl 4 dl] 1 0.3 0 DL } def
/LT8 { PL [2 dl 2 dl 2 dl 2 dl 2 dl 2 dl 2 dl 4 dl] 0.5 0.5 0.5 DL } def
/Pnt { stroke [] 0 setdash
   gsave 1 setlinecap M 0 0 V stroke grestore } def
/Dia { stroke [] 0 setdash 2 copy vpt add M
  hpt neg vpt neg V hpt vpt neg V
  hpt vpt V hpt neg vpt V closepath stroke
  Pnt } def
/Pls { stroke [] 0 setdash vpt sub M 0 vpt2 V
  currentpoint stroke M
  hpt neg vpt neg R hpt2 0 V stroke
  } def
/Box { stroke [] 0 setdash 2 copy exch hpt sub exch vpt add M
  0 vpt2 neg V hpt2 0 V 0 vpt2 V
  hpt2 neg 0 V closepath stroke
  Pnt } def
/Crs { stroke [] 0 setdash exch hpt sub exch vpt add M
  hpt2 vpt2 neg V currentpoint stroke M
  hpt2 neg 0 R hpt2 vpt2 V stroke } def
/TriU { stroke [] 0 setdash 2 copy vpt 1.12 mul add M
  hpt neg vpt -1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt 1.62 mul V closepath stroke
  Pnt  } def
/Star { 2 copy Pls Crs } def
/BoxF { stroke [] 0 setdash exch hpt sub exch vpt add M
  0 vpt2 neg V  hpt2 0 V  0 vpt2 V
  hpt2 neg 0 V  closepath fill } def
/TriUF { stroke [] 0 setdash vpt 1.12 mul add M
  hpt neg vpt -1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt 1.62 mul V closepath fill } def
/TriD { stroke [] 0 setdash 2 copy vpt 1.12 mul sub M
  hpt neg vpt 1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt -1.62 mul V closepath stroke
  Pnt  } def
/TriDF { stroke [] 0 setdash vpt 1.12 mul sub M
  hpt neg vpt 1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt -1.62 mul V closepath fill} def
/DiaF { stroke [] 0 setdash vpt add M
  hpt neg vpt neg V hpt vpt neg V
  hpt vpt V hpt neg vpt V closepath fill } def
/Pent { stroke [] 0 setdash 2 copy gsave
  translate 0 hpt M 4 {72 rotate 0 hpt L} repeat
  closepath stroke grestore Pnt } def
/PentF { stroke [] 0 setdash gsave
  translate 0 hpt M 4 {72 rotate 0 hpt L} repeat
  closepath fill grestore } def
/Circle { stroke [] 0 setdash 2 copy
  hpt 0 360 arc stroke Pnt } def
/CircleF { stroke [] 0 setdash hpt 0 360 arc fill } def
/C0 { BL [] 0 setdash 2 copy moveto vpt 90 450  arc } bind def
/C1 { BL [] 0 setdash 2 copy        moveto
       2 copy  vpt 0 90 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C2 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 90 180 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C3 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 0 180 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C4 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 180 270 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C5 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 0 90 arc
       2 copy moveto
       2 copy  vpt 180 270 arc closepath fill
               vpt 0 360 arc } bind def
/C6 { BL [] 0 setdash 2 copy moveto
      2 copy  vpt 90 270 arc closepath fill
              vpt 0 360 arc closepath } bind def
/C7 { BL [] 0 setdash 2 copy moveto
      2 copy  vpt 0 270 arc closepath fill
              vpt 0 360 arc closepath } bind def
/C8 { BL [] 0 setdash 2 copy moveto
      2 copy vpt 270 360 arc closepath fill
              vpt 0 360 arc closepath } bind def
/C9 { BL [] 0 setdash 2 copy moveto
      2 copy  vpt 270 450 arc closepath fill
              vpt 0 360 arc closepath } bind def
/C10 { BL [] 0 setdash 2 copy 2 copy moveto vpt 270 360 arc closepath fill
       2 copy moveto
       2 copy vpt 90 180 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C11 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 0 180 arc closepath fill
       2 copy moveto
       2 copy  vpt 270 360 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C12 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 180 360 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C13 { BL [] 0 setdash  2 copy moveto
       2 copy  vpt 0 90 arc closepath fill
       2 copy moveto
       2 copy  vpt 180 360 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C14 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 90 360 arc closepath fill
               vpt 0 360 arc } bind def
/C15 { BL [] 0 setdash 2 copy vpt 0 360 arc closepath fill
               vpt 0 360 arc closepath } bind def
/Rec   { newpath 4 2 roll moveto 1 index 0 rlineto 0 exch rlineto
       neg 0 rlineto closepath } bind def
/Square { dup Rec } bind def
/Bsquare { vpt sub exch vpt sub exch vpt2 Square } bind def
/S0 { BL [] 0 setdash 2 copy moveto 0 vpt rlineto BL Bsquare } bind def
/S1 { BL [] 0 setdash 2 copy vpt Square fill Bsquare } bind def
/S2 { BL [] 0 setdash 2 copy exch vpt sub exch vpt Square fill Bsquare } bind def
/S3 { BL [] 0 setdash 2 copy exch vpt sub exch vpt2 vpt Rec fill Bsquare } bind def
/S4 { BL [] 0 setdash 2 copy exch vpt sub exch vpt sub vpt Square fill Bsquare } bind def
/S5 { BL [] 0 setdash 2 copy 2 copy vpt Square fill
       exch vpt sub exch vpt sub vpt Square fill Bsquare } bind def
/S6 { BL [] 0 setdash 2 copy exch vpt sub exch vpt sub vpt vpt2 Rec fill Bsquare } bind def
/S7 { BL [] 0 setdash 2 copy exch vpt sub exch vpt sub vpt vpt2 Rec fill
       2 copy vpt Square fill
       Bsquare } bind def
/S8 { BL [] 0 setdash 2 copy vpt sub vpt Square fill Bsquare } bind def
/S9 { BL [] 0 setdash 2 copy vpt sub vpt vpt2 Rec fill Bsquare } bind def
/S10 { BL [] 0 setdash 2 copy vpt sub vpt Square fill 2 copy exch vpt sub exch vpt Square fill
       Bsquare } bind def
/S11 { BL [] 0 setdash 2 copy vpt sub vpt Square fill 2 copy exch vpt sub exch vpt2 vpt Rec fill
       Bsquare } bind def
/S12 { BL [] 0 setdash 2 copy exch vpt sub exch vpt sub vpt2 vpt Rec fill Bsquare } bind def
/S13 { BL [] 0 setdash 2 copy exch vpt sub exch vpt sub vpt2 vpt Rec fill
       2 copy vpt Square fill Bsquare } bind def
/S14 { BL [] 0 setdash 2 copy exch vpt sub exch vpt sub vpt2 vpt Rec fill
       2 copy exch vpt sub exch vpt Square fill Bsquare } bind def
/S15 { BL [] 0 setdash 2 copy Bsquare fill Bsquare } bind def
/D0 { gsave translate 45 rotate 0 0 S0 stroke grestore } bind def
/D1 { gsave translate 45 rotate 0 0 S1 stroke grestore } bind def
/D2 { gsave translate 45 rotate 0 0 S2 stroke grestore } bind def
/D3 { gsave translate 45 rotate 0 0 S3 stroke grestore } bind def
/D4 { gsave translate 45 rotate 0 0 S4 stroke grestore } bind def
/D5 { gsave translate 45 rotate 0 0 S5 stroke grestore } bind def
/D6 { gsave translate 45 rotate 0 0 S6 stroke grestore } bind def
/D7 { gsave translate 45 rotate 0 0 S7 stroke grestore } bind def
/D8 { gsave translate 45 rotate 0 0 S8 stroke grestore } bind def
/D9 { gsave translate 45 rotate 0 0 S9 stroke grestore } bind def
/D10 { gsave translate 45 rotate 0 0 S10 stroke grestore } bind def
/D11 { gsave translate 45 rotate 0 0 S11 stroke grestore } bind def
/D12 { gsave translate 45 rotate 0 0 S12 stroke grestore } bind def
/D13 { gsave translate 45 rotate 0 0 S13 stroke grestore } bind def
/D14 { gsave translate 45 rotate 0 0 S14 stroke grestore } bind def
/D15 { gsave translate 45 rotate 0 0 S15 stroke grestore } bind def
/DiaE { stroke [] 0 setdash vpt add M
  hpt neg vpt neg V hpt vpt neg V
  hpt vpt V hpt neg vpt V closepath stroke } def
/BoxE { stroke [] 0 setdash exch hpt sub exch vpt add M
  0 vpt2 neg V hpt2 0 V 0 vpt2 V
  hpt2 neg 0 V closepath stroke } def
/TriUE { stroke [] 0 setdash vpt 1.12 mul add M
  hpt neg vpt -1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt 1.62 mul V closepath stroke } def
/TriDE { stroke [] 0 setdash vpt 1.12 mul sub M
  hpt neg vpt 1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt -1.62 mul V closepath stroke } def
/PentE { stroke [] 0 setdash gsave
  translate 0 hpt M 4 {72 rotate 0 hpt L} repeat
  closepath stroke grestore } def
/CircE { stroke [] 0 setdash 
  hpt 0 360 arc stroke } def
/Opaque { gsave closepath 1 setgray fill grestore 0 setgray closepath } def
/DiaW { stroke [] 0 setdash vpt add M
  hpt neg vpt neg V hpt vpt neg V
  hpt vpt V hpt neg vpt V Opaque stroke } def
/BoxW { stroke [] 0 setdash exch hpt sub exch vpt add M
  0 vpt2 neg V hpt2 0 V 0 vpt2 V
  hpt2 neg 0 V Opaque stroke } def
/TriUW { stroke [] 0 setdash vpt 1.12 mul add M
  hpt neg vpt -1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt 1.62 mul V Opaque stroke } def
/TriDW { stroke [] 0 setdash vpt 1.12 mul sub M
  hpt neg vpt 1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt -1.62 mul V Opaque stroke } def
/PentW { stroke [] 0 setdash gsave
  translate 0 hpt M 4 {72 rotate 0 hpt L} repeat
  Opaque stroke grestore } def
/CircW { stroke [] 0 setdash 
  hpt 0 360 arc Opaque stroke } def
/BoxFill { gsave Rec 1 setgray fill grestore } def
end
%%EndProlog
gnudict begin
gsave
50 50 translate
0.050 0.050 scale
0 setgray
newpath
(Helvetica) findfont 240 scalefont setfont
1.000 UL
LTb
960 720 M
63 0 V
5889 0 R
-63 0 V
816 720 M
(0) Rshow
960 1258 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(20) Rshow
960 1795 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(40) Rshow
960 2333 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(60) Rshow
960 2870 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(80) Rshow
960 3408 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(100) Rshow
960 3946 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(120) Rshow
960 4483 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(140) Rshow
960 720 M
0 63 V
0 3969 R
0 -63 V
960 480 M
(0) Cshow
2042 720 M
0 63 V
0 3969 R
0 -63 V
0 -4209 R
(20) Cshow
3124 720 M
0 63 V
0 3969 R
0 -63 V
0 -4209 R
(40) Cshow
4207 720 M
0 63 V
0 3969 R
0 -63 V
0 -4209 R
(60) Cshow
5289 720 M
0 63 V
0 3969 R
0 -63 V
0 -4209 R
(80) Cshow
6371 720 M
0 63 V
0 3969 R
0 -63 V
0 -4209 R
(100) Cshow
1.000 UL
LTb
960 720 M
5952 0 V
0 4032 V
-5952 0 V
960 720 L
0 2736 M
currentpoint gsave translate 90 rotate 0 0 M
(Mbits/sec) Cshow
grestore
3936 240 M
(Number of clients) Cshow
1.000 UP
1.000 UL
LT0
5841 4569 M
('normal') Rshow
5985 4569 M
639 0 V
1501 2051 M
541 367 V
541 128 V
541 68 V
541 60 V
542 29 V
541 18 V
541 16 V
541 1 V
541 1 V
1501 2051 Pls
2042 2418 Pls
2583 2546 Pls
3124 2614 Pls
3665 2674 Pls
4207 2703 Pls
4748 2721 Pls
5289 2737 Pls
5830 2738 Pls
6371 2739 Pls
6304 4569 Pls
1.000 UP
1.000 UL
LT1
5841 4329 M
('monitoring') Rshow
5985 4329 M
639 0 V
1501 1877 M
541 247 V
541 141 V
541 55 V
541 81 V
542 6 V
541 -4 V
541 17 V
541 40 V
541 -43 V
1501 1877 Crs
2042 2124 Crs
2583 2265 Crs
3124 2320 Crs
3665 2401 Crs
4207 2407 Crs
4748 2403 Crs
5289 2420 Crs
5830 2460 Crs
6371 2417 Crs
6304 4329 Crs
1.000 UP
1.000 UL
LT2
5841 4089 M
('localnormal') Rshow
5985 4089 M
639 0 V
1501 3241 M
541 -88 V
541 25 V
541 31 V
541 -26 V
542 47 V
541 -54 V
541 -50 V
541 7 V
541 12 V
1501 3241 Star
2042 3153 Star
2583 3178 Star
3124 3209 Star
3665 3183 Star
4207 3230 Star
4748 3176 Star
5289 3126 Star
5830 3133 Star
6371 3145 Star
6304 4089 Star
1.000 UP
1.000 UL
LT3
5841 3849 M
('localmonitoring') Rshow
5985 3849 M
639 0 V
1501 2296 M
541 24 V
541 59 V
541 30 V
541 7 V
542 35 V
541 -32 V
541 -57 V
541 -35 V
541 -44 V
1501 2296 Box
2042 2320 Box
2583 2379 Box
3124 2409 Box
3665 2416 Box
4207 2451 Box
4748 2419 Box
5289 2362 Box
5830 2327 Box
6371 2283 Box
6304 3849 Box
stroke
grestore
end
showpage
%%Trailer
%%DocumentFonts: Helvetica

%%EndDocument
 @endspecial 2341 1893 a Fi(Figure)j(9.)g(HTTP)g(ser)q(ver)h(thr)n
(oughput)2018 2080 y Fp(put.)2118 2189 y(Figures)17 b(9)g(sho)n(ws)g
(throughput)d(results)k(for)e Fm(httpd)p Fp(.)24 b(The)16
b(tests)2018 2288 y(were)g(performed)d(using)i(W)-7 b(ebStone,)16
b(which)f(is)i(one)e(of)g(the)h(widely)2018 2388 y(used)34
b(benchmarks)e(for)i(web)g(serv)o(er)g(performance.)64
b(W)-7 b(e)36 b(used)2018 2487 y(W)-7 b(ebStone)27 b(with)h(the)f
(standard)f(\002leset)j(included)c(in)j(the)f(bench-)2018
2587 y(mark.)c(W)-7 b(e)16 b(used)f(tw)o(o)h(client)f(machines)g(and)g
(one)f(serv)o(er)h(machine.)2018 2687 y(W)-7 b(e)21 b(tested)e
(starting)g(with)h(10)e(clients)i(going)e(to)h(100)g(clients)g(in)h
(in-)2018 2786 y(crements)30 b(of)h(10.)56 b(The)31 b(time)g(per)f(run)
g(w)o(as)i(set)g(to)f(10)f(minutes)2018 2886 y(and)21
b(we)i(took)e(3)g(iterations.)30 b(On)21 b(the)h(serv)o(er)m(,)f(httpd)
g(w)o(as)h(run)f(with)2018 2986 y(and)d(without)g(monitoring.)j(W)-7
b(ebStone)19 b(pro)o(vided)c(us)k(with)g(the)f(re-)2018
3085 y(sults)26 b(for)e(the)h(throughput)c(and)j(the)h(response)f
(times.)39 b(When)25 b(the)2018 3185 y(client)18 b(and)f(serv)o(er)f
(are)h(run)g(on)g(dif)n(ferent)f(machines,)h(the)g(through-)2018
3284 y(put)28 b(saturates)f(at)i(about)d(75Mb/s)i(when)f(no)g
(monitoring)e(is)k(per)n(-)2018 3384 y(formed.)h(\(This)23
b(number)d(is)k(lo)n(wer)e(than)g(that)g(for)g Fm(ftpd)p
Fp(,)h(re\003ect-)2018 3484 y(ing)i(a)h(higher)e(o)o(v)o(erhead)e(for)j
(HTTP)g(due)g(to)g(the)h(protocol)d(itself,)2018 3583
y(and)g(due)g(to)g(a)h(dif)n(ferent)d(distrib)n(ution)h(of)h(\002le)h
(sizes.\))35 b(At)24 b(the)f(sat-)2018 3683 y(uration)f(point,)g(the)h
(CPU)h(utilization)e(is)i(suf)n(\002ciently)e(high)g(to)h(re-)2018
3783 y(sult)f(in)f(measurable)e(drop)h(in)h(throughput)d(of)j(about)f
(15\045.)27 b(When)2018 3882 y(the)19 b(e)o(xperiments)f(are)h
(performed)d(with)k(the)f(client)g(and)g(serv)o(er)f(on)2018
3982 y(the)27 b(same)g(machine,)g(the)g(o)o(v)o(erhead)d(is)j(e)n(v)o
(en)f(more)g(pronounced)2018 4081 y(\(about)20 b(30)h(to)g(35\045\).)27
b(W)-7 b(ebStone)21 b(also)h(pro)o(vides)d(response)h(times)2018
4181 y(for)d Fm(httpd)p Fp(,)h(which)f(are)h(sho)n(wn)f(in)h(Figure)f
(10.)24 b(\(Response)17 b(times)2018 4281 y(are)j(not)g(v)o(ery)f
(meaningful)f(in)i(our)f Fm(ftpd)h Fp(e)o(xperiments)e(since)j(the)2018
4380 y(lar)o(ge)j(\002le)h(sizes)g(meant)f(that)h(the)f(time)h(to)g
(recei)n(v)o(e)e(a)i(\002le)g(w)o(as)g(al-)2018 4480
y(most)20 b(completely)f(due)h(to)g(the)g(time)h(for)e(transferring)f
(the)j(\002les.\))2103 5761 y @beginspecial 50 @llx 50
@lly 410 @urx 302 @ury 2160 @rwi @setspecial
%%BeginDocument: response.eps
%!PS-Adobe-2.0 EPSF-2.0
%%Title: responsefinal.eps
%%Creator: gnuplot 3.5 (pre 3.6) patchlevel beta 347
%%CreationDate: Tue Jun 22 20:33:01 1999
%%DocumentFonts: (atend)
%%BoundingBox: 50 50 410 302
%%Orientation: Portrait
%%EndComments
/gnudict 120 dict def
gnudict begin
/Color false def
/Solid false def
/gnulinewidth 5.000 def
/userlinewidth gnulinewidth def
/vshift -80 def
/dl {10 mul} def
/hpt_ 31.5 def
/vpt_ 31.5 def
/hpt hpt_ def
/vpt vpt_ def
/M {moveto} bind def
/L {lineto} bind def
/R {rmoveto} bind def
/V {rlineto} bind def
/vpt2 vpt 2 mul def
/hpt2 hpt 2 mul def
/Lshow { currentpoint stroke M
  0 vshift R show } def
/Rshow { currentpoint stroke M
  dup stringwidth pop neg vshift R show } def
/Cshow { currentpoint stroke M
  dup stringwidth pop -2 div vshift R show } def
/UP { dup vpt_ mul /vpt exch def hpt_ mul /hpt exch def
  /hpt2 hpt 2 mul def /vpt2 vpt 2 mul def } def
/DL { Color {setrgbcolor Solid {pop []} if 0 setdash }
 {pop pop pop Solid {pop []} if 0 setdash} ifelse } def
/BL { stroke gnulinewidth 2 mul setlinewidth } def
/AL { stroke gnulinewidth 2 div setlinewidth } def
/UL { gnulinewidth mul /userlinewidth exch def } def
/PL { stroke userlinewidth setlinewidth } def
/LTb { BL [] 0 0 0 DL } def
/LTa { AL [1 dl 2 dl] 0 setdash 0 0 0 setrgbcolor } def
/LT0 { PL [] 1 0 0 DL } def
/LT1 { PL [4 dl 2 dl] 0 1 0 DL } def
/LT2 { PL [2 dl 3 dl] 0 0 1 DL } def
/LT3 { PL [1 dl 1.5 dl] 1 0 1 DL } def
/LT4 { PL [5 dl 2 dl 1 dl 2 dl] 0 1 1 DL } def
/LT5 { PL [4 dl 3 dl 1 dl 3 dl] 1 1 0 DL } def
/LT6 { PL [2 dl 2 dl 2 dl 4 dl] 0 0 0 DL } def
/LT7 { PL [2 dl 2 dl 2 dl 2 dl 2 dl 4 dl] 1 0.3 0 DL } def
/LT8 { PL [2 dl 2 dl 2 dl 2 dl 2 dl 2 dl 2 dl 4 dl] 0.5 0.5 0.5 DL } def
/Pnt { stroke [] 0 setdash
   gsave 1 setlinecap M 0 0 V stroke grestore } def
/Dia { stroke [] 0 setdash 2 copy vpt add M
  hpt neg vpt neg V hpt vpt neg V
  hpt vpt V hpt neg vpt V closepath stroke
  Pnt } def
/Pls { stroke [] 0 setdash vpt sub M 0 vpt2 V
  currentpoint stroke M
  hpt neg vpt neg R hpt2 0 V stroke
  } def
/Box { stroke [] 0 setdash 2 copy exch hpt sub exch vpt add M
  0 vpt2 neg V hpt2 0 V 0 vpt2 V
  hpt2 neg 0 V closepath stroke
  Pnt } def
/Crs { stroke [] 0 setdash exch hpt sub exch vpt add M
  hpt2 vpt2 neg V currentpoint stroke M
  hpt2 neg 0 R hpt2 vpt2 V stroke } def
/TriU { stroke [] 0 setdash 2 copy vpt 1.12 mul add M
  hpt neg vpt -1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt 1.62 mul V closepath stroke
  Pnt  } def
/Star { 2 copy Pls Crs } def
/BoxF { stroke [] 0 setdash exch hpt sub exch vpt add M
  0 vpt2 neg V  hpt2 0 V  0 vpt2 V
  hpt2 neg 0 V  closepath fill } def
/TriUF { stroke [] 0 setdash vpt 1.12 mul add M
  hpt neg vpt -1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt 1.62 mul V closepath fill } def
/TriD { stroke [] 0 setdash 2 copy vpt 1.12 mul sub M
  hpt neg vpt 1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt -1.62 mul V closepath stroke
  Pnt  } def
/TriDF { stroke [] 0 setdash vpt 1.12 mul sub M
  hpt neg vpt 1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt -1.62 mul V closepath fill} def
/DiaF { stroke [] 0 setdash vpt add M
  hpt neg vpt neg V hpt vpt neg V
  hpt vpt V hpt neg vpt V closepath fill } def
/Pent { stroke [] 0 setdash 2 copy gsave
  translate 0 hpt M 4 {72 rotate 0 hpt L} repeat
  closepath stroke grestore Pnt } def
/PentF { stroke [] 0 setdash gsave
  translate 0 hpt M 4 {72 rotate 0 hpt L} repeat
  closepath fill grestore } def
/Circle { stroke [] 0 setdash 2 copy
  hpt 0 360 arc stroke Pnt } def
/CircleF { stroke [] 0 setdash hpt 0 360 arc fill } def
/C0 { BL [] 0 setdash 2 copy moveto vpt 90 450  arc } bind def
/C1 { BL [] 0 setdash 2 copy        moveto
       2 copy  vpt 0 90 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C2 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 90 180 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C3 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 0 180 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C4 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 180 270 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C5 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 0 90 arc
       2 copy moveto
       2 copy  vpt 180 270 arc closepath fill
               vpt 0 360 arc } bind def
/C6 { BL [] 0 setdash 2 copy moveto
      2 copy  vpt 90 270 arc closepath fill
              vpt 0 360 arc closepath } bind def
/C7 { BL [] 0 setdash 2 copy moveto
      2 copy  vpt 0 270 arc closepath fill
              vpt 0 360 arc closepath } bind def
/C8 { BL [] 0 setdash 2 copy moveto
      2 copy vpt 270 360 arc closepath fill
              vpt 0 360 arc closepath } bind def
/C9 { BL [] 0 setdash 2 copy moveto
      2 copy  vpt 270 450 arc closepath fill
              vpt 0 360 arc closepath } bind def
/C10 { BL [] 0 setdash 2 copy 2 copy moveto vpt 270 360 arc closepath fill
       2 copy moveto
       2 copy vpt 90 180 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C11 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 0 180 arc closepath fill
       2 copy moveto
       2 copy  vpt 270 360 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C12 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 180 360 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C13 { BL [] 0 setdash  2 copy moveto
       2 copy  vpt 0 90 arc closepath fill
       2 copy moveto
       2 copy  vpt 180 360 arc closepath fill
               vpt 0 360 arc closepath } bind def
/C14 { BL [] 0 setdash 2 copy moveto
       2 copy  vpt 90 360 arc closepath fill
               vpt 0 360 arc } bind def
/C15 { BL [] 0 setdash 2 copy vpt 0 360 arc closepath fill
               vpt 0 360 arc closepath } bind def
/Rec   { newpath 4 2 roll moveto 1 index 0 rlineto 0 exch rlineto
       neg 0 rlineto closepath } bind def
/Square { dup Rec } bind def
/Bsquare { vpt sub exch vpt sub exch vpt2 Square } bind def
/S0 { BL [] 0 setdash 2 copy moveto 0 vpt rlineto BL Bsquare } bind def
/S1 { BL [] 0 setdash 2 copy vpt Square fill Bsquare } bind def
/S2 { BL [] 0 setdash 2 copy exch vpt sub exch vpt Square fill Bsquare } bind def
/S3 { BL [] 0 setdash 2 copy exch vpt sub exch vpt2 vpt Rec fill Bsquare } bind def
/S4 { BL [] 0 setdash 2 copy exch vpt sub exch vpt sub vpt Square fill Bsquare } bind def
/S5 { BL [] 0 setdash 2 copy 2 copy vpt Square fill
       exch vpt sub exch vpt sub vpt Square fill Bsquare } bind def
/S6 { BL [] 0 setdash 2 copy exch vpt sub exch vpt sub vpt vpt2 Rec fill Bsquare } bind def
/S7 { BL [] 0 setdash 2 copy exch vpt sub exch vpt sub vpt vpt2 Rec fill
       2 copy vpt Square fill
       Bsquare } bind def
/S8 { BL [] 0 setdash 2 copy vpt sub vpt Square fill Bsquare } bind def
/S9 { BL [] 0 setdash 2 copy vpt sub vpt vpt2 Rec fill Bsquare } bind def
/S10 { BL [] 0 setdash 2 copy vpt sub vpt Square fill 2 copy exch vpt sub exch vpt Square fill
       Bsquare } bind def
/S11 { BL [] 0 setdash 2 copy vpt sub vpt Square fill 2 copy exch vpt sub exch vpt2 vpt Rec fill
       Bsquare } bind def
/S12 { BL [] 0 setdash 2 copy exch vpt sub exch vpt sub vpt2 vpt Rec fill Bsquare } bind def
/S13 { BL [] 0 setdash 2 copy exch vpt sub exch vpt sub vpt2 vpt Rec fill
       2 copy vpt Square fill Bsquare } bind def
/S14 { BL [] 0 setdash 2 copy exch vpt sub exch vpt sub vpt2 vpt Rec fill
       2 copy exch vpt sub exch vpt Square fill Bsquare } bind def
/S15 { BL [] 0 setdash 2 copy Bsquare fill Bsquare } bind def
/D0 { gsave translate 45 rotate 0 0 S0 stroke grestore } bind def
/D1 { gsave translate 45 rotate 0 0 S1 stroke grestore } bind def
/D2 { gsave translate 45 rotate 0 0 S2 stroke grestore } bind def
/D3 { gsave translate 45 rotate 0 0 S3 stroke grestore } bind def
/D4 { gsave translate 45 rotate 0 0 S4 stroke grestore } bind def
/D5 { gsave translate 45 rotate 0 0 S5 stroke grestore } bind def
/D6 { gsave translate 45 rotate 0 0 S6 stroke grestore } bind def
/D7 { gsave translate 45 rotate 0 0 S7 stroke grestore } bind def
/D8 { gsave translate 45 rotate 0 0 S8 stroke grestore } bind def
/D9 { gsave translate 45 rotate 0 0 S9 stroke grestore } bind def
/D10 { gsave translate 45 rotate 0 0 S10 stroke grestore } bind def
/D11 { gsave translate 45 rotate 0 0 S11 stroke grestore } bind def
/D12 { gsave translate 45 rotate 0 0 S12 stroke grestore } bind def
/D13 { gsave translate 45 rotate 0 0 S13 stroke grestore } bind def
/D14 { gsave translate 45 rotate 0 0 S14 stroke grestore } bind def
/D15 { gsave translate 45 rotate 0 0 S15 stroke grestore } bind def
/DiaE { stroke [] 0 setdash vpt add M
  hpt neg vpt neg V hpt vpt neg V
  hpt vpt V hpt neg vpt V closepath stroke } def
/BoxE { stroke [] 0 setdash exch hpt sub exch vpt add M
  0 vpt2 neg V hpt2 0 V 0 vpt2 V
  hpt2 neg 0 V closepath stroke } def
/TriUE { stroke [] 0 setdash vpt 1.12 mul add M
  hpt neg vpt -1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt 1.62 mul V closepath stroke } def
/TriDE { stroke [] 0 setdash vpt 1.12 mul sub M
  hpt neg vpt 1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt -1.62 mul V closepath stroke } def
/PentE { stroke [] 0 setdash gsave
  translate 0 hpt M 4 {72 rotate 0 hpt L} repeat
  closepath stroke grestore } def
/CircE { stroke [] 0 setdash 
  hpt 0 360 arc stroke } def
/Opaque { gsave closepath 1 setgray fill grestore 0 setgray closepath } def
/DiaW { stroke [] 0 setdash vpt add M
  hpt neg vpt neg V hpt vpt neg V
  hpt vpt V hpt neg vpt V Opaque stroke } def
/BoxW { stroke [] 0 setdash exch hpt sub exch vpt add M
  0 vpt2 neg V hpt2 0 V 0 vpt2 V
  hpt2 neg 0 V Opaque stroke } def
/TriUW { stroke [] 0 setdash vpt 1.12 mul add M
  hpt neg vpt -1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt 1.62 mul V Opaque stroke } def
/TriDW { stroke [] 0 setdash vpt 1.12 mul sub M
  hpt neg vpt 1.62 mul V
  hpt 2 mul 0 V
  hpt neg vpt -1.62 mul V Opaque stroke } def
/PentW { stroke [] 0 setdash gsave
  translate 0 hpt M 4 {72 rotate 0 hpt L} repeat
  Opaque stroke grestore } def
/CircW { stroke [] 0 setdash 
  hpt 0 360 arc Opaque stroke } def
/BoxFill { gsave Rec 1 setgray fill grestore } def
end
%%EndProlog
gnudict begin
gsave
50 50 translate
0.050 0.050 scale
0 setgray
newpath
(Helvetica) findfont 240 scalefont setfont
1.000 UL
LTb
960 720 M
63 0 V
5889 0 R
-63 0 V
816 720 M
(0) Rshow
960 1296 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(50) Rshow
960 1872 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(100) Rshow
960 2448 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(150) Rshow
960 3024 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(200) Rshow
960 3600 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(250) Rshow
960 4176 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(300) Rshow
960 4752 M
63 0 V
5889 0 R
-63 0 V
-6033 0 R
(350) Rshow
960 720 M
0 63 V
0 3969 R
0 -63 V
960 480 M
(0) Cshow
2042 720 M
0 63 V
0 3969 R
0 -63 V
0 -4209 R
(20) Cshow
3124 720 M
0 63 V
0 3969 R
0 -63 V
0 -4209 R
(40) Cshow
4207 720 M
0 63 V
0 3969 R
0 -63 V
0 -4209 R
(60) Cshow
5289 720 M
0 63 V
0 3969 R
0 -63 V
0 -4209 R
(80) Cshow
6371 720 M
0 63 V
0 3969 R
0 -63 V
0 -4209 R
(100) Cshow
1.000 UL
LTb
960 720 M
5952 0 V
0 4032 V
-5952 0 V
960 720 L
0 2736 M
currentpoint gsave translate 90 rotate 0 0 M
(Latency (milliseconds)) Cshow
grestore
3936 240 M
(Number of clients) Cshow
1.000 UP
1.000 UL
LT0
5841 4569 M
('normal') Rshow
5985 4569 M
639 0 V
1501 1094 M
541 184 V
541 228 V
541 196 V
541 261 V
542 168 V
541 238 V
541 260 V
541 143 V
541 223 V
1501 1094 Pls
2042 1278 Pls
2583 1506 Pls
3124 1702 Pls
3665 1963 Pls
4207 2131 Pls
4748 2369 Pls
5289 2629 Pls
5830 2772 Pls
6371 2995 Pls
6304 4569 Pls
1.000 UP
1.000 UL
LT1
5841 4329 M
('monitoring') Rshow
5985 4329 M
639 0 V
1501 1115 M
541 271 V
541 266 V
541 250 V
541 237 V
542 269 V
541 260 V
541 293 V
541 299 V
541 248 V
1501 1115 Crs
2042 1386 Crs
2583 1652 Crs
3124 1902 Crs
3665 2139 Crs
4207 2408 Crs
4748 2668 Crs
5289 2961 Crs
5830 3260 Crs
6371 3508 Crs
6304 4329 Crs
1.000 UP
1.000 UL
LT2
5841 4089 M
('localnormal') Rshow
5985 4089 M
639 0 V
1501 908 M
541 188 V
541 197 V
541 202 V
541 203 V
542 192 V
541 207 V
541 191 V
541 198 V
541 200 V
1501 908 Star
2042 1096 Star
2583 1293 Star
3124 1495 Star
3665 1698 Star
4207 1890 Star
4748 2097 Star
5289 2288 Star
5830 2486 Star
6371 2686 Star
6304 4089 Star
1.000 UP
1.000 UL
LT3
5841 3849 M
('localmonitoring') Rshow
5985 3849 M
639 0 V
1501 1003 M
541 300 V
541 290 V
541 277 V
541 319 V
542 261 V
541 304 V
541 316 V
541 399 V
541 178 V
1501 1003 Box
2042 1303 Box
2583 1593 Box
3124 1870 Box
3665 2189 Box
4207 2450 Box
4748 2754 Box
5289 3070 Box
5830 3469 Box
6371 3647 Box
6304 3849 Box
stroke
grestore
end
showpage

%%EndDocument
 @endspecial 2381 5944 a Fi(Figure)i(10.)h(HTTP)e(response)i(time)r(.)p
eop
%%Page: 13 13
13 12 bop 413 453 3023 4 v 411 553 4 100 v 428 553 V
480 523 a Fp(Operating)p 860 553 V 97 w(Intercept)p 1255
553 V 98 w(Access)21 b(ar)o(guments)p 1954 553 V 97 w(Access)g
(\002lenames)p 2628 553 V 131 w(F)o(ollo)n(w)f(all)h(pointers)p
3417 553 V 3434 553 V 2630 556 806 4 v 411 653 4 100
v 428 653 V 480 623 a(System)p 860 653 V 334 w(only)p
1255 653 V 246 w(\(read-mostly\))p 1954 653 V 219 w(\(read-mostly\))p
2628 653 V 97 w(\(read\))p 2926 653 V 97 w(\(read/write\))p
3417 653 V 3434 653 V 413 656 3023 4 v 411 756 4 100
v 428 756 V 480 726 a(IRIX)p 860 756 V 403 w(55\045)p
1255 756 V 547 w(55\045)p 1954 756 V 521 w(75\045)p 2628
756 V 103 w(330\045)p 2926 756 V 297 w(400\045)p 3417
756 V 3434 756 V 411 855 V 428 855 V 480 825 a(Linux)p
860 855 V 374 w(27\045)p 1255 855 V 547 w(34\045)p 1954
855 V 521 w(39\045)p 2628 855 V 145 w(60\045)p 2926 855
V 255 w(2000\045)p 3417 855 V 3434 855 V 413 858 3023
4 v 595 1010 a Fi(Figure)i(11.)g(Overhead)g(f)n(or)g(reading)g(and)g
(writing)f(system)h(call)h(ar)o(guments.)p 403 1281 886
4 v 401 1380 4 100 v 418 1380 V 470 1350 a Fp(Operating)p
850 1380 V 97 w(Ov)o(erhead)p 1271 1380 V 1288 1380 V
401 1480 V 418 1480 V 470 1450 a(System)p 850 1480 V
1271 1480 V 1288 1480 V 403 1483 886 4 v 401 1583 4 100
v 418 1583 V 470 1553 a(Linux)p 850 1583 V 401 w(37\045)p
1271 1583 V 1288 1583 V 403 1586 886 4 v 401 1686 4 100
v 418 1686 V 470 1656 a(IRIX)p 850 1686 V 430 w(60\045)p
1271 1686 V 1288 1686 V 403 1689 886 4 v 401 1789 4 100
v 418 1789 V 470 1759 a(OSF/1)p 850 1789 V 384 w(35\045)p
1271 1789 V 1288 1789 V 403 1792 886 4 v -38 1942 a Fi(Figure)54
b(12.)h(Inter)n(ception)f(o)n(verhead)h(on)g(IRIX,)-38
2042 y(OSF/1)23 b(and)f(Lin)o(ux.)-138 2272 y Fl(6.2)90
b(Inter)n(ception)19 b(Ov)o(erheads)e(on)i(Other)h(UNIX)f(V)-8
b(ari\255)67 2372 y(ants)-38 2576 y Fp(T)h(able)27 b(12)f(sho)n(ws)h
(the)g(o)o(v)o(erheads)e(for)h(system)h(call)h(intercep-)-138
2676 y(tion)21 b(on)g(tw)o(o)h(v)n(ariants)e(of)h(System)h(V)g(Release)
g(4)f(compatible)f(op-)-138 2776 y(erating)f(systems,)h(namely)-5
b(,)18 b(Irix)h(and)g(OSF/1.)25 b(W)-7 b(e)20 b(only)f(sho)n(w)g(the)
-138 2875 y(a)n(v)o(erage)g(of)i(the)f(o)o(v)o(erheads)e(among)h(the)i
(six)g(applications)e(sho)n(wn)-138 2975 y(in)j(pre)n(vious)f(tables.)
30 b(These)22 b(operating)f(systems)h(pro)o(vide)e(a)j(\002ner)-138
3075 y(granularity)16 b(of)j(control)e(o)o(v)o(er)g(what)i(system)f
(calls)i(are)e(to)h(be)f(mon-)-138 3174 y(itored.)26
b(W)-7 b(e)22 b(used)f(this)g(capability)f(so)h(that)g(we)h(ignored)d
(\223uninter)n(-)-138 3274 y(esting\224)f(system)h(calls)h(lik)o(e)f
Fm(read)f Fp(and)g Fm(write)p Fp(.)24 b(In)19 b(addition,)e(for)-138
3373 y(most)i(system)f(calls,)i(we)e(intercepted)f(only)h(the)h(entry)e
(and)h(not)g(the)-138 3473 y(e)o(xit.)29 b(The)21 b(o)o(v)o(erheads)e
(for)i(interception)f(under)g(these)i(conditions)-138
3573 y(are)i(sho)n(wn)g(in)h(the)g(table)f(and)g(compared)f(against)g
(the)i(times)g(ob-)-138 3672 y(tained)20 b(for)g(Linux.)25
b(Although)19 b(Linux)h(does)g(not)h(permit)f(selecti)n(v)o(e)-138
3772 y(monitoring)h(of)j(a)g(subset)f(of)h(system)f(calls,)i(this)f(f)o
(actor)f(does)h(not)-138 3872 y(necessarily)c(translate)g(into)g(a)g
(higher)f(o)o(v)o(erhead)f(for)h(monitoring.)-138 4076
y Fl(6.3)90 b(Ov)o(erhead)21 b(f)n(or)h(F)n(etching)g(Ar)o(guments)-38
4281 y Fp(T)-7 b(able)19 b(11)g(sho)n(ws)h(the)f(o)o(v)o(erheads)e(for)
i(accessing)g(and/or)f(mod-)-138 4380 y(ifying)27 b(system)i(call)g(ar)
o(guments.)47 b(The)28 b(o)o(v)o(erhead)d(sho)n(wn)j(is)h(the)-138
4480 y(a)n(v)o(erage)24 b(tak)o(en)h(across)h Fm(ghostscript)p
Fp(,)f Fm(tar)h Fp(and)f Fm(ftpd)p Fp(.)41 b(In)-138
4579 y(Linux,)22 b(accessing)h(each)f(system)h(call)h(ar)o(gument)c
(requires)i(a)h(sin-)-138 4679 y(gle)18 b(system)g(call)h(in)f(the)g
(monitoring)d(process,)j(so)h(there)e(is)i(a)f(mod-)-138
4779 y(est)28 b(o)o(v)o(erhead)d(for)i(getting)g(these)g(v)n(alues.)47
b(In)27 b(IRIX,)g(no)g(system)-138 4878 y(calls)f(need)e(be)g(made)h
(to)g(access)g(the)g(ar)o(guments,)e(so)j(there)e(is)i(no)-138
4978 y(additional)31 b(o)o(v)o(erhead.)58 b(When)32 b(we)g(follo)n(w)g
(pointer)e(ar)o(guments)-138 5078 y(and)e(access)g(the)h(monitored)d
(process)h(memory)-5 b(,)28 b(we)h(ha)n(v)o(e)e(addi-)-138
5177 y(tional)18 b(o)o(v)o(erheads.)j(In)d(most)g(cases,)h(we)f(are)g
(interested)f(in)h(access-)-138 5277 y(ing)d(ar)o(guments)f(that)h(are)
h(strings)f(of)h(relati)n(v)o(ely)e(small)i(size)g(such)g(as)-138
5376 y(\002le)i(names,)e(and)h(the)g(o)o(v)o(erhead)d(increase)i(is)i
(small.)24 b(But)18 b(when)e(we)-138 5476 y(follo)n(w)k(all)h(pointer)e
(ar)o(guments,)f(we)j(end)f(up)g(reading)f(the)h(b)n(uf)n(fers)-138
5576 y(used)26 b(for)h(\002le)g(read)f(and)g(write)h(operations,)g(and)
f(this)h(leads)g(to)g(a)-138 5675 y(substantial)g(o)o(v)o(erhead.)43
b(In)27 b(the)g(case)g(of)g(Linux,)h(there)e(is)j(an)e(ef-)-138
5775 y(\002cient)d(w)o(ay)g(to)g(perform)d(b)n(ulk)j(reads)f(using)g
(the)h Fm(mem)g Fp(\002le)g(in)g(the)2018 1360 y Fm(/proc)f
Fp(directory)-5 b(.)33 b(But)24 b(writing)f(b)n(ulk)g(data)g(is)h(v)o
(ery)f(inef)n(\002cient,)2018 1460 y(as)j(it)h(requires)d(one)h
Fm(ptrace)g Fp(system)h(call)g(per)f(4)g(bytes)g(of)h(data)2018
1560 y(to)i(be)f(written.)45 b(Thus)27 b(the)g(o)o(v)o(erheads)e(for)i
(modifying)e(all)i(ar)o(gu-)2018 1659 y(ments)21 b(shoots)g(up)f
(dramatically)-5 b(.)25 b(This)c(problem)e(does)i(not)g(apply)2018
1759 y(to)c(IRIX)g(since)f(it)i(pro)o(vides)c(ef)n(\002cient)i(b)n(ulk)
g(read)g(and)g(write)h(opera-)2018 1858 y(tions.)25 b(Still,)c(the)f(o)
o(v)o(erhead)e(is)j(high)e(when)g(we)i(follo)n(w)e(all)i(pointer)2018
1958 y(ar)o(guments,)15 b(since)i(this)g(also)g(implies)g(that)g(all)g
(system)g(call)g(entries)2018 2058 y(and)k(e)o(xits)h(\(including)d
(those)i(for)g Fm(read)g Fp(and)g Fm(write)p Fp(\))g(are)h(being)2018
2157 y(intercepted.)2118 2260 y(W)-7 b(e)28 b(conclude)c(that)j(the)f
(o)o(v)o(erheads)e(are)j(lo)n(w)f(when)g(we)h(limit)2018
2360 y(ourselv)o(es)15 b(to)g(accesses)h(to)g(ar)o(guments)d(such)j(as)
g(\002le)g(names.)23 b(Intru-)2018 2460 y(sion)e(detection,)e(access)i
(control)e(and)h(con\002nement)f(applications)2018 2559
y(require)31 b(accesses)i(only)e(to)h(this)h(kind)e(of)h(data,)j(and)c
(hence)h(the)2018 2659 y(performance)26 b(de)o(gradation)h(introduced)g
(by)h(these)i(applications)2018 2759 y(is)21 b(lo)n(w)-5
b(.)25 b(Extensi)n(v)o(e)19 b(access)i(to)f(data)h(may)e(be)i(needed)d
(in)j(some)f(ap-)2018 2858 y(plications)27 b(such)g(as)g(those)g(for)g
(transparent)e(data)i(encryption)e(or)2018 2958 y(\002le)30
b(replication.)49 b(User)n(-le)n(v)o(el)28 b(interception)f(introduces)
g(signi\002-)2018 3057 y(cant)20 b(o)o(v)o(erheads)e(for)i(such)g
(applications.)2018 3300 y Fr(7)100 b(Discussion)2118
3526 y Fp(The)23 b(runtime)f(system)h(described)f(can)h(be)h(used)f
(for)f(real-time)2018 3626 y(monitoring)14 b(of)i(an)o(y)f
(application,)g(in)i(the)f(absence)f(of)h(source)f(code)2018
3725 y(and)21 b(without)f(the)h(need)f(for)g(changing)f(or)i(e)n(v)o
(en)f(recompiling)e(an)o(y)2018 3825 y(system)25 b(softw)o(are.)39
b(Since)24 b(our)g(monitoring)f(program)f(resides)j(in)2018
3925 y(a)35 b(separate)e(address)g(space,)k(it)e(is)g(essentially)e
(nonbypassable.)2018 4024 y(Ha)n(ving)25 b(a)g(user)g(le)n(v)o(el)f
(approach)f(pro)o(vides)g(us)i(the)g(ability)g(to)g(se-)2018
4124 y(lecti)n(v)o(ely)16 b(monitor)g(certain)g(system)h(calls,)h(or)f
(monitor)e(e)n(v)o(ery)g(call,)2018 4224 y(thus)25 b(controlling)e(the)
i(granularity)e(of)i(control.)38 b(These)24 b(features,)2018
4323 y(and)18 b(a)h(reasonable)e(performance)f(o)o(v)o(erhead)g(gi)n(v)
o(e)i(our)g(system)h(the)2018 4423 y(po)n(wer)h(to)h(add)f(and)g
(enforce)g(a)h(v)n(ariety)f(of)g(security)h(policies,)f(and)2018
4522 y(we)j(discuss)f(some)g(of)f(the)h(possible)g(applications)f(of)g
(our)g(system)2018 4622 y(belo)n(w:)2101 4798 y Fu(\017)41
b Fq(P)-7 b(olicy-based)26 b(A)n(uditing:)39 b Fp(In)28
b(its)h(simplest)f(form,)g(our)f(sys-)2184 4898 y(tem)18
b(can)g(record)e(information)g(about)h(system)h(calls)g(and)f(sig-)2184
4998 y(nals)k(in)f(a)h(log)f(\002le)h(that)g(can)f(be)g(used)g(for)g
(archi)n(v)n(al)f(purposes)2184 5097 y(or)34 b(as)h(a)g(source)f(of)g
(information)e(to)i(in)m(v)o(estigate)f(attacks.)2184
5197 y(The)17 b(information)d(to)j(be)f(recorded)f(can)i(include)e
(system)i(call)2184 5296 y(ar)o(guments)j(as)i(well)g(as)h(system)f
(state)g(related)f(information,)2184 5396 y(and)f(can)g(be)g
(customized)f(on)h(a)g(per)n(-process)f(basis.)2101 5576
y Fu(\017)41 b Fq(Intrusion)30 b(detection:)46 b Fp(As)32
b(described)d(earlier)m(,)k(a)f(majority)2184 5675 y(of)27
b(intrusion)e(detection)g(techniques)g(mak)o(e)h(use)h(of)f(system)2184
5775 y(call)d(information)e(to)h(perform)f(their)h(task.)33
b(System)23 b(call)g(in-)p eop
%%Page: 14 14
14 13 bop 28 533 a Fp(terception)24 b(can)h(enable)g(them)g(to)g
(obtain)f(additional)g(infor)n(-)28 633 y(mation)f(that)g(may)g(not)h
(be)f(a)n(v)n(ailable)g(from)g(audit)g(logs,)h(and)28
732 y(thereby)32 b(impro)o(v)o(e)g(their)h(ability)h(to)g(detect)f
(attacks.)66 b(The)28 832 y(ability)24 b(to)h(modify)e(or)h(abort)g
(system)g(calls)i(will)f(enable)f(in-)28 932 y(trusion)19
b(detectors)g(to)g(tak)o(e)h(a)g(more)e(proacti)n(v)o(e)g(role)h
(wherein)28 1031 y(the)o(y)h(can)g(pre)n(v)o(ent)e(attacks)i(from)f
(succeeding.)-55 1186 y Fu(\017)41 b Fq(Access)c(Contr)l(ol:)57
b Fp(Fine-grained)35 b(access)i(control)e(that)h(is)28
1286 y(based)31 b(on)h(users)f(as)i(well)f(as)g(applications)f(can)g
(be)h(easily)28 1385 y(implemented)25 b(using)i(our)f(infrastructure.)
44 b(Our)27 b(user)g(le)n(v)o(el)28 1485 y(approach)19
b(has)h(a)h(distinct)g(adv)n(antage)e(in)i(that)f(users)h(can)g(de-)28
1585 y(plo)o(y)i(\(or)g(e)o(xperiment)f(with\))h(ne)n(w)h(access)g
(control)e(policies)28 1684 y(without)e(an)o(y)f(help)h(from)f(system)h
(administrators.)-55 1839 y Fu(\017)41 b Fq(Con\002ning)d
(applications:)62 b Fp(Since)39 b(our)g(interception)f(and)28
1939 y(e)o(xtension)f(mechanisms)g(cannot)h(be)g(bypassed,)k(we)d(can)
28 2039 y(use)31 b(them)g(to)g(con\002ne)e(uncooperati)n(v)o(e)f
(applications.)56 b(T)-7 b(o-)28 2138 y(gether)35 b(with)g(this)h(f)o
(actor)m(,)i(the)e(mechanisms)e(we)i(pro)o(vide)28 2238
y(for)26 b(aborting)e(system)j(calls,)h(modifying)c(their)i(ar)o
(guments,)28 2338 y(and)20 b(\223locking\224)f(ar)o(gument)g(v)n(alues)
h(\(so)h(that)g(the)o(y)f(cannot)f(be)28 2437 y(changed)30
b(with)i(the)g(intention)f(of)g(e)o(xploiting)f(race)i(condi-)28
2537 y(tions\))23 b(gi)n(v)o(e)f(us)h(the)g(ability)f(to)h(con\002ne)f
(malicious)g(applica-)28 2636 y(tions)i(as)g(well.)35
b(Ho)n(we)n(v)o(er)m(,)23 b(this)h(ability)f(is)h(limited)g(to)f(some)
28 2736 y(e)o(xtent)32 b(due)h(to)g(the)g(lack)g(of)f(adequate)g
(operating)f(system)28 2836 y(support)e(in)i(some)g(UNIX)f(v)n(ariants)
g(such)h(as)g(Linux.)56 b(Our)28 2935 y(ability)38 b(to)g(dynamically)d
(change)i(the)h(supervisor)e(object)28 3035 y(\(and)18
b(hence)g(the)h(con\002nement)e(polic)o(y\))h(pro)o(vides)f(increased)
28 3135 y(\003e)o(xibility)j(in)g(con\002ning)e(malicious)i
(applications.)-55 3290 y Fu(\017)41 b Fq(Other)19 b(applications:)j
Fp(System)c(call)h(interposition)d(has)j(been)28 3389
y(used)g(for)f(other)h(applications)f(such)h(as)h(transparent)d
(encryp-)28 3489 y(tion,)27 b(data)e(replication,)g(etc.)42
b(While)26 b(our)f(system)h(can)f(also)28 3589 y(support)g(these)i
(applications,)g(the)g(performance)d(o)o(v)o(erhead)28
3688 y(is)39 b(higher)-5 b(.)76 b(More)37 b(ef)n(\002cient)g
(implementations,)j(such)e(as)28 3788 y(those)23 b(based)f(on)h(shared)
f(wrapper)g(libraries,)h(of)n(fer)e(a)j(better)28 3887
y(alternati)n(v)o(e.)-138 4084 y Fl(7.1)90 b(Drawbacks)-38
4281 y Fp(One)19 b(of)g(the)h(adv)n(antages)d(of)i(a)h(k)o(ernel-based)
e(approach)f(is)j(that)-138 4380 y(the)g(e)o(xtension)f(code)g(can)h
(perform)f(operations)f(in)i(the)h(conte)o(xt)e(of)-138
4480 y(the)25 b(monitored)e(program.)37 b(In)25 b(a)g(user)n(-le)n(v)o
(el)f(approach,)g(we)h(ha)n(v)o(e)-138 4579 y(to)19 b(perform)d(these)j
(operations)e(in)h(the)h(conte)o(xt)e(of)h(the)h(monitoring)-138
4679 y(process,)i(which)f(is)i(distinct)f(from)g(the)g(monitoring)d
(process.)28 b(F)o(or)-138 4779 y(instance,)20 b(operations)f(such)i
(as)g(changing)e(the)h(userid)g(or)h(\002le)g(sys-)-138
4878 y(tem)k(root)g(of)g(the)g(monitored)e(process)i(is)h(not)f
(possible)g(with)g(our)-138 4978 y(approach.)g(Ne)n(v)o(ertheless,)20
b(it)h(is)h(possible)f(to)g(constrain)f(the)g(mon-)-138
5078 y(itored)i(process)g(to)g(only)g(\002les)h(accessible)g(to)f(ne)n
(w)g(userid)g(or)h(ne)n(w)-138 5177 y(\002le)e(system)f(root.)-38
5277 y(In)h(a)g(user)n(-le)n(v)o(el)f(implementation)f(such)i(as)h
(ours,)f(the)g(OS)h(k)o(er)n(-)-138 5376 y(nel)c(treats)f(the)h
(monitoring)d(and)i(monitored)f(processes)h(the)g(same,)-138
5476 y(and)j(it)i(is)f(really)g(up)f(to)h(the)g(monitoring)d(process)j
(to)f(defend)g(itself)-138 5576 y(against)28 b(a)h(malicious)f
(monitored)f(process.)50 b(There)28 b(are)g(a)h(num-)-138
5675 y(ber)20 b(of)h(w)o(ays)g(in)g(which)g(the)g(monitored)d(process)j
(can)f(try)h(to)g(crip-)-138 5775 y(ple)26 b(a)h(monitored)d(program.)
42 b(Not)26 b(all)h(of)f(these)g(may)g(ha)n(v)o(e)g(been)2018
533 y(thought)c(through)g(completely)g(by)h(an)g(implementor)f(of)h
(the)h(run-)2018 633 y(time)18 b(system.)24 b(An)o(y)17
b(\223holes)g(in)h(the)f(armor\224)g(resulting)f(due)h(to)h(such)2018
732 y(o)o(v)o(ersight)28 b(can)i(be)g(e)o(xploited)f(by)g(a)i
(malicious)e(program)f(to)i(es-)2018 832 y(cape.)38 b(K)n(ernel-based)
23 b(implementations)g(are)i(harder)e(to)i(circum-)2018
932 y(v)o(ent.)i(The)21 b(do)n(wnside,)f(ho)n(we)n(v)o(er)m(,)f(is)j
(that)f(errors)f(in)i(k)o(ernel-based)2018 1031 y(implementations)e
(can)h(cause)h(signi\002cantly)f(more)g(damage)f(than)2018
1131 y(errors)g(in)g(the)g(e)o(xtension)f(code)g(e)o(x)o(ecuting)f(at)j
(the)f(user)g(le)n(v)o(el.)2118 1232 y(Our)g(implementation)f(adds)i
(moderate)e(o)o(v)o(erheads)f(for)j(moni-)2018 1331 y(toring,)16
b(and)g(this)h(o)o(v)o(erhead)c(is)18 b(higher)d(than)h(that)g(for)g(k)
o(ernel-based)2018 1431 y(implementations.)23 b(The)c(silv)o(er)g
(lining)f(is)i(that)f(most)g(of)g(the)g(appli-)2018 1531
y(cations)g(where)f(the)h(user)f(is)i(sensiti)n(v)o(e)e(to)h
(performance)d(are)j(CPU-)2018 1630 y(intensi)n(v)o(e,)g(and)h(for)g
(such)g(programs,)e(the)i(o)o(v)o(erhead)d(of)j(our)g(inter)n(-)2018
1730 y(ception)f(mechanisms)h(are)g(not)g(e)n(v)o(en)f(noticeable.)2118
1831 y(Our)32 b(approach)f(is)i(implemented)e(on)h(top)g(of)h(the)f
(interf)o(aces)2018 1930 y(pro)o(vided)21 b(by)j(the)g(operating)e
(system)h(features)h(intended)e(for)h(de-)2018 2030 y(b)n(ugging.)38
b(Limitations)25 b(in)g(these)g(mechanisms)g(directly)f(impact)2018
2130 y(our)j(infrastructure.)47 b(F)o(or)27 b(instance,)i(in)g(the)f
(current)e(implemen-)2018 2229 y(tation)e(of)h(the)f
Fm(ptrace)g Fp(mechanism)f(in)i(Linux,)f(there)g(is)i(a)f(race)2018
2329 y(condition)17 b(re)o(garding)f(the)j Fm(fork)f
Fp(system)h(call.)25 b(In)18 b(particular)m(,)g(the)2018
2428 y(child)k(process)h(does)f(not)g(inherit)g(the)h(tracing)f
(\003ag,)h(so)g(it)g(can)f(run)2018 2528 y(free)g(until)g(the)g
(monitoring)e(process)i(attaches)g(to)g(it.)32 b(During)21
b(this)2018 2628 y(windo)n(w)26 b(of)g(time,)i(we)f(do)f(not)g(ha)n(v)o
(e)g(an)o(y)f(ability)h(to)h(monitor)e(or)2018 2727 y(con\002ne)19
b(the)h(child)f(process.)24 b(Ho)n(we)n(v)o(er)m(,)18
b(it)j(appears)e(that)g(this)i(race)2018 2827 y(condition)f(only)h
(arises)h(in)g(multiprocessor)d(architectures.)28 b(\(This)2018
2927 y(problem)14 b(does)h(not)h(arise)f(in)h(SVR4)g(compatible)e
(systems,)j(as)f(the)o(y)2018 3026 y(pro)o(vide)j(mechanisms)g(that)i
(enable)f(the)h(monitoring)d(program)g(to)2018 3126 y(arrange)30
b(for)h(the)h(tracing)e(\003ags)i(to)g(be)f(inherited)f(after)h(a)h
(fork.\))2018 3226 y(It)d(appears)f(possible)g(to)h(de)n(v)o(elop)d(a)j
(w)o(ork)f(around)f(by)h(dynamic)2018 3325 y(modi\002cation)h(of)i
(code)f(in)h(the)f(te)o(xt)h(se)o(gment,)h(or)e(better)m(,)j(mod-)2018
3425 y(ifying)e(the)g(instruction)g(pointer)f(to)i(point)f(back)g(to)h
(a)g(specially)2018 3524 y(constructed)20 b(sequence)h(of)g
(instructions)g(on)g(the)h(stack.)30 b(The)21 b(best)2018
3624 y(solution,)30 b(ho)n(we)n(v)o(er)m(,)e(is)i(to)f(eliminate)f
(this)i(\223b)n(ug\224)d(from)h(the)h(OS)2018 3724 y(implementation)18
b(itself.)2118 3825 y(One)f(of)g(the)g(assumptions)f(of)h(our)g
(approach)e(is)j(that)f(the)h(polic)o(y)2018 3924 y(incorporated)13
b(in)i(the)g(supervisor)f(code)g(is)j(a)e(\223good\224)f(one,)h(and)g
(will)2018 4024 y(not)i(itself)h(cause)f(damage)f(or)h(otherwise)g
(modify)f(the)h(capabilities)2018 4123 y(of)25 b(the)h(monitored)d
(process)i(in)h(undesirable)e(w)o(ays.)41 b(The)25 b(upside)2018
4223 y(is)c(that)f(the)g(scope)f(of)h(damage)e(that)i(can)g(arise)g
(due)f(to)h(such)f(errors)2018 4323 y(is)27 b(minimized)e(by)h(using)g
(appropriate)e(high-le)n(v)o(el)g(language)g(for)2018
4422 y(specifying)f(the)h(supervisor)f(functionality)-5
b(,)23 b(and)g(also)i(by)f(ha)n(ving)2018 4522 y(the)c(supervisors)f
(run)h(at)g(user)n(-le)n(v)o(el.)2018 4758 y Fr(8)100
b(Related)25 b(W)-7 b(ork)2118 4978 y Fp(There)37 b(has)i(been)e(a)i
(lot)f(of)g(research)f(done)h(on)f(impro)o(ving)2018
5078 y(the)23 b(access)g(control)e(techniques)g(a)n(v)n(ailable)g(in)i
(operating)d(system)2018 5177 y(such)26 b(as)g(UNIX.)f(Man)o(y)g(of)g
(the)h(w)o(orks)f(focussed)g(on)g(impro)o(ving)2018 5277
y(the)h(\002lesystem)g(protection)d(model)i(in)h(UNIX)f([8,)h(19)o(,)f
(2].)41 b(Their)2018 5376 y(implementation)17 b(approach)f(is)j(based)f
(on)g(modifying)e(the)j(operat-)2018 5476 y(ing)i(system)g(k)o(ernel)f
(to)h(pro)o(vide)e(an)i(enhanced)e(protection)g(model)2018
5576 y(that)31 b(can)g(operate)f(at)h(a)g(per)n(-process)e(and)i(per)n
(-user)e(le)n(v)o(el.)57 b(The)2018 5675 y(w)o(ork)23
b(of)g([28)o(])g(de)n(v)o(elops)f(a)i(more)e(po)n(werful)g(and)g(\003e)
o(xible)h(access)2018 5775 y(control)16 b(method)f(called)i(domain)f
(type)g(enforcement)e(\(DTE\).)i(Us-)p eop
%%Page: 15 15
15 14 bop -138 533 a Fp(ing)36 b(DTE,)f(system)h(administrators)f(can)g
(specify)h(\002ne-grained)-138 633 y(mandatory)14 b(access)j(controls)e
(o)o(v)o(er)g(the)h(interaction)f(between)g(pro-)-138
732 y(cesses)20 b(and)e(the)h(objects)g(accessed)g(by)g(them.)24
b(This)19 b(w)o(ork)f(is)i(more)-138 832 y(closely)h(related)f(to)h
(ours)g(in)g(that)g(their)f(implementation)f(is)j(based)-138
932 y(on)32 b(intercepting)f(and)i(checking)e(system)i(calls)g(within)g
(the)g(OS)-138 1031 y(k)o(ernel.)-38 1146 y(Se)n(v)o(eral)47
b(research)g(ef)n(forts)h(ha)n(v)o(e)f(de)n(v)o(eloped)f(interception)
-138 1246 y(techniques)16 b(that)i(are)f(implemented)f(in)i(libraries)f
([16)o(,)h(15)o(].)24 b(While)-138 1345 y(this)19 b(approach)e(leads)h
(to)h(lo)n(w)g(o)o(v)o(erheads,)d(the)o(y)i(can)h(be)f(easily)h(by-)
-138 1445 y(passed)f(by)g(code)g(that)h(directly)e(in)m(v)n(ok)o(es)h
(the)g(system)h(call)g(without)-138 1545 y(using)k(the)g(library)-5
b(,)22 b(and)h(are)g(thus)g(not)g(appropriate)e(for)i(intrusion)-138
1644 y(detection)c(and)h(con\002nement)e(applications.)-38
1759 y(Interception)27 b(of)i(system)g(calls)i(within)e(the)g(k)o
(ernel,)i(coupled)-138 1859 y(with)39 b(the)f(ability)g(to)h(add)f(e)o
(xtension)f(code)h(that)h(can)f(be)g(e)o(x)o(e-)-138
1958 y(cuted)16 b(at)i(this)f(point,)g(has)g(been)f(proposed)f(by)h(se)
n(v)o(eral)g(researchers)-138 2058 y([9)o(,)h(11)o(,)g(20)o(].)24
b(The)16 b(approaches)f(in)i([9)o(,)g(20)o(])g(use)g(similar)g
(techniques)-138 2158 y(for)22 b(system)h(call)g(interception:)28
b(the)o(y)22 b(o)o(v)o(erwrite)f(the)h(system)h(call)-138
2257 y(table)f(in)f(the)h(k)o(ernel)f(\(Linux)f(or)h(FreeBSD\))h(to)g
(point)f(to)g(modules)-138 2357 y(that)g(will)g(route)f(the)g(system)h
(calls)g(through)d(the)j(e)o(xtensions)e(prior)-138 2457
y(to)28 b(and)e(after)h(the)h(e)o(x)o(ecution)d(of)i(normal)f(system)i
(call)f(function-)-138 2556 y(ality)-5 b(.)35 b(Being)23
b(k)o(ernel-based,)f(these)h(approaches)f(generally)g(ha)n(v)o(e)-138
2656 y(more)h(\003e)o(xibility)g(and)g(po)n(wer)g(in)h(terms)f(of)h
(what)f(actions)h(can)f(be)-138 2756 y(performed)18 b(within)h(the)i(e)
o(xtension)d(code.)-38 2870 y(A)25 b(more)f(comprehensi)n(v)o(e)d(set)
26 b(of)e(capabilities)h(for)f(e)o(xtending)-138 2970
y(operating)d(system)i(functionality)e(w)o(as)j(proposed)c(in)j([11)o
(].)33 b(The)o(y)-138 3070 y(allo)n(w)d(for)f(e)o(xtensions)g(to)h
(operate)f(in)h(user)f(mode)g(as)i(well,)h(b)n(ut)-138
3169 y(the)o(y)22 b(run)h(on)g(top)g(of)f(the)i(k)o(ernel)e(le)n(v)o
(el)h(primiti)n(v)o(es)f(de)n(v)o(eloped)f(by)-138 3269
y(them,)d(as)h(opposed)e(to)i(making)e(use)i(of)f(the)g(features)g(of)h
(commod-)-138 3369 y(ity)k(operating)f(systems.)34 b(Their)22
b(w)o(ork)h(also)g(deals)g(with)h(some)f(is-)-138 3468
y(sues)h(not)f(addressed)g(by)g(the)g(w)o(orks)g(mentioned)f(abo)o(v)o
(e,)g(such)i(as)-138 3568 y(handling)c(race)i(conditions)e(that)i
(might)f(arise)h(when)g(a)g(malicious)-138 3667 y(multithreaded)i
(program)f(attempts)j(to)g(change)f(an)h(ar)o(gument)e(of)-138
3767 y(a)32 b(system)g(call)g(\(such)f(as)i(a)f(\002lename\))f(between)
f(the)i(time)g(it)g(is)-138 3867 y(check)o(ed)27 b(by)g(the)h(e)o
(xtension)f(code)g(and)h(the)g(time)g(the)g(ar)o(gument)-138
3966 y(is)33 b(actually)e(used)g(in)h(a)g(system)g(call.)59
b(Although)30 b(it)i(is)h(dif)n(\002cult)-138 4066 y(to)h(pro)o(vide)e
(absolute)h(protection)f(against)h(such)h(attacks)g(using)-138
4166 y(our)24 b(approach,)f(our)h(technique)f(of)h(cop)o(ying)f(such)i
(ar)o(guments)d(to)-138 4265 y(a)28 b(random)d(location)h(on)h(the)g
(stack)h(\(be)o(yond)c(the)k(stack)f(pointer\))-138 4365
y(pro)o(vides)22 b(a)i(good)e(solution.)33 b(It)24 b(w)o(ould)f(be)g(v)
o(ery)g(dif)n(\002cult)f(for)h(the)-138 4465 y(malicious)29
b(thread)g(to)h(search)g(the)g(entire)f(stack)h(\(usually)f(a)h(fe)n(w)
-138 4564 y(MB)21 b(in)f(size\))h(to)f(identify)f(the)h(location\(s\))f
(into)h(which)f(the)h(moni-)-138 4664 y(toring)f(program)f(may)i(ha)n
(v)o(e)f(copied)h(the)g(ar)o(guments.)-38 4779 y(The)d(k)o(e)o(y)g
(distinction)g(between)g(our)g(approach)f(and)h(that)h(of)f(the)-138
4878 y(abo)o(v)o(e)30 b(w)o(orks)i(is)h(that)f(we)h(aim)f(for)g(a)g
(user)n(-le)n(v)o(el)f(implementa-)-138 4978 y(tion)19
b(of)g(the)g(system)h(call)f(interception)f(infrastructure,)f(similar)i
(to)-138 5078 y([13)o(].)24 b(Their)18 b(system)h(is)g(aimed)f(at)h
(con\002ning)e(helper)h(applications)-138 5177 y(\(such)27
b(as)h(those)f(launched)f(by)g(web-bro)n(wsers\))g(to)h(restrict)h
(their)-138 5277 y(use)21 b(of)f(system)g(calls.)26 b(Due)20
b(to)h(their)f(focus)g(on)g(\223sand-boxing\224)d(of)-138
5376 y(helper)26 b(applications,)i(their)f(system)g(pro)o(vides)f
(abilities)i(to)f(only)-138 5476 y(allo)n(w)h(or)f(den)o(y)f(a)i
(particular)e(system)i(call.)48 b(Modifying)25 b(system)-138
5576 y(call)h(ar)o(guments)e(or)i(the)f(data)h(referenced)e(by)h(them,)
i(or)e(changes)-138 5675 y(to)g(the)g(system)g(call)g(return)e(code)h
(were)h(not)f(considered.)37 b(More-)-138 5775 y(o)o(v)o(er)m(,)26
b(their)g(w)o(ork)g(w)o(as)i(based)e(on)g(Solaris)g(and)g(did)h(not)f
(address)2018 533 y(Linux)h(\(which)f(is)j(our)e(main)g(interest\))g
(or)g(issues)i(of)e(portability)2018 633 y(across)20
b(other)g(UNIX)g(v)n(ariants.)2118 733 y(Se)n(v)o(eral)j(languages)g
(ha)n(v)o(e)h(been)f(proposed)g(to)h(simplify)g(writ-)2018
833 y(ing)15 b(system)h(call)f(e)o(xtensions)f([9,)h(13)o(,)h(26)o(,)f
(25)o(].)24 b(Some)15 b(approaches,)2018 933 y(such)24
b(as)g([13)o(])f(use)h(a)g(v)o(ery)f(simple,)h(high-le)n(v)o(el)d
(language.)34 b(Other)2018 1032 y(approaches)19 b(such)i(as)h([9)o(])f
(are)g(geared)f(to)h(maximize)f(the)h(capabil-)2018 1132
y(ities)26 b(that)f(can)f(be)h(programmed)d(into)i(the)h(e)o
(xtensions,)f(and)h(thus)2018 1232 y(the)o(y)15 b(use)h(a)h(superset)e
(of)h(the)f(C-language)g(for)g(writing)g(e)o(xtensions.)2018
1331 y(Y)-8 b(et)25 b(other)f(approaches)e([26)o(,)j(25)o(])g(stri)n(v)
o(e)f(for)g(a)h(balance)e(between)2018 1431 y(e)o(xpressi)n(v)o(e)15
b(po)n(wer)m(,)h(rob)n(ustness)h(of)f(e)o(xtensions)g(and)g(ease)h(of)g
(writ-)2018 1530 y(ing)26 b(e)o(xtensions)e(geared)h(for)g(a)h
(speci\002c)g(purpose)e(such)h(as)i(intru-)2018 1630
y(sion)20 b(detection/pre)n(v)o(ention.)2018 1866 y Fr(9)100
b(Conclusions)2118 2085 y Fp(In)23 b(this)i(paper)d(we)j(presented)d(a)
i(ne)n(w)g(approach)e(for)h(de)n(v)o(elop-)2018 2185
y(ing)30 b(a)g(user)n(-le)n(v)o(el)f(infrastructure)e(for)i(system)h
(call)g(interception)2018 2285 y(and)18 b(e)o(xtension.)23
b(Our)c(w)o(ork)f(addresses)g(se)n(v)o(eral)g(important)g(issues)2018
2384 y(not)25 b(addressed)f(by)h(pre)n(vious)e(research.)39
b(Ev)o(en)24 b(though)g(we)h(ha)n(v)o(e)2018 2484 y(a)g(user)n(-le)n(v)
o(el)d(implementation,)h(it)h(of)n(fers)g(similar)g(le)n(v)o(el)f(of)h
(secu-)2018 2583 y(rity)16 b(and)g(comparable)e(le)n(v)o(el)h(of)h
(capabilities)g(as)h(k)o(ernel-based)d(im-)2018 2683
y(plementations)26 b(of)i(system)g(call)g(e)o(xtensions.)47
b(This)28 b(is)g(achie)n(v)o(ed)2018 2783 y(without)c(the)g(main)g(dra)
o(wbacks)f(of)h(the)h(k)o(ernel-based)d(approach,)2018
2882 y(namely)-5 b(,)19 b(normal)f(users)j(can)f(de)n(v)o(elop)e(and)h
(deplo)o(y)g(their)h(o)n(wn)f(e)o(x-)2018 2982 y(tensions;)30
b(moreo)o(v)o(er)m(,)24 b(damage)i(due)g(to)g(errors)g(in)h(the)f(e)o
(xtension)2018 3082 y(code)33 b(is)h(limited,)i(and)c(does)h(not)g
(bring)f(do)n(wn)g(the)h(entire)g(sys-)2018 3181 y(tem.)48
b(As)28 b(a)g(result)g(of)f(this,)j(our)d(infrastructure)e(can)i(be)h
(used)f(to)2018 3281 y(de)n(v)o(elop)k(e)o(xtensions)g(that)i
(accomplish)e(a)j(v)n(ariety)d(of)i(security-)2018 3380
y(related)j(tasks)g(such)g(as)h(custom)e(auditing)g(and)h(logging,)i
(\002ne-)2018 3480 y(grained)15 b(access)i(control,)e(intrusion)g
(detection)g(and)h(con\002nement.)2118 3581 y(Another)24
b(important)h(distinction)g(of)g(the)h(research)f(presented)2018
3681 y(in)e(this)g(paper)f(is)i(that)e(we)i(ha)n(v)o(e)e(de)n(v)o
(eloped)e(techniques)h(to)i(mak)o(e)2018 3780 y(our)h(infrastructure)e
(portable)h(across)i(man)o(y)e(v)o(ersions)h(of)g(UNIX.)2018
3880 y(More)31 b(importantly)-5 b(,)31 b(the)h(e)o(xtension)e(code)g
(itself)i(can)f(be)g(easily)2018 3979 y(ported.)68 b(Man)o(y)34
b(of)h(these)g(techniques)e(can)i(be)g(applied)f(to)h(in-)2018
4079 y(k)o(ernel)17 b(implementations)f(of)i(e)o(xtension)e
(infrastructures)g(as)i(well.)2118 4180 y(W)-7 b(e)35
b(presented)d(a)i(comprehensi)n(v)o(e)d(analysis)i(of)h(the)f(perfor)n
(-)2018 4279 y(mance)18 b(impact)f(due)h(to)g(user)n(-le)n(v)o(el)f
(interception)g(of)h(system)g(calls.)2018 4379 y(The)26
b(o)o(v)o(erheads)e(are)i(moderate)e(in)i(the)g(w)o(orst)g(case,)i(and)
e(almost)2018 4479 y(imperceptible)38 b(under)g(typical)h(conditions.)
82 b(From)39 b(a)h(perfor)n(-)2018 4578 y(mance)28 b(point)f(of)h(vie)n
(w)-5 b(,)30 b(we)f(belie)n(v)o(e)e(that)h(our)g(results)g(establish)
2018 4678 y(the)19 b(practicality)f(of)h(user)n(-le)n(v)o(el)f
(monitoring)e(of)j(system)g(calls)h(as)f(a)2018 4778
y(w)o(ay)h(to)h(impro)o(v)o(e)d(system)i(security)-5
b(.)2118 4878 y(Our)29 b(performance)d(analysis,)31 b(as)e(well)h(as)g
(the)f(discussion)f(in)2018 4978 y(Section)16 b(7,)g(indicate)g(that)g
(the)g(approach)e(is)j(well-suited)e(for)g(appli-)2018
5078 y(cations)22 b(such)f(as)h(intrusion)e(detection,)h(access)h
(control)e(and)h(con-)2018 5177 y(\002nement)k(of)h(applications.)41
b(Moreo)o(v)o(er)m(,)24 b(due)i(to)g(the)g(limitations)2018
5277 y(in)k(OS-pro)o(vided)d(mechanisms)i(for)g(user)n(-le)n(v)o(el)f
(interception)g(of)2018 5376 y(system)19 b(calls,)h(these)e(techniques)
g(are)g(currently)f(better)i(suited)f(for)2018 5476 y(con\002ning)28
b(uncooperati)n(v)o(e)d(applications)j(than)h(malicious)f(ones.)2018
5576 y(It)18 b(is)g(also)g(less)g(suited)g(for)e(applications)h(such)g
(as)h(transparent)e(data)2018 5675 y(encryption)g(or)j(\002le)g
(replication)e(that)i(require)e(e)o(xtensi)n(v)o(e)g(accesses)2018
5775 y(to)k(the)f(memory)e(of)i(the)g(monitored)e(process.)p
eop
%%Page: 16 16
16 15 bop -138 533 a Fr(Refer)n(ences)-87 736 y Fk([1])42
b(D.)i(Anderson,)52 b(T)-6 b(.)44 b(Lunt,)51 b(H.)44
b(Ja)o(vitz,)51 b(A.)44 b(T)-6 b(amaru,)51 b(and)45 b(A.)42
827 y(V)-8 b(aldes,)22 b(Ne)o(xt-generation)g(Intrusion)g(Detection)g
(Expert)g(System)42 919 y(\(NIDES\):)h(A)i(Summary)-5
b(,)27 b(SRI-CSL-95-07,)e(SRI)f(International,)42 1010
y(1995.)-87 1163 y([2])42 b(A.)28 b(Berman,)j(V)-10 b(.)28
b(Bourassa)i(and)f(E.)f(Selber)o(g,)i(TR)m(ON:)e(Process-)42
1255 y(speci\002c)41 b(\002le)g(protection)h(for)g(the)f(UNIX)g
(operating)i(system,)42 1346 y(USENIX)17 b(W)m(inter)i(T)-5
b(echnical)19 b(Conference,)g(1995.)-87 1499 y([3])42
b(M.)15 b(Bishop,)h(M.)g(Dilger)f(,)g(Checking)i(for)e(Race)h
(Conditions)g(in)f(File)42 1591 y(Access.)k(Computing)h(Systems)f
(9\(2\),)f(1996,)i(pp.)f(131-152.)-87 1744 y([4])42 b(T)-6
b(.)21 b(Bo)n(wen)i(et)e(al,)h(Operating)g(System)g(Support)g(for)g
(Application-)42 1835 y(Speci\002c)c(Security)-5 b(,)19
b(Personal)g(communication,)h(1999.)-87 1988 y([5])42
b(W)-7 b(.R.)14 b(Cheswick,)i(An)g(e)n(v)o(ening)h(with)e(berferd,)i
(in)e(which)h(a)g(crack)o(er)42 2080 y(is)k(lured,)h(endured)h(and)f
(studied,)g(W)m(inter)f(USENIX)f(Conference,)42 2171
y(1992.)-87 2324 y([6])42 b(Fred)27 b(Cohen)h(and)g(Associates,)h(The)e
(Deception)h(T)-6 b(oolkit)27 b(Home)42 2416 y(P)o(age,)18
b Fe(http://www.all.net/dtk/dtk.html)p Fk(.)-87 2569
y([7])42 b(D.)23 b(Engler)m(,)j(M.)e(Kaashoek)h(and)g(Jr)f(J.)g(O'T)-6
b(oole,)25 b(Exok)o(ernel:)34 b(An)42 2660 y(Operating)e(System)f
(Architecture)h(for)g(Application-Le)n(v)o(el)g(Re-)42
2752 y(source)26 b(Management,)j(15th)e(A)m(CM)e(Symposium)i(on)f
(Operating)42 2843 y(Systems)19 b(Principles,)f(December)i(1995.)-87
2996 y([8])42 b(G.)19 b(Fernandez)j(and)e(L.)g(Allen,)g(Extending)h
(the)f(UNIX)g(protection)42 3088 y(model)25 b(with)f(access)g(control)h
(lists,)g(USENIX)e(Summer)h(Confer)o(-)42 3179 y(ence,)19
b(1988.)-87 3332 y([9])42 b(T)-6 b(.)27 b(Fraser)m(,)i(L.)e(Badger)m(,)
j(M.)e(Feldman)g(Hardening,)i(CO)m(TS)d(soft-)42 3424
y(w)o(are)d(with)f(Generic)h(Softw)o(are)g(Wrappers,)g(Symposium)h(on)f
(Se-)42 3515 y(curity)19 b(and)g(Pri)n(v)n(ac)o(y)-5
b(,)19 b(1999.)-124 3668 y([10])42 b(S.)33 b(F)o(orrest,)38
b(S.)33 b(Hofme)o(yr)i(and)h(A.)d(Somayaji,)39 b(Computer)c(Im-)42
3759 y(munology)-5 b(,)20 b(Comm.)f(of)g(A)m(CM)g(40\(10\),)h(1997.)
-124 3913 y([11])42 b(D.)30 b(Ghormle)o(y)-5 b(,)34 b(D.)c(Petrou,)j
(S.)d(Rodrigues,)k(and)d(T)-6 b(.)31 b(Anderson,)42 4004
y(SLIC:)c(An)h(Extensibility)h(System)f(for)h(Commodity)g(Operating)42
4095 y(Systems,)18 b(USENIX)g(Annual)i(T)-5 b(echnical)19
b(Conference,)g(1998.)-124 4249 y([12])42 b(A.K.)16 b(Ghosh,)i(A.)f
(Schw)o(artzbard)i(and)f(M.)f(Schatz,)g(Learning)h(Pro-)42
4340 y(gram)e(Beha)o(vior)f(Pro\002les)g(for)g(Intrusion)h(Detection,)g
(1st)g(USENIX)42 4431 y(W)-6 b(orkshop)21 b(on)g(Intrusion)g(Detection)
g(and)g(Netw)o(ork)g(Monitoring,)42 4523 y(1999.)-124
4676 y([13])42 b(I.)35 b(Goldber)o(g,)41 b(D.)35 b(W)-6
b(agner)m(,)40 b(R.)c(Thomas,)k(and)d(E.)e(Bre)n(wer)m(,)40
b(A)42 4767 y(Secure)j(En)m(vironment)g(for)g(Untrusted)g(Helper)g
(Applications,)42 4859 y(USENIX)17 b(Security)i(Symposium,)h(1996.)-124
5012 y([14])42 b(K.)15 b(Ilgun,)i(R.)f(K)n(emmerer)m(,)g(and)h(P)-8
b(.)15 b(Porras,)h(State)f(T)m(ransition)i(Anal-)42 5103
y(ysis:)50 b(A)32 b(Rule-Based)h(Intrusion)g(Detection)f(Approach,)37
b(IEEE)42 5194 y(T)m(ransactions)20 b(on)f(Softw)o(are)g(Engineering,)g
(March)h(1995.)-124 5348 y([15])42 b(M.)27 b(Jones,)k(Interposition)d
(Agents:)41 b(T)m(ransparently)28 b(Interposing)42 5439
y(User)23 b(Code)g(at)g(the)g(System)g(Interf)o(ace,)i(14th)f(A)m(CM)f
(Symposium)42 5530 y(on)c(Operating)h(Systems)f(Principles,)f(December)
h(1993)-124 5684 y([16])42 b(E.)27 b(Krell)f(and)j(B.)e(Krishnamurthy)
-5 b(,)30 b(COLA:)c(Customized)j(o)o(v)o(er)o(-)42 5775
y(laying,)19 b(USENIX)f(W)m(inter)g(Conference,)i(January)g(1992.)2032
533 y([17])42 b(C.K)m(o,)26 b(M.)g(Ruschitzka)g(and)f(K.)g(Le)n(vitt,)h
(Ex)o(ecution)g(Monitoring)2198 624 y(of)35 b(Security-Critical)e
(Programs)i(in)f(Distrib)o(uted)g(Systems:)54 b(A)2198
716 y(Speci\002cation-Based)23 b(Approach,)i(IEEE)d(Symposium)i(on)f
(Secu-)2198 807 y(rity)c(and)g(Pri)n(v)n(ac)o(y)-5 b(,)19
b(1997.)2032 965 y([18])42 b(S.)26 b(K)o(umar)h(and)g(E.)f(Spaf)n
(ford,)j(A)d(P)o(attern-Matching)h(Model)h(for)2198 1056
y(Intrusion)i(Detection,)h(Nat')o(l)e(Computer)g(Security)g
(Conference,)2198 1147 y(1994.)2032 1305 y([19])42 b(N.)19
b(Lai)g(and)h(T)-6 b(.)19 b(Gray)-5 b(,)19 b(Strengthening)i
(discretionary)f(access)g(con-)2198 1396 y(trols)15 b(to)g(inhibit)g(T)
m(rojan)h(horses)g(and)g(computer)g(viruses,)g(USENIX)2198
1488 y(Summer)j(Conference,)h(1988.)2032 1646 y([20])42
b(T)-6 b(.)24 b(Mitchem,)h(R.)f(Lu,)g(R.)g(O'Brien,)g(Using)h(K)n
(ernel)f(Hypervisors)2198 1737 y(to)16 b(Secure)h(Applications,)g
(Annual)g(Computer)g(Security)g(Applica-)2198 1828 y(tion)i
(Conference,)h(December)f(1997.)2032 1986 y([21])42 b(T)-6
b(.)22 b(Lunt)g(et)g(al,)h(A)f(Real-T)m(ime)g(Intrusion)g(Detection)h
(Expert)f(Sys-)2198 2077 y(tem)30 b(\(IDES\))e(-)h(Final)g(Report,)k
(SRI-CSL-92-05,)e(SRI)e(Interna-)2198 2169 y(tional,)19
b(1992.)2032 2326 y([22])42 b(P)-8 b(.)33 b(Porras)h(and)h(R.)e(K)n
(emmerer)m(,)39 b(Penetration)34 b(State)f(T)m(ransition)2198
2418 y(Analysis:)67 b(A)40 b(Rule)g(based)i(Intrusion)f(Detection)g
(Approach,)2198 2509 y(Eighth)16 b(Annual)g(Computer)g(Security)g
(Applications)g(Conference,)2198 2600 y(1992.)2032 2758
y([23])42 b(M.)19 b(Russino)o(vich)i(and)f(Z.)e(Se)o(gall,)h(F)o
(ault-T)-6 b(olerance)19 b(for)g(Of)n(f-The-)2198 2849
y(Shelf)25 b(Applications)h(and)g(Hardw)o(are,)h(Proceedings)f(of)g
(the)f(25th)2198 2941 y(International)16 b(symposium)g(on)g(F)o(ault-T)
-6 b(olerant)15 b(computing,)i(1995)2032 3098 y([24])42
b(R.)28 b(Sekar)m(,)i(Y)-10 b(.)29 b(Guang,)i(T)-6 b(.)28
b(Shanbhag)i(and)g(S.)d(V)-8 b(erma,)30 b(A)f(High-)2198
3190 y(Performance)36 b(Netw)o(ork)g(Intrusion)g(Detection)g(System,)j
(A)m(CM)2198 3281 y(Computer)20 b(and)f(Communication)h(Security)f
(Conference,)h(1999.)2032 3439 y([25])42 b(R.)28 b(Sekar)g(and)h(P)-8
b(.Uppuluri,)29 b(Synthesizing)g(F)o(ast)f(Intrusion)h(Pre-)2198
3530 y(v)o(ention/Detection)22 b(Systems)e(from)g(High-Le)n(v)o(el)h
(Speci\002cations,)2198 3621 y(T)-6 b(o)19 b(appear)h(in)e(USENIX)g
(Security)h(Symposium,)g(1999.)2032 3779 y([26])42 b(R.)19
b(Sekar)m(,)h(T)-6 b(.)20 b(Bo)n(wen)h(and)f(M.)g(Se)o(gal,)f(On)i(Pre)
n(v)o(enting)f(Intrusions)2198 3871 y(by)f(Process)g(Beha)o(vior)g
(Monitoring,)h(USENIX)d(Intrusion)j(Detec-)2198 3962
y(tion)f(W)-6 b(orkshop,)20 b(1999.)2032 4120 y([27])42
b(R.)21 b(W)-6 b(ahbe,)23 b(S.)e(Lucco,)i(T)-6 b(.)22
b(Anderson)h(and)g(S.)e(Graham,)i(Ef)n(\002cient)2198
4211 y(Softw)o(are-Based)i(F)o(ault)f(Isolation,)i(14th)f(A)m(CM)g
(Symposium)g(on)2198 4302 y(Operating)20 b(Systems)e(Principles,)h
(December)g(1993.)2032 4468 y([28])42 b(Con\002ning)26
b(Root)g(Programs)f(with)g(Domain)h(T)-6 b(ype)26 b(Enforcement)2198
4568 y(\(DTE\),)15 b(K.)g(W)-6 b(alk)o(er)m(,)16 b(D.)f(Sterne,)h(L.)f
(Badger)m(,)i(M.)f(Petkac,)g(D.)g(Sher)o(-)2198 4668
y(mann)25 b(and)f(K.)f(Ostendorp,)j(USENIX)c(UNIX)i(Security)f(Sympo-)
2198 4767 y(sium,)c(July)g(1996.)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
