%!PS-Adobe-2.0
%%Creator: dvips(k) 5.86 Copyright 1999 Radical Eye Software
%%Title: ndss_main.dvi
%%Pages: 13
%%PageOrder: Ascend
%%BoundingBox: 0 0 596 842
%%DocumentFonts: Times-Bold Times-Roman Times-Italic Helvetica Courier
%%+ Helvetica-Oblique Courier-Oblique
%%EndComments
%DVIPSWebPage: (www.radicaleye.com)
%DVIPSCommandLine: dvips -ondss_main.ps ndss_main
%DVIPSParameters: dpi=600, compressed
%DVIPSSource:  TeX output 2001.11.12:1132
%%BeginProcSet: texc.pro
%!
<< /Duplex false >> setpagedevice
/TeXDict 300 dict def TeXDict begin/N{def}def/B{bind def}N/S{exch}N/X{S
N}B/A{dup}B/TR{translate}N/isls false N/vsize 11 72 mul N/hsize 8.5 72
mul N/landplus90{false}def/@rigin{isls{[0 landplus90{1 -1}{-1 1}ifelse 0
0 0]concat}if 72 Resolution div 72 VResolution div neg scale isls{
landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div hsize
mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul TR[
matrix currentmatrix{A A round sub abs 0.00001 lt{round}if}forall round
exch round exch]setmatrix}N/@landscape{/isls true N}B/@manualfeed{
statusdict/manualfeed true put}B/@copies{/#copies X}B/FMat[1 0 0 -1 0 0]
N/FBB[0 0 0 0]N/nn 0 N/IEn 0 N/ctr 0 N/df-tail{/nn 8 dict N nn begin
/FontType 3 N/FontMatrix fntrx N/FontBBox FBB N string/base X array
/BitMaps X/BuildChar{CharBuilder}N/Encoding IEn N end A{/foo setfont}2
array copy cvx N load 0 nn put/ctr 0 N[}B/sf 0 N/df{/sf 1 N/fntrx FMat N
df-tail}B/dfs{div/sf X/fntrx[sf 0 0 sf neg 0 0]N df-tail}B/E{pop nn A
definefont setfont}B/Cw{Cd A length 5 sub get}B/Ch{Cd A length 4 sub get
}B/Cx{128 Cd A length 3 sub get sub}B/Cy{Cd A length 2 sub get 127 sub}
B/Cdx{Cd A length 1 sub get}B/Ci{Cd A type/stringtype ne{ctr get/ctr ctr
1 add N}if}B/id 0 N/rw 0 N/rc 0 N/gp 0 N/cp 0 N/G 0 N/CharBuilder{save 3
1 roll S A/base get 2 index get S/BitMaps get S get/Cd X pop/ctr 0 N Cdx
0 Cx Cy Ch sub Cx Cw add Cy setcachedevice Cw Ch true[1 0 0 -1 -.1 Cx
sub Cy .1 sub]/id Ci N/rw Cw 7 add 8 idiv string N/rc 0 N/gp 0 N/cp 0 N{
rc 0 ne{rc 1 sub/rc X rw}{G}ifelse}imagemask restore}B/G{{id gp get/gp
gp 1 add N A 18 mod S 18 idiv pl S get exec}loop}B/adv{cp add/cp X}B
/chg{rw cp id gp 4 index getinterval putinterval A gp add/gp X adv}B/nd{
/cp 0 N rw exit}B/lsh{rw cp 2 copy get A 0 eq{pop 1}{A 255 eq{pop 254}{
A A add 255 and S 1 and or}ifelse}ifelse put 1 adv}B/rsh{rw cp 2 copy
get A 0 eq{pop 128}{A 255 eq{pop 127}{A 2 idiv S 128 and or}ifelse}
ifelse put 1 adv}B/clr{rw cp 2 index string putinterval adv}B/set{rw cp
fillstr 0 4 index getinterval putinterval adv}B/fillstr 18 string 0 1 17
{2 copy 255 put pop}for N/pl[{adv 1 chg}{adv 1 chg nd}{1 add chg}{1 add
chg nd}{adv lsh}{adv lsh nd}{adv rsh}{adv rsh nd}{1 add adv}{/rc X nd}{
1 add set}{1 add clr}{adv 2 chg}{adv 2 chg nd}{pop nd}]A{bind pop}
forall N/D{/cc X A type/stringtype ne{]}if nn/base get cc ctr put nn
/BitMaps get S ctr S sf 1 ne{A A length 1 sub A 2 index S get sf div put
}if put/ctr ctr 1 add N}B/I{cc 1 add D}B/bop{userdict/bop-hook known{
bop-hook}if/SI save N @rigin 0 0 moveto/V matrix currentmatrix A 1 get A
mul exch 0 get A mul add .99 lt{/QV}{/RV}ifelse load def pop pop}N/eop{
SI restore userdict/eop-hook known{eop-hook}if showpage}N/@start{
userdict/start-hook known{start-hook}if pop/VResolution X/Resolution X
1000 div/DVImag X/IEn 256 array N 2 string 0 1 255{IEn S A 360 add 36 4
index cvrs cvn put}for pop 65781.76 div/vsize X 65781.76 div/hsize X}N
/p{show}N/RMat[1 0 0 -1 0 0]N/BDot 260 string N/Rx 0 N/Ry 0 N/V{}B/RV/v{
/Ry X/Rx X V}B statusdict begin/product where{pop false[(Display)(NeXT)
(LaserWriter 16/600)]{A length product length le{A length product exch 0
exch getinterval eq{pop true exit}if}{pop}ifelse}forall}{false}ifelse
end{{gsave TR -.1 .1 TR 1 1 scale Rx Ry false RMat{BDot}imagemask
grestore}}{{gsave TR -.1 .1 TR Rx Ry scale 1 1 false RMat{BDot}
imagemask grestore}}ifelse B/QV{gsave newpath transform round exch round
exch itransform moveto Rx 0 rlineto 0 Ry neg rlineto Rx neg 0 rlineto
fill grestore}B/a{moveto}B/delta 0 N/tail{A/delta X 0 rmoveto}B/M{S p
delta add tail}B/b{S p tail}B/c{-4 M}B/d{-3 M}B/e{-2 M}B/f{-1 M}B/g{0 M}
B/h{1 M}B/i{2 M}B/j{3 M}B/k{4 M}B/w{0 rmoveto}B/l{p -4 w}B/m{p -3 w}B/n{
p -2 w}B/o{p -1 w}B/q{p 1 w}B/r{p 2 w}B/s{p 3 w}B/t{p 4 w}B/x{0 S
rmoveto}B/y{3 2 roll p a}B/bos{/SS save N}B/eos{SS restore}B end

%%EndProcSet
%%BeginProcSet: 8r.enc
% @@psencodingfile@{
%   author = "S. Rahtz, P. MacKay, Alan Jeffrey, B. Horn, K. Berry",
%   version = "0.6",
%   date = "1 July 1998",
%   filename = "8r.enc",
%   email = "tex-fonts@@tug.org",
%   docstring = "Encoding for TrueType or Type 1 fonts
%                to be used with TeX."
% @}
% 
% Idea is to have all the characters normally included in Type 1 fonts
% available for typesetting. This is effectively the characters in Adobe
% Standard Encoding + ISO Latin 1 + extra characters from Lucida.
% 
% Character code assignments were made as follows:
% 
% (1) the Windows ANSI characters are almost all in their Windows ANSI
% positions, because some Windows users cannot easily reencode the
% fonts, and it makes no difference on other systems. The only Windows
% ANSI characters not available are those that make no sense for
% typesetting -- rubout (127 decimal), nobreakspace (160), softhyphen
% (173). quotesingle and grave are moved just because it's such an
% irritation not having them in TeX positions.
% 
% (2) Remaining characters are assigned arbitrarily to the lower part
% of the range, avoiding 0, 10 and 13 in case we meet dumb software.
% 
% (3) Y&Y Lucida Bright includes some extra text characters; in the
% hopes that other PostScript fonts, perhaps created for public
% consumption, will include them, they are included starting at 0x12.
% 
% (4) Remaining positions left undefined are for use in (hopefully)
% upward-compatible revisions, if someday more characters are generally
% available.
% 
% (5) hyphen appears twice for compatibility with both 
% ASCII and Windows.
% 
/TeXBase1Encoding [
% 0x00 (encoded characters from Adobe Standard not in Windows 3.1)
  /.notdef /dotaccent /fi /fl
  /fraction /hungarumlaut /Lslash /lslash
  /ogonek /ring /.notdef
  /breve /minus /.notdef 
% These are the only two remaining unencoded characters, so may as
% well include them.
  /Zcaron /zcaron 
% 0x10
 /caron /dotlessi 
% (unusual TeX characters available in, e.g., Lucida Bright)
 /dotlessj /ff /ffi /ffl 
 /.notdef /.notdef /.notdef /.notdef
 /.notdef /.notdef /.notdef /.notdef
 % very contentious; it's so painful not having quoteleft and quoteright
 % at 96 and 145 that we move the things normally found there to here.
 /grave /quotesingle 
% 0x20 (ASCII begins)
 /space /exclam /quotedbl /numbersign
 /dollar /percent /ampersand /quoteright
 /parenleft /parenright /asterisk /plus /comma /hyphen /period /slash
% 0x30
 /zero /one /two /three /four /five /six /seven
 /eight /nine /colon /semicolon /less /equal /greater /question
% 0x40
 /at /A /B /C /D /E /F /G /H /I /J /K /L /M /N /O
% 0x50
 /P /Q /R /S /T /U /V /W
 /X /Y /Z /bracketleft /backslash /bracketright /asciicircum /underscore
% 0x60
 /quoteleft /a /b /c /d /e /f /g /h /i /j /k /l /m /n /o
% 0x70
 /p /q /r /s /t /u /v /w
 /x /y /z /braceleft /bar /braceright /asciitilde
 /.notdef % rubout; ASCII ends
% 0x80
 /.notdef /.notdef /quotesinglbase /florin
 /quotedblbase /ellipsis /dagger /daggerdbl
 /circumflex /perthousand /Scaron /guilsinglleft
 /OE /.notdef /.notdef /.notdef
% 0x90
 /.notdef /.notdef /.notdef /quotedblleft
 /quotedblright /bullet /endash /emdash
 /tilde /trademark /scaron /guilsinglright
 /oe /.notdef /.notdef /Ydieresis
% 0xA0
 /.notdef % nobreakspace
 /exclamdown /cent /sterling
 /currency /yen /brokenbar /section
 /dieresis /copyright /ordfeminine /guillemotleft
 /logicalnot
 /hyphen % Y&Y (also at 45); Windows' softhyphen
 /registered
 /macron
% 0xD0
 /degree /plusminus /twosuperior /threesuperior
 /acute /mu /paragraph /periodcentered
 /cedilla /onesuperior /ordmasculine /guillemotright
 /onequarter /onehalf /threequarters /questiondown
% 0xC0
 /Agrave /Aacute /Acircumflex /Atilde /Adieresis /Aring /AE /Ccedilla
 /Egrave /Eacute /Ecircumflex /Edieresis
 /Igrave /Iacute /Icircumflex /Idieresis
% 0xD0
 /Eth /Ntilde /Ograve /Oacute
 /Ocircumflex /Otilde /Odieresis /multiply
 /Oslash /Ugrave /Uacute /Ucircumflex
 /Udieresis /Yacute /Thorn /germandbls
% 0xE0
 /agrave /aacute /acircumflex /atilde
 /adieresis /aring /ae /ccedilla
 /egrave /eacute /ecircumflex /edieresis
 /igrave /iacute /icircumflex /idieresis
% 0xF0
 /eth /ntilde /ograve /oacute
 /ocircumflex /otilde /odieresis /divide
 /oslash /ugrave /uacute /ucircumflex
 /udieresis /yacute /thorn /ydieresis
] def

%%EndProcSet
%%BeginProcSet: texps.pro
%!
TeXDict begin/rf{findfont dup length 1 add dict begin{1 index/FID ne 2
index/UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll
exec 0 exch 5 -1 roll VResolution Resolution div mul neg 0 0]/Metrics
exch def dict begin Encoding{exch dup type/integertype ne{pop pop 1 sub
dup 0 le{pop}{[}ifelse}{FontMatrix 0 get div Metrics 0 get div def}
ifelse}forall Metrics/Metrics currentdict end def[2 index currentdict
end definefont 3 -1 roll makefont/setfont cvx]cvx def}def/ObliqueSlant{
dup sin S cos div neg}B/SlantFont{4 index mul add}def/ExtendFont{3 -1
roll mul exch}def/ReEncodeFont{CharStrings rcheck{/Encoding false def
dup[exch{dup CharStrings exch known not{pop/.notdef/Encoding true def}
if}forall Encoding{]exch pop}{cleartomark}ifelse}if/Encoding exch def}
def end

%%EndProcSet
%%BeginProcSet: special.pro
%!
TeXDict begin/SDict 200 dict N SDict begin/@SpecialDefaults{/hs 612 N
/vs 792 N/ho 0 N/vo 0 N/hsc 1 N/vsc 1 N/ang 0 N/CLIP 0 N/rwiSeen false N
/rhiSeen false N/letter{}N/note{}N/a4{}N/legal{}N}B/@scaleunit 100 N
/@hscale{@scaleunit div/hsc X}B/@vscale{@scaleunit div/vsc X}B/@hsize{
/hs X/CLIP 1 N}B/@vsize{/vs X/CLIP 1 N}B/@clip{/CLIP 2 N}B/@hoffset{/ho
X}B/@voffset{/vo X}B/@angle{/ang X}B/@rwi{10 div/rwi X/rwiSeen true N}B
/@rhi{10 div/rhi X/rhiSeen true N}B/@llx{/llx X}B/@lly{/lly X}B/@urx{
/urx X}B/@ury{/ury X}B/magscale true def end/@MacSetUp{userdict/md known
{userdict/md get type/dicttype eq{userdict begin md length 10 add md
maxlength ge{/md md dup length 20 add dict copy def}if end md begin
/letter{}N/note{}N/legal{}N/od{txpose 1 0 mtx defaultmatrix dtransform S
atan/pa X newpath clippath mark{transform{itransform moveto}}{transform{
itransform lineto}}{6 -2 roll transform 6 -2 roll transform 6 -2 roll
transform{itransform 6 2 roll itransform 6 2 roll itransform 6 2 roll
curveto}}{{closepath}}pathforall newpath counttomark array astore/gc xdf
pop ct 39 0 put 10 fz 0 fs 2 F/|______Courier fnt invertflag{PaintBlack}
if}N/txpose{pxs pys scale ppr aload pop por{noflips{pop S neg S TR pop 1
-1 scale}if xflip yflip and{pop S neg S TR 180 rotate 1 -1 scale ppr 3
get ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub neg TR}if xflip
yflip not and{pop S neg S TR pop 180 rotate ppr 3 get ppr 1 get neg sub
neg 0 TR}if yflip xflip not and{ppr 1 get neg ppr 0 get neg TR}if}{
noflips{TR pop pop 270 rotate 1 -1 scale}if xflip yflip and{TR pop pop
90 rotate 1 -1 scale ppr 3 get ppr 1 get neg sub neg ppr 2 get ppr 0 get
neg sub neg TR}if xflip yflip not and{TR pop pop 90 rotate ppr 3 get ppr
1 get neg sub neg 0 TR}if yflip xflip not and{TR pop pop 270 rotate ppr
2 get ppr 0 get neg sub neg 0 S TR}if}ifelse scaleby96{ppr aload pop 4
-1 roll add 2 div 3 1 roll add 2 div 2 copy TR .96 dup scale neg S neg S
TR}if}N/cp{pop pop showpage pm restore}N end}if}if}N/normalscale{
Resolution 72 div VResolution 72 div neg scale magscale{DVImag dup scale
}if 0 setgray}N/psfts{S 65781.76 div N}N/startTexFig{/psf$SavedState
save N userdict maxlength dict begin/magscale true def normalscale
currentpoint TR/psf$ury psfts/psf$urx psfts/psf$lly psfts/psf$llx psfts
/psf$y psfts/psf$x psfts currentpoint/psf$cy X/psf$cx X/psf$sx psf$x
psf$urx psf$llx sub div N/psf$sy psf$y psf$ury psf$lly sub div N psf$sx
psf$sy scale psf$cx psf$sx div psf$llx sub psf$cy psf$sy div psf$ury sub
TR/showpage{}N/erasepage{}N/copypage{}N/p 3 def @MacSetUp}N/doclip{
psf$llx psf$lly psf$urx psf$ury currentpoint 6 2 roll newpath 4 copy 4 2
roll moveto 6 -1 roll S lineto S lineto S lineto closepath clip newpath
moveto}N/endTexFig{end psf$SavedState restore}N/@beginspecial{SDict
begin/SpecialSave save N gsave normalscale currentpoint TR
@SpecialDefaults count/ocount X/dcount countdictstack N}N/@setspecial{
CLIP 1 eq{newpath 0 0 moveto hs 0 rlineto 0 vs rlineto hs neg 0 rlineto
closepath clip}if ho vo TR hsc vsc scale ang rotate rwiSeen{rwi urx llx
sub div rhiSeen{rhi ury lly sub div}{dup}ifelse scale llx neg lly neg TR
}{rhiSeen{rhi ury lly sub div dup scale llx neg lly neg TR}if}ifelse
CLIP 2 eq{newpath llx lly moveto urx lly lineto urx ury lineto llx ury
lineto closepath clip}if/showpage{}N/erasepage{}N/copypage{}N newpath}N
/@endspecial{count ocount sub{pop}repeat countdictstack dcount sub{end}
repeat grestore SpecialSave restore end}N/@defspecial{SDict begin}N
/@fedspecial{end}B/li{lineto}B/rl{rlineto}B/rc{rcurveto}B/np{/SaveX
currentpoint/SaveY X N 1 setlinecap newpath}N/st{stroke SaveX SaveY
moveto}N/fil{fill SaveX SaveY moveto}N/ellipse{/endangle X/startangle X
/yrad X/xrad X/savematrix matrix currentmatrix N TR xrad yrad scale 0 0
1 startangle endangle arc savematrix setmatrix}N end

%%EndProcSet
TeXDict begin 39158280 55380996 1000 600 600 (ndss_main.dvi)
@start /Fa 134[37 37 54 37 42 21 37 25 42 42 42 42 62
17 37 1[17 42 42 21 42 42 37 42 42 40[42 1[42 1[42 52[{
TeXBase1Encoding ReEncodeFont}27 74.7198 /Helvetica rf
/Fb 139[50 50 2[50 50 50 4[50 105[{TeXBase1Encoding ReEncodeFont}6
83.022 /Courier-Oblique rf /Fc 134[29 1[44 2[18 26 3[33
1[48 18 2[18 3[29 33 29 1[33 97[{TeXBase1Encoding ReEncodeFont}12
66.4176 /Times-Italic rf /Fd 139[23 42 28 4[69 18 2[18
3[46 3[46 16[55 7[60 72[{TeXBase1Encoding ReEncodeFont}10
83.022 /Helvetica-Oblique rf /Fe 134[50 50 50 50 50 50
50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50
50 50 7[50 2[50 2[50 3[50 4[50 13[50 50 2[50 50 50 50
1[50 50 1[50 50 1[50 1[50 50 50 50 39[{TeXBase1Encoding ReEncodeFont}46
83.022 /Courier rf
%DVIPSBitmapFont: Ff cmr10 10 12
/Ff 12 94 df<EB0380A3EB0FF0EB7FFE48B512803903F38FC03907C381E0390F8380F0
D81F031338123E003C141C007C140C150E0078143E00F814FE1481A400FCEB80FC157800
FE140012FF127F13C313E3EA3FFF6C7F14F86C13FE6CEBFF80000114C06C14E0013F13F0
1303ECBFF8148FEC83FC1481A2EC80FE157E123C12FF153EA412FE00F8143C00E0147C12
600070147815F8003814F0003C1381001EEB83E0000FEB87C03907E39F803901FFFE006C
5BEB1FE0EB0380A41F437BBD2A>36 D<146014E0EB01C0EB0380EB0700130E131E5B5BA2
5B485AA2485AA212075B120F90C7FCA25A121EA2123EA35AA65AB2127CA67EA3121EA212
1F7EA27F12077F1203A26C7EA26C7E1378A27F7F130E7FEB0380EB01C0EB00E014601352
78BD20>40 D<12C07E12707E7E7E120F6C7E6C7EA26C7E6C7EA21378A2137C133C133E13
1EA2131F7FA21480A3EB07C0A6EB03E0B2EB07C0A6EB0F80A31400A25B131EA2133E133C
137C1378A25BA2485A485AA2485A48C7FC120E5A5A5A5A5A13527CBD20>I<EB03F8EB1F
FF90387E0FC09038F803E03901E000F0484813780007147C48487FA248C77EA2481580A3
007EEC0FC0A600FE15E0B3007E15C0A4007F141F6C1580A36C15006D5B000F143EA26C6C
5B6C6C5B6C6C485A6C6C485A90387E0FC0D91FFFC7FCEB03F8233A7DB72A>48
D<EB01C013031307131F13FFB5FCA2131F1200B3B3A8497E007FB512F0A31C3879B72A>
I<EB0FF0EB7FFE48B57E3903E03FE0390F000FF0000E6D7E486D7E486D7E123000706D7E
126012FCB4EC7F807FA56CC7FC121CC8FCEDFF00A34A5A5D14035D4A5A5D140F4A5A4A5A
92C7FC147C5C495A495A495A495A91C8FC011EEB01805B5B49130348481400485A485A00
0EC75A000FB6FC5A5A485CB6FCA321387CB72A>I<EB07F8EB3FFF4913C03901F80FF039
03C007F848486C7E380E0001000F80381FE0006D7FA56C5A6C5AC85A1401A25D4A5AA24A
5A5DEC0F80027EC7FCEB1FFCECFF809038000FE06E7EEC01FC816E7EED7F80A216C0A215
3F16E0A2121EEA7F80487EA416C049137F007F1580007EC7FC0070ECFF006C495A121E39
0F8003F83907F00FF00001B512C06C6C90C7FCEB0FF8233A7DB72A>I<0006140CD80780
133C9038F003F890B5FC5D5D158092C7FC14FC38067FE090C9FCABEB07F8EB3FFE903878
0F803907E007E090388003F0496C7E12066E7EC87EA28181A21680A4123E127F487EA490
C71300485C12E000605C12700030495A00385C6C1303001E495A6C6C485A3907E03F8000
01B5C7FC38007FFCEB1FE0213A7CB72A>53 D<EB03F8EB1FFF017F13C09038FC07F03901
E001F848486C7E4848137C90C77E48141E000E141F001E80A3121FA27F5D01E0131E6C6C
133E01FC133C6D5B6C6C6C5AECC1E06CEBF3C06C01FFC7FC6C5BEB3FFF6D13C081017F13
F801F07F3903E07FFE3907801FFF48486C1380481303003E6D13C0003CEB007F007C143F
0078EC0FE000F814075A1503A21501A36C15C012781503007C15806CEC07006C5C6C6C13
1ED807E0137C3903F803F0C6B55A013F1380D907FCC7FC233A7DB72A>56
D<007FB812F8B912FCA26C17F8CCFCAE007FB812F8B912FCA26C17F836167B9F41>61
D<EAFFF8A4EAF000B3B3B3B3A3EAFFF8A40D5378BD17>91 D<EAFFF8A4EA0078B3B3B3B3
A3EAFFF8A40D537FBD17>93 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fg cmmi8 8 3
/Fg 3 105 df<90263FFFFC90381FFF80A2D900FEC73803F80018E04AEC07804DC7FC01
01151C5F4A14E04C5A01034A5A040EC8FC4A5B5E010714E04B5A9138E00780030EC9FC01
0F131F157F4A487E14C190391FC71FC014CEEC9C0F02F07F90383FE00702C07FEC000382
5B6F7E137E6F7E13FE167F5B707E1201161F4981831203B539E001FFFEA2392D7CAC3C>
75 D<EB07E0EB1FF890387C1CE0EBF80D3801F00F3803E007EA07C0120FD81F8013C0A2
EA3F00140F481480127EA2141F00FE14005AA2EC3F02EC3E06A25AEC7E0E007CEBFE0C14
FC0101131C393E07BE18391F0E1E38390FFC0FF03903F003C01F1F7D9D25>97
D<131FEA03FFA2EA003FA2133EA2137EA2137CA213FCA25BA21201143F9038F1FFC09038
F3C1F03803FF0001FC7F5BA2485A5BA25B000F13015D1380A2001F13035D1300140748EC
C04016C0003E130F1580007E148191381F0180007C1403ED070000FCEB0F06151E48EB07
F80070EB01E0222F7DAD29>104 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fh cmr8 8 3
/Fh 3 94 df<140EA2141E143EA2147E14FEA2EB01BE1303143E1306130E130C13181338
1330136013E013C0EA0180120313001206120E120C5A123812305A12E0B612FCA2C7EA3E
00A9147F90381FFFFCA21E2D7EAC23>52 D<EAFFE0A3EAE000B3B3B3A7EAFFE0A30B4379
B114>91 D<EAFFE0A31200B3B3B3A712FFA30B437FB114>93 D E
%EndDVIPSBitmapFont
/Fi 135[33 1[33 16[37 1[33 99[{TeXBase1Encoding ReEncodeFont}4
66.4176 /Helvetica rf /Fj 105[33 27[29 33 1[48 33 33
18 26 22 1[33 33 33 52 18 33 1[18 33 33 22 29 33 29 33
29 12[41 3[37 6[22 5[44 44 48 5[18 12[17 22 17 2[22 22
22 39[{TeXBase1Encoding ReEncodeFont}37 66.4176 /Times-Roman
rf /Fk 202[25 25 25 25 25 49[{TeXBase1Encoding ReEncodeFont}5
49.8132 /Times-Roman rf /Fl 202[29 29 29 29 29 49[{
TeXBase1Encoding ReEncodeFont}5 58.1154 /Times-Roman
rf
%DVIPSBitmapFont: Fm cmmi10 10 25
/Fm 25 119 df<121C127FEAFF80A5EA7F00121C0909798817>58
D<121C127FEAFF80A213C0A3127F121C1200A412011380A2120313005A1206120E5A5A5A
12600A19798817>I<EF0380EF0FC0173FEFFF80933803FE00EE0FF8EE3FE0EEFF80DB03
FEC7FCED0FF8ED3FE0EDFF80DA03FEC8FCEC0FF8EC3FE0ECFF80D903FEC9FCEB0FF8EB3F
E0EBFF80D803FECAFCEA0FF8EA3FE0EA7F8000FECBFCA2EA7F80EA3FE0EA0FF8EA03FEC6
6C7EEB3FE0EB0FF8EB03FE903800FF80EC3FE0EC0FF8EC03FE913800FF80ED3FE0ED0FF8
ED03FE923800FF80EE3FE0EE0FF8EE03FE933800FF80EF3FC0170FEF0380323279AD41>
I<150C151E153EA2153C157CA2157815F8A215F01401A215E01403A215C01407A2158014
0FA215005CA2141E143EA2143C147CA2147814F8A25C1301A25C1303A2495AA25C130FA2
91C7FC5BA2131E133EA2133C137CA2137813F8A25B1201A25B1203A25B1207A25B120FA2
90C8FC5AA2121E123EA2123C127CA2127812F8A25A12601F537BBD2A>I<126012FCB4FC
EA7FC0EA1FF0EA07FCEA01FF38007FC0EB1FF0EB07FCEB01FF9038007FC0EC1FF0EC07FC
EC01FF9138007FC0ED1FF0ED07FCED01FF9238007FC0EE1FF0EE07FCEE01FF9338007F80
EF1FC0A2EF7F80933801FF00EE07FCEE1FF0EE7FC04B48C7FCED07FCED1FF0ED7FC04A48
C8FCEC07FCEC1FF0EC7FC04948C9FCEB07FCEB1FF0EB7FC04848CAFCEA07FCEA3FF0EA7F
C048CBFC12FC1270323279AD41>I<0103B812F05BA290260007F8C7123F4B1407F003E0
020F150118005DA2141FA25D19C0143FA24B1330A2027F1470190092C7126017E05C1601
4A495A160F49B6FCA25F9138FC000F01031407A24A6DC8FCA201075C18034A130660010F
160693C7FC4A150E180C011F161C18184A1538A2013F5E18F04A4A5AA2017F15074D5A91
C8123F49913803FF80B9FCA295C7FC3C397DB83D>69 D<0103B612F849EDFF8018E0903B
0007F8001FF84BEB03FCEF00FE020F157FA24BEC3F80A2021F16C0A25DA2143FF07F805D
A2027FEDFF006092C7485A4D5A4A4A5A4D5A4AEC1F80057FC7FC0101EC07F891B612E094
C8FC9139FC000FC00103EC03F0707E4A6D7E831307177E5C177F010F5D5F5CA2011F1401
A25CA2133F16034A4A1360A2017F17E019C091C71401496C01011480B61503933900FE07
00EF7E0ECAEA1FFCEF07F03B3B7DB83F>82 D<92391FE00380DBFFFC130002036D5A9139
0FE01F8F91393F0007DF027EEB01FE02F81300495A4948147E177C4948143C495AA2011F
153891C8FCA3491530A28094C7FC80806D7E14FEECFFE06D13FE6DEBFFC06D14F06D806D
80021F7F02037FEC003F03037F1500167F163F161FA3120C160FA2001C151F94C7FCA300
3C153EA25E003E5D127E007F4A5A6D495A6DEB0FC0D8F9F0495AD8F0FE01FEC8FC39E03F
FFF8010F13E0D8C00190C9FC313D7CBA33>I<003FB56C48B51280485DA226007F80C738
1FF00091C8EA07C0604993C7FCA2491506A20001160E170C5BA20003161C17185BA20007
163817305BA2000F167017605BA2001F16E05F5BA2003F15015F5BA2007F150394C8FC90
C8FCA25E4815065A160E160C161C161816385E127E5E4B5A6C4A5A4BC9FC6C6C131E6C6C
5B6C6C13F83903F807E06CB55A6C6C48CAFCEB0FF0393B7BB839>85
D<147E903803FF8090390FC1C38090391F00EFC0017E137F49133F485A4848EB1F801207
5B000F143F48481400A2485A5D007F147E90C7FCA215FE485C5AA214015D48150CA21403
EDF01C16181407007C1538007E010F1330003E131F027B13706C01E113E03A0F83C0F9C0
3A03FF007F80D800FCEB1F0026267DA42C>97 D<133FEA1FFFA3C67E137EA313FE5BA312
015BA312035BA31207EBE0FCEBE3FF9038E707C0390FFE03E09038F801F001F013F8EBE0
00485A15FC5BA2123F90C7FCA214015A127EA2140312FE4814F8A2140715F05AEC0FE0A2
15C0EC1F80143F00781400007C137E5C383C01F86C485A380F07C06CB4C7FCEA01FC1E3B
7CB924>I<EC3FC0903801FFF0903807E03C90380F800E90383F0007017E131F49137F48
4813FF485A485A120F4913FE001F143848481300A2127F90C8FCA35A5AA45AA315031507
007E1406150E003E143C003F14706C14E0390F8007C03907C03F003801FFF838003FC020
267DA424>I<163FED1FFFA3ED007F167EA216FEA216FCA21501A216F8A21503A216F0A2
1507A2027E13E0903803FF8790380FC1CF90381F00EF017EEB7FC049133F485A4848131F
000715805B000F143F485A1600485A5D127F90C7127EA215FE5A485CA21401A248ECF80C
A21403161CEDF0181407007C1538007E010F1330003E131F027B13706C01E113E03A0F83
C0F9C03A03FF007F80D800FCEB1F00283B7DB92B>I<EC3FC0903801FFF0903807E07890
381F801C90387E001E49130E485A485A1207485A49131E001F141C153C484813F8EC03E0
007FEB3FC09038FFFE0014E090C8FC5A5AA7007E140315071506003E140E153C6C14706C
6C13E0EC07C03903E03F003801FFF838003FC020267DA427>I<EB03F0EA01FFA3EA0007
5CA3130F5CA3131F5CA3133F91C9FCA35B90387E03F8EC0FFF91383C0F809039FEF007C0
D9FDC07FEBFF80EC0003485A5BA249130712035BA2150F00075D5BA2151F000F5D5B153F
93C7FC121F4990387F0180157EEDFE03003F02FC130090C7FC5EEDF80648150E007E150C
161C5E00FEEC787048EC3FE00038EC0F80293B7CB930>104 D<14E0EB03F8A21307A314
F0EB01C090C7FCAB13F8EA03FEEA070F000E1380121C121812381230EA701F1260133F00
E0130012C05BEA007EA213FE5B1201A25B12035BA20007131813E01438000F133013C014
70EB806014E014C01381EB838038078700EA03FEEA00F815397EB71D>I<150FED3F80A2
157FA31600151C92C7FCABEC0F80EC3FE0ECF0F0903801C0F849487E14005B130E130C13
1CEB1801133801305BA2EB0003A25DA21407A25DA2140FA25DA2141FA25DA2143FA292C7
FCA25CA2147EA214FEA25CA21301001E5B123F387F83F0A238FF87E0495A00FE5BD87C1F
C8FCEA707EEA3FF8EA0FC0214981B722>I<EB0FC0EA03FF5AA2EA001F1480A2133FA214
00A25BA2137EA213FEA25BA21201A25BA21203A25BA21207A25BA2120FA25BA2121FA25B
A2123FA290C7FCA25AA2EA7E03A2EAFE07130612FCA2130E130C131C1318EA7C38EA3C70
EA1FE0EA0780123B7DB919>108 D<D803E0017F14FE3D07F801FFE003FFC03D0E3C0781
F00F03E03D1C3E1E00F83C01F026383F38D9FC707F00304914E04A90387DC000007049EB
7F8000604991C7FCA200E090C700FE1301485A017E5CA200000201140301FE5F495CA203
031407000160495C180F03075D1203494A011F13601980030F023F13E00007F000C0495C
1901031F023E1380000F1803494A150061033F150E001FEF1E1C4991C7EA0FF80007C700
0EEC03E043267EA449>I<EC1FC0ECFFF8903807E07E90380F801F90393F000F80017E14
C0491307484814E0485A4848EB03F0120F5B121F48481307A2127F90C7FCA2150F5A4815
E0A2151F16C0A248EC3F8016005D157E007E5C4A5A003E495A003F495A6C495A6C6C48C7
FC3807E07E3801FFF038003F8024267DA428>111 D<90390F8003F090391FE00FFC9039
39F03C1F903A70F8700F80903AE0FDE007C09038C0FF80030013E00001491303018015F0
5CEA038113015CA2D800031407A25CA20107140FA24A14E0A2010F141F17C05CEE3F8013
1FEE7F004A137E16FE013F5C6E485A4B5A6E485A90397F700F80DA383FC7FC90387E1FFC
EC07E001FEC9FCA25BA21201A25BA21203A25B1207B512C0A32C3583A42A>I<3903E001
F83907F807FE390E3C1E07391C3E381F3A183F703F800038EBE07F0030EBC0FF00705B00
601500EC007E153CD8E07F90C7FCEAC07EA2120013FE5BA312015BA312035BA312075BA3
120F5BA3121F5B0007C9FC21267EA425>114 D<EB01C0497E1307A4130F5CA3131F5CA3
133F91C7FC007FB51280A2B6FCD8007EC7FCA313FE5BA312015BA312035BA312075BA312
0FEBC006A2140E001F130CEB801C141814385C146014E0380F81C038078780D803FEC7FC
EA00F819357EB31E>116 D<13F8D803FE1438D8070F147C000E6D13FC121C1218003814
011230D8701F5C12601503EAE03F00C001005B5BD8007E1307A201FE5C5B150F1201495C
A2151F120349EC80C0A2153F1681EE0180A2ED7F0303FF130012014A5B3A00F8079F0E90
397C0E0F1C90393FFC07F8903907F001F02A267EA430>I<01F8EB03C0D803FEEB07E0D8
070F130F000E018013F0121C12180038140700301403D8701F130112601500D8E03F14E0
00C090C7FC5BEA007E16C013FE5B1501000115805B150316001203495B1506150E150C15
1C151815385D00015C6D485A6C6C485AD97E0FC7FCEB1FFEEB07F024267EA428>I
E
%EndDVIPSBitmapFont
/Fn 105[46 28[42 42 60 42 46 23 42 28 1[46 46 46 69 18
42 1[18 46 46 23 46 46 42 46 46 12[51 55 2[55 6[23 60
1[51 1[60 60 55 55 14[46 1[46 23 23 1[23 41[42 2[{
TeXBase1Encoding ReEncodeFont}40 83.022 /Helvetica rf
/Fo 134[42 42 60 1[46 28 32 37 1[46 42 46 69 23 1[28
23 46 42 28 37 46 37 46 42 12[55 46 60 1[51 65 1[78 55
2[32 1[65 51 55 60 60 55 60 12[42 42 42 42 2[21 43[46
2[{TeXBase1Encoding ReEncodeFont}43 83.022 /Times-Bold
rf /Fp 105[46 28[46 1[66 46 51 30 36 41 1[51 46 51 76
25 51 1[25 51 46 30 41 51 41 51 46 11[66 61 51 66 1[56
3[61 71 1[36 4[66 1[61 66 10[46 46 46 46 46 46 2[23 42[51
3[{TeXBase1Encoding ReEncodeFont}42 91.3242 /Times-Bold
rf
%DVIPSBitmapFont: Fq cmr7 7 1
/Fq 1 44 df<140EB3A2B812E0A3C7000EC8FCB3A22B2B7DA333>43
D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fr cmsy10 10 10
/Fr 10 111 df<007FB81280B912C0A26C17803204799641>0 D<121C127FEAFF80A5EA
7F00121C0909799917>I<EB0380497EA7397803803C00FC147E00FE14FE397F8383FC39
3FC387F8390FE38FE03903FBBF803900FFFE00EB3FF8EB0FE0A2EB3FF8EBFFFE3903FBBF
80390FE38FE0393FC387F8397F8383FC39FE0380FE00FC147E0078143C390007C000A76D
5A1F247BA62A>3 D<EB1FF0EBFFFE487F000714C04814E04814F04814F8A24814FCA3B6
12FEA96C14FCA36C14F8A26C14F06C14E06C14C0000114006C5BEB1FF01F1F7BA42A>15
D<D93F801508D9FFF0151C00037F4813FE487F4814C09026C07FE0143C273F000FF01438
003CD907FC147848EB01FE6E6C6C13F0007091383FC00300F091391FF80FE0486EB5FC03
0314C06F14806F6C1300EE3FFC0040ED07F036137B9D41>24 D<173CA2173E171E171F83
84717E170384717E717E187C007FB812FEBAFC856C84CBEA03F0727EF000FEF13F80F11F
E0F107F8F101FFA2F107F8F11FE0F13F80F1FE00F001F84E5A007FB912C0BA5A96C7FC6C
5FCB127C604D5A4D5A6017074D5A95C8FC5F171E173E173CA248307BAC53>41
D<EE0180EE03C01607A2EE0F80A2EE1F00A2163EA25EA25EA24B5AA24B5AA24B5A150F5E
4BC7FCA2153EA25DA25DA24A5AA24A5AA24A5AA24A5AA24AC8FCA2143EA25CA25CA2495A
A2495AA2495AA2495AA249C9FCA2133EA25B13FC5B485AA2485AA2485AA2485AA248CAFC
A2123EA25AA25AA25A12602A4E75BB00>54 D<EC01F8140FEC3F80ECFC00495A495A495A
A2130F5CB3A7131F5C133F49C7FC13FEEA03F8EA7FE048C8FCEA7FE0EA03F8EA00FE137F
6D7E131F80130FB3A7801307A26D7E6D7E6D7EEC3F80EC0FF814011D537ABD2A>102
D<12FCEAFFC0EA07F0EA01FCEA007E7F80131F80130FB3A7801307806D7E6D7EEB007EEC
1FF0EC07F8EC1FF0EC7E00495A495A495A5C130F5CB3A7131F5C133F91C7FC137E485AEA
07F0EAFFC000FCC8FC1D537ABD2A>I<126012F07EA21278127CA2123C123EA2121E121F
A27E7FA212077FA212037FA212017FA212007FA21378137CA2133C133EA2131E131FA27F
80A2130780A26D7EA2130180A2130080A21478147CA2143C143EA2141E141FA2801580A2
140715C0A2140315E0A2140115F0A2140015F8A21578157CA2153C153EA2151E150C1F53
7BBD2A>110 D E
%EndDVIPSBitmapFont
/Fs 75[28 29[42 1[37 37 24[37 42 42 60 42 42 23 32 28
42 42 42 42 65 23 42 23 23 42 42 28 37 42 37 42 37 3[28
1[28 51 60 60 78 60 60 51 46 55 60 46 60 60 74 51 60
32 28 60 60 46 51 60 55 55 60 1[37 3[23 23 42 42 42 42
42 42 42 42 42 42 23 21 28 21 1[42 28 28 28 65 69 33[46
46 2[{TeXBase1Encoding ReEncodeFont}83 83.022 /Times-Roman
rf /Ft 105[42 27[32 37 37 55 37 42 23 32 32 1[42 42 42
60 23 37 1[23 42 42 23 37 42 37 42 42 8[51 69 1[60 46
42 2[51 60 55 1[46 2[28 3[51 60 55 51 51 6[28 42 42 42
42 1[42 1[42 42 42 1[21 28 21 2[28 28 37[42 2[{
TeXBase1Encoding ReEncodeFont}55 83.022 /Times-Italic
rf /Fu 134[50 50 72 1[55 33 39 44 1[55 50 55 83 28 55
1[28 55 50 33 44 55 44 55 50 9[100 2[66 55 72 1[61 6[39
78 78 1[66 1[72 66 72 8[50 50 50 50 50 50 50 50 3[33
42[55 2[{TeXBase1Encoding ReEncodeFont}44 99.6264 /Times-Bold
rf
%DVIPSBitmapFont: Fv cmsy10 12 2
/Fv 2 104 df<ED0FE015FF913803FC00EC0FE0EC3FC04A5A4AC7FC5C495AA2495AB3AD
495AA2495A131F495A495A01FEC8FCEA07F8EAFFE0A2EA07F8EA00FEEB7F806D7E6D7E13
0F6D7EA26D7EB3AD6D7EA26D7E806E7E6E7EEC0FE0EC03FC913800FFE0150F236479CA32
>102 D<12FEEAFFE0EA07F8EA00FEEB7F806D7E6D7E130F6D7EA26D7EB3AD6D7EA26D7E
806E7E6E7EEC0FE0EC03FC913800FFE0A2913803FC00EC0FE0EC3FC04A5A4AC7FC5C495A
A2495AB3AD495AA2495A131F495A495A01FEC8FCEA07F8EAFFE048C9FC236479CA32>I
E
%EndDVIPSBitmapFont
/Fw 105[50 30[72 1[50 28 39 33 1[50 50 50 78 1[50 1[28
50 50 1[44 1[44 50 44 7[72 1[94 1[72 61 55 66 1[55 1[72
89 2[39 33 72 4[66 66 72 92 6[50 50 2[50 3[50 50 1[25
1[25 44[{TeXBase1Encoding ReEncodeFont}41 99.6264 /Times-Roman
rf /Fx 105[60 28[60 2[60 66 40 47 53 2[60 66 100 33 2[33
3[53 66 53 1[60 8[86 7[73 6[47 93 3[86 1[80 86 6[40 13[30
44[{TeXBase1Encoding ReEncodeFont}25 119.552 /Times-Bold
rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 600dpi
TeXDict begin
%%PaperSize: A4

%%EndSetup
%%Page: 1 1
1 0 bop 228 749 a Fx(BlueBoX:)30 b(A)h(P)n(olicy\226dri)o(v)o(en,)f
(Host\226Based)e(Intrusion)i(Detection)h(system)1197
1065 y Fw(Suresh)25 b(N.)g(Chari)236 b(P)o(au\226Chen)25
b(Cheng)1169 1297 y(IBM)g(Thomas)f(J.)g(W)-8 b(atson)25
b(Research)h(Center)1223 1414 y(Y)-11 b(orkto)n(wn)23
b(Heights,)h(NY)h(10598,)e(U.S.A.)1353 1646 y Fv(f)p
Fw(schari,pau)p Fv(g)p Fw(@w)o(atson.ibm.com)677 1913
y Fu(Abstract)-37 2212 y Ft(In)33 b(this)h(paper)f(we)h(describe)f(our)
h(e)n(xperiences)f(with)h(b)n(uild-)-112 2312 y(ing)21
b(BlueBox,)g(a)h(host)f(based)g(intrusion)h(detection)e(system.)31
b(Our)-112 2412 y(appr)l(oac)o(h)25 b(can)i(be)g(vie)o(wed)g(as)h(cr)m
(eating)f(an)g(infr)o(astructur)m(e)g(for)-112 2511 y(de\002ning)22
b(and)h(enfor)m(cing)g(very)h(\002ne)g(gr)o(ained)e(pr)l(ocess)j
(capabili-)-112 2611 y(ties)f(in)g(the)f(k)o(ernel.)36
b(These)24 b(capabilities)e(ar)m(e)i(speci\002ed)f(as)h(a)g(set)-112
2710 y(of)18 b(rules)g(\(policies\))g(for)g(r)m(e)m(gulating)e(access)j
(to)f(system)h(r)m(esour)m(ces)-112 2810 y(on)g(a)h(per)g(e)n
(xecutable)f(basis.)25 b(The)20 b(langua)o(g)o(e)d(for)k(e)n(xpr)m
(essing)e(the)-112 2910 y(rules)33 b(is)g(intuitive)g(and)e(suf)o
(\002ciently)h(e)n(xpr)m(essive)h(to)g(ef)o(fectively)-112
3009 y(captur)m(e)19 b(security)h(boundaries.)-37 3109
y(W)-8 b(e)16 b(have)f(pr)l(ototyped)f(our)h(appr)l(oac)o(h)e(on)i
(Linux)g(2.2.14)e(k)o(ernel,)-112 3209 y(and)30 b(have)i(b)n(uilt)g
(rule)g(templates)g(for)g(popular)e(daemons)h(suc)o(h)-112
3308 y(as)25 b(Apac)o(he)f(2.0)h(and)g(wu-ftpd.)40 b(W)-8
b(e)26 b(ar)m(e)g(validating)e(our)h(design)-112 3408
y(by)e(testing)h(a)o(gainst)f(a)h(compr)m(ehensive)f(database)f(of)i
(known)g(at-)-112 3507 y(tac)n(ks.)g(Our)17 b(system)h(has)f(been)f
(designed)g(to)h(minimize)g(the)g(k)o(ernel)-112 3607
y(c)o(hang)o(es)26 b(and)h(performance)f(impact)i(and)e(thus)i(can)f
(be)h(ported)-112 3707 y(easily)e(to)g(ne)o(w)g(k)o(ernels.)42
b(W)-8 b(e)27 b(will)g(discuss)g(the)f(motivation)e(and)-112
3806 y(r)o(ationale)30 b(behind)h(BlueBox,)j(its)f(design,)h
(implementation)d(on)-112 3906 y(Linux,)19 b(and)g(r)m(elated)h(work.)
-112 4135 y Fu(1)99 b(Intr)n(oduction)-37 4305 y Fs(The)26
b(tw)o(o)h(mechanisms)f(predominantly)e(used)i(to)h(secure)g(ap-)-112
4405 y(plication)38 b(serv)o(ers)h(today)g(are)g(\002re)n(w)o(alls)h
(and)f(netw)o(ork)f(intru-)-112 4504 y(sion)30 b(detection)g(systems.)
57 b(One)30 b(of)h(the)g(attracti)n(v)o(e)f(features)g(of)-112
4604 y(these)18 b(mechanisms)f(is)i(that)f(the)o(y)f(are)h(independent)
d(of)j(the)g(serv)o(er)-112 4704 y(and)28 b(thus,)j(easily)e(deplo)o
(yed.)50 b(Fire)n(w)o(alls)30 b(controls)e(the)h(\003o)n(w)h(of)-112
4803 y(through)21 b(communication)g(and)j(netw)o(ork)e(IDSs)j(detect)f
(possible)-112 4903 y(attacks)18 b(by)g(monitoring)f(the)h
(communication.)k(While)d(\002re)n(w)o(alls,)-112 5003
y(when)34 b(properly)f(con\002gured,)j(serv)o(e)e(their)h(intended)e
(purpose,)-112 5102 y(current)21 b(netw)o(ork)h(IDSs)i(suf)n(fer)e
(from)g(a)h(number)e(of)i(limitations.)-112 5202 y(Netw)o(ork)d(IDSs)j
(typically)d(analyze)h(traf)n(\002c)h(on)f(the)g(netw)o(ork)g(and)-112
5301 y(either)g(scan)h(for)g(patterns)f(containing)f(kno)n(wn)h
(attacks)h(or)g(detect)-112 5401 y(statistically)35 b(abnormal)d
(patterns.)67 b(W)m(ith)34 b(the)h(adv)o(ent)e(of)h(traf-)-112
5501 y(\002c)24 b(encryption)d(protocols)h(such)h(as)i(SSL)f([FKK96)o
(,)f(D)m(A97)o(])h(and)-112 5600 y(IPSEC)c([Atk95)n(],)g(a)h
(signi\002cant)e(portion)f(of)i(traf)n(\002c)g(on)f(the)h(Inter)n(-)
-112 5700 y(net)25 b(is)h(encrypted)d(and)i(therefore)e(is)k(una)n(v)n
(ailable)c(for)i(e)o(xamina-)2026 1913 y(tion.)48 b(Also,)30
b(there)d(are)h(well\226kno)n(wn)e(w)o(ays)j(to)f(e)n(v)n(ade)f(netw)o
(ork)2026 2013 y(IDSs)c([PN98)o(].)32 b(Thus,)22 b(increasingly)-5
b(,)21 b(intrusion)g(detection)h(must)2026 2113 y(mo)o(v)o(e)g(to)i
(the)g(host)g(serv)o(er)f(where)h(the)g(content)f(is)h(visible)g(in)h
(the)2026 2212 y(clear)g(and)g(these)h(e)n(v)n(asion)e(techniques)h(do)
g(not)g(w)o(ork.)40 b(Our)25 b(sys-)2026 2312 y(tem,)d(BlueBox,)f(is)i
(such)e(a)i(host)e(based)h(real\226time)e(intrusion)h(de-)2026
2412 y(tection)27 b(system)h(and)g(it)h(can)e(also)i(be)e(con\002gured)
f(for)h(blocking)2026 2511 y(intrusions.)2101 2611 y(T)-7
b(o)33 b(contrast)f(our)g(approach)f(we)i(\002rst)g(look)f(at)i
(mechanisms)2026 2710 y(used)23 b(in)g(currently)e(deplo)o(yed)h(host)h
(based)g(IDSs.)34 b(The)o(y)22 b(are)h(pri-)2026 2810
y(marily)c(based)h(on)g(one)f(of)h(the)h(follo)n(wing)d([DD)n(W99)o(,)i
(Jac99)o(]:)2109 2976 y Fr(\017)41 b Fs(Anomaly)e(detection)g(:)66
b(De\002ned)40 b(by)g(a)h(statistical)h(pro-)2192 3076
y(\002le)30 b(of)e(\223normal\224)g(beha)n(vior)f([JV94)o(,)j(ALJ)3480
3046 y Fq(+)3535 3076 y Fs(93)o(,)f(FHSL96)o(,)2192 3176
y(DDNW98)o(].)f(A)21 b(pattern)g(that)g(de)n(viates)f(signi\002cantly)h
(from)2192 3275 y(the)f(normal)f(pro\002le)g(is)j(considered)c(an)i
(attack.)2109 3442 y Fr(\017)41 b Fs(Misuse)16 b(detection:)22
b(De\002ned)15 b(by)g(collections)g(of)g(signatures)2192
3541 y(of)21 b(kno)n(wn)f(attacks)h([Jac99)o(,)g(P)o(ax98)o(,)g(RLS)
3441 3511 y Fq(+)3497 3541 y Fs(97)o(,)g(CDE)3788 3511
y Fq(+)3844 3541 y Fs(96)o(].)2192 3641 y(Acti)n(vities)31
b(matching)f(such)h(patterns)f(are)h(considered)e(at-)2192
3740 y(tacks.)2101 3907 y(Conceptually)-5 b(,)31 b(misuse)g(detection)f
(is)i(based)e(on)h(kno)n(wledge)2026 4006 y(of)24 b(bad)f(beha)n(viors)
g(\(attacks\))h(and)g(anomaly)f(detection)g(is)i(based)2026
4106 y(on)k(kno)n(wledge)f(of)h(good)g(\(normal\))f(beha)n(viors.)52
b(If)30 b(both)f(tech-)2026 4206 y(niques)23 b(were)g(perfect,)g(then)g
(each)g(w)o(ould)g(e)o(xactly)g(complement)2026 4305
y(the)34 b(other:)53 b Ft(i.e)o(.)67 b Fs(what)35 b(is)g(not)f(bad)g
(is)h(good)e(and)h(vice)g(v)o(ersa.)2026 4405 y(In)c(reality)-5
b(,)33 b(neither)d(technique)f(is)j(perfect.)55 b(Misuse)32
b(detection)2026 4504 y(can)d(ne)n(v)o(er)e(kno)n(w)h(all)i(possible)f
(attacks)g(and)g(it)g(usually)g(classi-)2026 4604 y(\002es)i(some)f
(good)f(beha)n(viors)g(as)i(attacks.)55 b(Lik)o(e)n(wise,)32
b(anomaly)2026 4704 y(detection)d(can)g(not)h(co)o(v)o(er)e(all)j(good)
e(beha)n(viors)f(and)i(will)g(mis-)2026 4803 y(tak)o(e)20
b(some)h(attacks)f(for)g(good)f(beha)n(viors.)24 b(Also,)d(an)f
(entity')-5 b(s)21 b(be-)2026 4903 y(ha)n(vior)g(pro\002le)h(will)h
(change)e(as)i(its)g(usage)f(pattern)f(changes.)30 b(So)2026
5003 y(anomaly)18 b(detection)h(has)h(to)h(adapt)e(its)i(pro\002le)e
(to)i(these)f(changes.)2026 5102 y(This)27 b(opens)g(the)h(possibility)
f(for)g(an)g(attack)o(er)g(to)h(gradually)e(in-)2026
5202 y(crease)e(its)g(le)n(v)o(el)g(of)f(malicious)h(acti)n(vities)g
(until)f(these)h(acti)n(vities)2026 5301 y(are)c(considered)e(normal.)
2101 5401 y(Our)28 b(polic)o(y\226dri)n(v)o(en)d(technique,)k(lik)o(e)h
(the)e(concept)g(of)h Ft(sand-)2026 5501 y(boxing)p Fs(,)22
b(tries)h(to)h(de\002ne)e(the)h(boundary)d(between)i(the)h(good)f(and)
2026 5600 y(the)k(bad)f(as)i(a)f(set)h(of)e(rules.)43
b(These)25 b(rules)h(specify)f(what)h(an)g(e)o(x-)2026
5700 y(ecutable)j(program)e(or)j(script)f(is)i(allo)n(wed)e(to)h(do)f
(and)h(attempts)p eop
%%Page: 2 2
2 1 bop -112 458 a Fs(to)27 b(violate)g(them)g(are)g(considered)e
(intrusions.)46 b(The)27 b(rules)g(go)o(v-)-112 558 y(erning)f(a)j
(process)f(de\002ne)g(precisely)f(which)h(system)g(resources)-112
657 y(a)d(process)g(can)f(access)i(and)f(in)g(what)g(w)o(ay)-5
b(.)39 b(Section)25 b(3)g(gi)n(v)o(es)f(an)-112 757 y(o)o(v)o(ervie)n
(w)d(of)i(what)h(the)g(scope)f(of)g(the)h(rules)f(are.)36
b(The)23 b(rules)g(are)-112 857 y(de\002ned)f(through)g(precise)h
(understanding)e(of)j(the)g(e)o(xpected)e(be-)-112 956
y(ha)n(vior)f(of)h(the)h(program.)29 b(The)o(y)22 b(can)g(be)h
(de\002ned)e(using)h(e)o(xisting)-112 1056 y(templates,)d(audit)h
(trails,)h(con\002guration)d(and,)i(if)g(necessary)-5
b(,)19 b(pro-)-112 1155 y(gram)g(semantics.)26 b(The)20
b(rules)h(are)f(speci\002ed)g(of)n(f\226line,)f(compiled)-112
1255 y(into)31 b(a)i(machine)e(readable)g(binary)g(which)g(is)i
(associated)f(with)-112 1355 y(the)24 b(program)e(and)i(loaded)g(into)g
(the)g(k)o(ernel)g(when)g(the)g(program)-112 1454 y(is)f(e)o(x)o
(ecuted.)31 b(Rule)24 b(enforcement)c(happens)h(when)i(the)f(program)
-112 1554 y(is)g(e)o(x)o(ecuted)e(in)i(the)g(conte)o(xt)f(of)g(a)i
(process:)28 b(the)22 b(beha)n(vior)e(of)h(the)-112 1654
y(process)i(is)i(check)o(ed)d(and)i(constrained)e(according)g(to)i(the)
g(rules.)-112 1753 y(The)i(enforcement)f(is)j(done)e(in)h(the)g(k)o
(ernel)g(during)e(in)m(v)n(ocations)-112 1853 y(of)g(system)h(calls.)42
b(The)26 b(concept)e(of)i(sandboxing)d(has)j(appeared)-112
1952 y(in)21 b(numerous)d(conte)o(xts)i(including)g(IDS)h(and)f(we)h
(discuss)h(this)f(in)-112 2052 y(Section)e(2.)-37 2152
y(W)-7 b(e)44 b(belie)n(v)o(e)f(that)g(the)h(polic)o(y\226based)d
(approach)g(of)i(Blue-)-112 2251 y(Box)26 b(and)f(lik)o(e)i(systems)g
(of)n(fers)e(a)i(number)d(of)i(adv)n(antages)f(o)o(v)o(er)-112
2351 y(the)c(traditional)f(attack\226signature\226based)e(or)j
(pro\002le\226based)e(ap-)-112 2451 y(proaches.)k(The)o(y)c(include:)
-29 2621 y Fr(\017)41 b Fs(The)16 b(security)h(boundary)d(is)k(much)e
(more)g(precisely)g(de\002ned)54 2720 y(in)30 b(terms)g(of)h(the)f
(intended)f(use)h(of)h(the)f(sensiti)n(v)o(e)g(system)54
2820 y(resources.)54 b(Rules)31 b(are)f(based)g(on)g(understanding)d(a)
j(pro-)54 2920 y(gram')-5 b(s)19 b(beha)n(vior)g(and)h
Ft(not)f Fs(on)h(attack)g(signatures)g(or)g(time\226)54
3019 y(v)n(ariant,)e(incomplete)f(statistical)k(pro\002les)d(of)h
(\223normal\224)f(be-)54 3119 y(ha)n(vior)-5 b(.)24 b(This)c(has)g(tw)o
(o)h(adv)n(antages:)i(\(1\))d Ft(unknown)e(attac)n(ks)54
3218 y Fs(can)24 b(be)i(detected,)f(\(2\))f(pre)n(viously)g(unseen)g(b)
n(ut)h(le)o(gitimate)54 3318 y(beha)n(viors)f(w)o(ould)i(not)f(be)h
(mistak)o(en)g(for)f(attacks.)43 b(There-)54 3418 y(fore)23
b(the)h(f)o(alse)h(positi)n(v)o(e)f(and)f(\(hopefully\))f(the)i(f)o
(alse)h(ne)o(ga-)54 3517 y(ti)n(v)o(e)20 b(rates)g(will)h(be)f(lo)n
(wer)-5 b(.)-29 3691 y Fr(\017)41 b Fs(Another)18 b(potential)h(win)h
(is)h(the)f(manageability)e(of)i(the)g(IDS)54 3791 y(especially)32
b(as)i(compared)d(to)i(statistical)h(pro\002ling)e(based)54
3891 y(techniques.)47 b(There)27 b(is)j(no)d(need)h(to)g(constantly)f
(maintain)54 3990 y(and)d(update)f(attack\226signature)f(database)i(or)
h(statistic)g(pro-)54 4090 y(\002les.)31 b(Since)22 b(the)h(rules)f
(are)g(precisely)f(de\002ned)g(in)h(terms)h(of)54 4189
y(system)17 b(resources)f(and)g(not)h(by)g(attacks,)g(there)g(will)h
(be)e(v)o(ery)54 4289 y(fe)n(w)i(updates,)f(if)h(an)o(y)-5
b(,)18 b(of)f(rules)h(for)g(an)g(application)e(running)54
4389 y(on)j(a)i(particular)e(platform.)-29 4563 y Fr(\017)41
b Fs(Perhaps)28 b(the)i(most)f(important)f(adv)n(antage)g(of)h
(BlueBox')-5 b(s)54 4662 y(polic)o(y\226based)36 b(approach)h(is)j
(that)f(detection)e(is)j(done)e(in)54 4762 y Ft(r)m(eal\226time)p
Fs(.)58 b(therefore)30 b(there)h(is)i(the)f(option)e(to)i(block)e(an)54
4862 y(unauthorized)17 b(access)k(or)e(act.)-37 5032
y(On)k(the)h(other)f(hand,)g(since)h(the)g(rules)g(are)g(de\002ned)e
(on)i(access)-112 5131 y(to)18 b(system)g(resources)f(there)g(are)h
(disadv)n(antages)f(as)h(compared)e(to)-112 5231 y(other)j(IDSs.)25
b(Some)20 b(of)g(them)g(are:)-29 5401 y Fr(\017)41 b
Fs(V)-9 b(ersion)24 b(Migration:)35 b(Since)26 b(dif)n(ferent)e(v)o
(ersions)h(of)g(appli-)54 5501 y(cations)i(may)h(access)h(dif)n(ferent)
d(resources)h(e)n(v)o(ery)g(v)o(ersion)54 5600 y(will)i(require)e
(modi\002ed)g(sets)j(of)e(rules.)50 b(Ho)n(we)n(v)o(er)m(,)28
b(in)h(our)54 5700 y(e)o(xperience)16 b(with)i(the)h(Apache)e(http)h
(serv)o(er)m(,)f(minor)h(v)o(ersion)2192 458 y(changes)25
b(impact)h(the)h(rules)f(v)o(ery)g(minimally)-5 b(.)42
b(Ev)o(en)25 b(with)2192 558 y(major)i(v)o(ersion)h(changes,)h(lar)o
(ge)e(chunks)h(of)g(the)g(rule)g(sets)2192 657 y(can)20
b(be)g(reused.)2109 828 y Fr(\017)41 b Fs(In)26 b(Memory)e(attacks:)38
b(Since)26 b(the)g(checks)g(on)f(process)h(be-)2192 928
y(ha)n(vior)e(are)h(made)g(only)f(when)h(the)g(process)g(mak)o(es)g(a)g
(sys-)2192 1028 y(tem)31 b(call,)j(attacks)d(which)f(are)h('in)g
(memory')e(can)i(not)g(be)2192 1127 y(detected.)2101
1296 y(The)24 b(rest)h(of)f(the)h(paper)e(is)i(or)o(ganized)d(as)j
(follo)n(ws:)33 b(Section)24 b(2)2026 1396 y(surv)o(e)o(ys)d(related)i
(w)o(ork)f(and)h(compares)f(them)g(with)h(our)g(system.)2026
1495 y(Section)j(3)h(gi)n(v)o(es)f(an)h(o)o(v)o(ervie)n(w)e(of)h(the)h
(speci\002cation)f(and)g(gen-)2026 1595 y(eration)21
b(of)i(rules.)32 b(Section)22 b(4)g(presents)h(the)f(technical)g
(details)h(of)2026 1695 y(our)h(design)g(and)g(implementation,)g(the)g
(precise)h(scope)f(of)h(rules)2026 1794 y(and)g(the)i(system)f
(architecture.)41 b(Section)26 b(5)h(presents)e(a)i(fe)n(w)f(e)o(x-)
2026 1894 y(amples)16 b(of)g(ho)n(w)g(BlueBox)g(thw)o(arts)h(se)n(v)o
(eral)f(well)h(kno)n(wn)d(attacks)2026 1993 y(and)21
b(also)h(details)g(e)o(xperiences)e(on)h(specifying)g(rules.)29
b(Section)21 b(6)2026 2093 y(discusses)k(the)f(performance)e(impact)i
(of)g(the)g(IDS)h(and)f(we)g(con-)2026 2193 y(clude)19
b(in)i(Section)e(7.)2026 2411 y Fu(2)99 b(Related)26
b(W)-7 b(ork)2101 2571 y Fs(Restricting)26 b(program)e(beha)n(vior)h
(based)h(on)g(e)o(xternally)f(spec-)2026 2671 y(i\002ed)j(rules)h(has)f
(a)h(v)o(ery)e(long)h(history)f(dating)h(back)f(to)i(the)f(ref-)2026
2771 y(erence)21 b(monitors)f(of)i(operating)e(systems)i(se)n(v)o(eral)
f(decades)g(ago.)2026 2870 y(In)j(this)i(section,)f(we)g(highlight)e
(more)h(recent)g(mechanisms)g(and)2026 2970 y(compare)15
b(them)h(with)g(our)g(w)o(ork.)23 b(Some)16 b(of)h(the)f(systems)h(are)
g(v)o(ery)2026 3070 y(dif)n(ferent)h(from)h(BlueBox)h(while)h(others)e
(are)h(v)o(ery)f(similar)-5 b(.)2026 3263 y Fp(2.1)90
b(Language)21 b(Based)g(mechanisms)2101 3423 y Fs(There)d(are)h(a)g
(lar)o(ge)f(number)f(of)i(language)e(based)i(mechanisms)2026
3523 y(to)27 b(restrict)f(program)f(beha)n(vior)g(based)i(on)f(polic)o
(y)-5 b(.)43 b(The)o(y)26 b(range)2026 3623 y(from)h(the)i(theoretical)
e(program)f(correctness)i(methodology)d(of)2026 3722
y(using)31 b(asserts,)k(to)c(the)h(popular)d(type)i(based)g(mechanisms)
g(en-)2026 3822 y(forced)d(by)i(the)f(loader)g(such)h(as)g(the)g(f)o
(amed)f(Ja)n(v)n(a)h(V)-5 b(irtual)30 b(Ma-)2026 3922
y(chine)16 b([JVM01)o(].)24 b(While)17 b(the)g(security)g(guarantees)e
(promised)h(by)2026 4021 y(these)27 b(mechanisms)f(are)g(stronger)g
(than)g(ours,)i(the)o(y)e(mak)o(e)h(v)o(ery)2026 4121
y(strong)j(and)g(in)h(some)f(cases,)k(unrealistic,)f(assumptions)d
(about)2026 4220 y(the)f(trusted)g(computing)f(base)h(\(TCB\).)h(Some)f
(classes)i(of)e(such)2026 4320 y(systems)20 b(include)g(the)g(follo)n
(wing:)2026 4547 y Fo(2.1.1)81 b(Pr)o(ogram)18 b(Corr)o(ectness)i
(Based)h(Mechanisms)2026 4704 y Fs(This)36 b(method)f(has)h(been)g(the)
g(subject)g(of)g(e)o(xtensi)n(v)o(e)e(research)2026 4803
y(spanning)22 b(decades.)37 b(Recently)-5 b(,)25 b(these)f(mechanisms)g
(ha)n(v)o(e)f(been)2026 4903 y(proposed)33 b(as)i(ef)n(fecti)n(v)o(e)f
(mechanisms)g(to)h(mitigate)f(e)o(xposures)2026 5003
y([UES00)n(].)39 b(While)25 b(theoretically)f(ele)o(gant,)g(the)o(y)g
(are)g(lar)o(gely)g(re-)2026 5102 y(stricted)16 b(to)g(checks)f(in)h
(the)g(user)g(space.)24 b(Hence,)16 b(the)g(TCB)h(needed)2026
5202 y(for)i(these)i(mechanisms)e(to)i(be)f(ef)n(fecti)n(v)o(e)f(is)j
(unrealistic)d(since)i(all)2026 5301 y(the)28 b(checks)g(inserted)g(in)
g(to)h(the)f(user)g(space)h(program)d Ft(must)j Fs(be)2026
5401 y(e)o(x)o(ecuted.)42 b(This)26 b(is)i(rarely)d(realized)h(in)g
(commercial)f(operating)2026 5501 y(systems:)32 b(An)24
b(attack)o(er)f(mounting)e(a)j(b)n(uf)n(fer)f(o)o(v)o(er\003o)n(w)e
(attack)j(is)2026 5600 y(in)29 b(no)g(w)o(ay)g(restricted)g(by)g(an)o
(y)f(of)h(the)h(checks)e(inserted)h(in)h(the)2026 5700
y(original)19 b(program.)p eop
%%Page: 3 3
3 2 bop -112 458 a Fo(2.1.2)81 b(T)-6 b(ype)20 b(based)h(mechanisms)
-112 614 y Fs(The)26 b(celebrated)g(Ja)n(v)n(a)h(V)-5
b(irtual)27 b(Machine)f(is)i(a)g(classic)g(e)o(xample)-112
713 y(of)i(a)i(system)f(which)f(enforces)g(strong)g(checks)h(on)f
(interpreted)-112 813 y(byte)24 b(code.)38 b(F)o(or)24
b(this)h(mechanism)f(to)h(w)o(ork)f(one)g(has)h(to)g(e)o(xtend)-112
913 y(the)j(TCB)i(to)f(include)f(the)g(interpreter)f(and)i(loader)-5
b(.)50 b(In)28 b(se)n(v)o(eral)-112 1012 y(controlled)23
b(en)m(vironments)f(this)k(is)g(possible,)g(ho)n(we)n(v)o(er)e(it)h(is)
i(not)-112 1112 y(realistic,)18 b(for)e(reasons)h(of)g(performance,)e
(to)j(ha)n(v)o(e)e(daemons)h(such)-112 1211 y(as)j(the)h(http)f(serv)o
(er)f(run)g(in)i(this)f(en)m(vironment.)-112 1392 y Fp(2.2)90
b(System)22 b(call)h(patter)o(n)e(based)g(systems)-37
1539 y Fs(These)29 b(systems)i(identify)e(intrusions)g(by)g(an)h
(initial)g(training)-112 1639 y(phase)d(where)f(e)o(xhausti)n(v)o(e)g
(testing)h(is)i(used)e(to)h(identify)e(the)h(ac-)-112
1739 y(cepted)h(set)j(of)e(patterns)g(in)g(system)h(call)g(sequences,)h
(and)e(then)-112 1838 y(\003agging)20 b(an)h(intrusion)f(if)h(there)g
(are)h(erroneous)d(patterns)i(in)g(sys-)-112 1938 y(tem)31
b(calls)h(made)f(by)g(daemons)f(in)i(an)f(actual)h(run.)58
b(Some)31 b(e)o(x-)-112 2038 y(amples)26 b(are)h(discussed)g(in)g
([FHSL96)n(,)h(DDNW98)o(].)45 b(The)27 b(main)-112 2137
y(adv)n(antage)18 b(of)i(these)h(systems)g(is)g(the)g(minimized)e
(impact)h(on)g(the)-112 2237 y(k)o(ernel)h Ft(i.e)o(.)32
b Fs(one)22 b(needs)g(to)h(mak)o(e)f(fe)n(w)g(changes)f(to)i(the)g(k)o
(ernel)e(to)-112 2336 y(implement)28 b(them.)51 b(Ho)n(we)n(v)o(er)m(,)
30 b(the)o(y)e(can)h(not)g(of)n(fer)g(strong)f(se-)-112
2436 y(curity)i(guarantees:)46 b(Firstly)-5 b(,)33 b(their)e(ef)n
(\002cac)o(y)g(requires)f(e)o(xhaus-)-112 2536 y(ti)n(v)o(e)j(training)
g(to)h(identify)f(normal)g(patterns)g(and)g(if)i(not)e(done)-112
2635 y(correctly)-5 b(,)31 b(can)f(result)g(in)h(a)g(lar)o(ge)e(number)
g(of)h(f)o(alse)h(positi)n(v)o(es.)-112 2735 y(Secondly)h(the)o(y)h
(are)h(v)o(ery)f(sensiti)n(v)o(e)h(to)g(the)g(e)o(xact)g(v)o(ersion)f
(of)-112 2835 y(the)23 b(monitored)e(softw)o(are:)31
b(small)23 b(changes)f(in)i(source)e(code)h(can)-112
2934 y(yield)f(v)o(ery)h(dif)n(ferent)e(system)j(call)f(patterns.)34
b(F)o(or)23 b(e)o(xample,)f(the)-112 3034 y(Apache)27
b(http)h(daemon)f(can)i(be)f(con\002gured)e(to)j(run)e(using)h(pro-)
-112 3133 y(cesses)19 b(or)f(threads,)f(and)h(the)g(system)g(call)h
(patterns)e(are)i(consider)n(-)-112 3233 y(ably)e(dif)n(ferent.)23
b(Since)18 b(BlueBox)g(tries)g(to)g(capture)f(the)h(resources)-112
3333 y(the)25 b(daemon)g(uses,)i(there)f(are)g(v)o(ery)e(fe)n(w)i
(changes)f(between)g(the)-112 3432 y(tw)o(o)20 b(v)o(ersions.)-112
3613 y Fp(2.3)90 b(K)n(er)o(nel)21 b(Based)g(r)n(efer)n(ence)g
(monitors)-37 3760 y Fs(In)28 b(the)i(last)g(fe)n(w)f(years)g(there)f
(has)i(been)e(a)i(rene)n(wed)d(interest)-112 3860 y(in)i(sandboxing)d
(by)j(intercepting)f(system)h(calls)h(made)f(by)f(pro-)-112
3960 y(cesses.)36 b(W)-7 b(e)25 b(describe)e(some)g(systems)h(and)f
(highlight)f(the)i(simi-)-112 4059 y(larities)c(and)g(dif)n(ferences.)
-112 4276 y Fo(2.3.1)81 b(LIDS)-112 4431 y Fs(The)16
b(Linux)f(Intrusion)f(Detection)i(system)h(\(LIDS\))e([XB01)o(])i(aims)
-112 4531 y(to)30 b(e)o(xtend)g(the)g(concept)g(of)g(capabilities)h
(present)f(in)g(the)h(basic)-112 4631 y(Linux)24 b(system)h(by)g
(de\002ning)f(\002ne)h(grained)f(\002le)i(access)f(capabil-)-112
4730 y(ities)g(for)e(each)h(process.)37 b(BlueBox')-5
b(s)24 b(rules)g(for)g(\002le)h(system)f(ob-)-112 4830
y(jects)e(is)g(v)o(ery)f(similar)g(to)h(this.)30 b(The)21
b(complete)f(rule)i(set)g(of)f(Blue-)-112 4929 y(Box)29
b(is)h(a)g(strict)g(superset)f(of)g(the)h(LIDS)f(system.)53
b(Among)28 b(the)-112 5029 y(se)n(v)o(eral)18 b(additional)g(features)h
(of)g(BlueBox)g(is)h(the)f(state)h(informa-)-112 5129
y(tion)f(which)g(is)i(useful)f(in)g(thw)o(arting)e(some)i(attacks)g(as)
h(described)-112 5228 y(in)f(Section)g(5.)-112 5445 y
Fo(2.3.2)81 b(A)20 b(Pr)o(ogram)f(as)h(a)g(Finite)h(State)e(Machine)
-112 5600 y Fs(Sekar)25 b Ft(et)g(al)h Fs([SU99)o(])f(present)g(a)h
(system)g(which)e(combines)h(lan-)-112 5700 y(guage)c(based)i(systems)g
(with)g(system)g(call)h(intercept)e(based)g(sys-)2026
458 y(tems.)j(Their)20 b(approach)e(is)j(to)f(model)g(processes)g(with)
g(a)h(state)g(di-)2026 558 y(agram)26 b(describing)f(its)j
(functionality)d(and)h(then)g(enforcing)f(this)2026 657
y(state)i(diagram)f(in)h(the)f(k)o(ernel)g(during)g(system)g(call)i(in)
m(v)n(ocation.)2026 757 y(The)o(y)22 b(achie)n(v)o(e)f(strong)h
(security)h(guarantees)e(since)i(the)g(state)h(di-)2026
857 y(agram)h(captures)h(e)o(xact)g(process)g(semantics.)43
b(The)27 b(main)f(dra)o(w-)2026 956 y(back)j(of)h(this)g(system)g(is)h
(the)f(dif)n(\002culty)f(in)h(generating)e(the)i(re-)2026
1056 y(quired)21 b(state)j(diagrams)e(for)g(a)h(ne)n(w)g(process.)33
b(Also,)23 b(we)h(conjec-)2026 1155 y(ture)17 b(based)h(on)g(our)f(e)o
(xperience)f(in)i(incorporating)d(state,)k(that)g(the)2026
1255 y(performance)f(penalty)i(in)i(enforcing)c(the)k(rules)f(could)f
(be)h(some-)2026 1355 y(what)f(high.)2026 1569 y Fo(2.3.3)81
b(Generic)20 b(softwar)o(e)e(wrappers)2026 1724 y Fs(Generic)e(softw)o
(are)g(wrappers[KFBK00)m(,)h(FBF99])g(are)g(a)g(mecha-)2026
1824 y(nism)j(to)h(enforce)d(v)n(arious)h(access)i(control)e(and)h
(intrusion)f(detec-)2026 1924 y(tion)27 b(checks)g(triggered)e(by)i(e)n
(v)o(ents)g(during)f(process)h(e)o(x)o(ecution.)2026
2023 y(The)34 b(infrastructure)f(will)i(re)o(gister)g(v)n(arious)e
(scripts)j(to)f(be)f(run)2026 2123 y(based)16 b(on)g(e)n(v)o(ents,)h
(monitor)e(process)i(e)o(x)o(ecution)d(for)i(these)h(e)n(v)o(ents)2026
2223 y(to)i(occur)m(,)e(and)h(e)o(x)o(ecute)f(re)o(gistered)g(scripts)i
(when)f(the)h(e)n(v)o(ents)f(oc-)2026 2322 y(cur)-5 b(.)44
b(This)27 b(is)g(a)g(po)n(werful)e(infrastructure)f(which)i(can)h(inte)
o(grate)2026 2422 y(numerous)c(approaches)g(to)i(system)g(security)f
(under)g(one)g(unify-)2026 2521 y(ing)29 b(frame)n(w)o(ork.)50
b(The)29 b(main)g(dra)o(wbacks)f(of)h(this)h(approach)e(is)2026
2621 y(the)23 b(comple)o(xity)f(of)h(writing)g(scripts)h(and)f(the)h
(performance)d(im-)2026 2721 y(pact)e(in)g(such)g(a)h(comple)o(x)e
(frame)n(w)o(ork.)k(W)-7 b(e)21 b(belie)n(v)o(e)d(that)h(our)g(ap-)2026
2820 y(proach)k(is)i(much)f(more)f(intuiti)n(v)o(e)h(and)g(has)g
(substantially)g(better)2026 2920 y(performance.)2026
3134 y Fo(2.3.4)81 b(Other)20 b(Sandboxing)f(Systems)2026
3290 y Fs(The)28 b(system)h(that)g(comes)g(closest)g(to)g(our)f(system)
i(is)f(the)g(w)o(ork)2026 3389 y(of)24 b(Bernaschi)h
Ft(et)g(al)g Fs([BGM00)o(].)39 b(Their)24 b(system)h(architecture)f(is)
2026 3489 y(v)o(ery)16 b(similar)i(to)g(ours)f(and)g(the)h(main)f(dif)n
(ferences)f(are)i(in)f(the)h(syn-)2026 3589 y(tax)j(and)f(semantics)h
(of)f(the)h(rules)g(themselv)o(es.)26 b(The)20 b(placements)2026
3688 y(of)27 b(dif)n(ferent)e(parts)j(of)f(the)g(system)g(within)g(the)
h(k)o(ernel)e(are)h(also)2026 3788 y(v)o(ery)17 b(dif)n(ferent.)48
b(Our)18 b(placement)g(aims)g(to)h(minimize)f(impact)g(on)2026
3888 y(the)g(k)o(ernel)g(code)g(by)g(placing)g(a)h Ft(wr)o(apper)f
Fs(around)f(k)o(ernel)g(system)2026 3987 y(call)27 b(handlers)e(while)i
(their)f(placement)f(tries)i(to)g(minimize)f(per)n(-)2026
4087 y(formance)f(impact.)46 b(Our)27 b(system)h(is)g(e)o(xtensible)e
(to)i(ne)n(wer)e(v)o(er)n(-)2026 4186 y(sions)31 b(of)g(the)h(k)o
(ernel)e(since)i(by)f(and)g(lar)o(ge)f(the)h(same)h(wrapper)2026
4286 y(should)19 b(w)o(ork)g(for)h(ne)n(wer)g(k)o(ernels.)2101
4386 y(The)k(Domain\226and\226T)-7 b(ype\226Enfo)o(rcem)o(ent)19
b(\(DTE\))24 b(based)g(sys-)2026 4485 y(tem)e(by)h(W)-7
b(alk)o(er)23 b Ft(et)g(al)g Fs([WSB)2918 4455 y Fq(+)2974
4485 y Fs(96)o(])f(groups)g(\002le)h(system)g(objects)2026
4585 y(into)33 b(sets)i(called)f Ft(types)g Fs(and)g(puts)f(a)i
(subject)e(\(an)h(e)o(x)o(ecutable\))2026 4685 y(into)f(a)h(domain)e
(which)g(has)i(speci\002c)g(access)f(rights)g(to)h(types.)2026
4784 y(It)29 b(does)g(not)g(pro)o(vide)f(protection)f(on)i
(non\226\002le\226system\226object)2026 4884 y(resources)c(and)h(seems)
h(to)g(incur)f(more)f(comple)o(xity)g(when)h(pro-)2026
4983 y(viding)19 b(\002ne\226granularity)e(control)i(than)g(BlueBox.)
2026 5159 y Fp(2.4)90 b(User)22 b(space)e(system)i(call)h(intr)n
(ospection)2101 5301 y Fs(A)18 b(v)n(alid)f(criticism)g(of)g(systems)h
(such)f(as)h(BlueBox)f(is)h(the)g(mod-)2026 5401 y(i\002cations)k(to)g
(the)f(k)o(ernel)g(required)g(to)h(install)g(the)g(infrastructure)2026
5501 y(to)28 b(install)g(and)g(enforce)e(process)i(beha)n(vior)e
(rules.)49 b(T)-7 b(o)28 b(circum-)2026 5600 y(v)o(ent)17
b(this,)h(one)f(approach)f(is)i(to)g(use)g(e)o(xisting)f(monitoring)e
(infras-)2026 5700 y(tructure)22 b(in)i(k)o(ernels)g(such)f(as)i
Fn(ptr)o(ace)f Fs(to)g(ha)n(v)o(e)f(monitors)g(which)p
eop
%%Page: 4 4
4 3 bop -112 458 a Fs(reside)23 b(in)g(user)n(\226space)g([W)-7
b(ag99)o(,)24 b(JS00)o(].)35 b(The)23 b(monitor)f(sits)j(in)f(a)-112
558 y(separate)k(process)h(and)g(intercepts)f(system)i(calls)g(made)e
(by)h(the)-112 657 y(monitored)c(process)h(using)h Fn(ptr)o(ace)p
Fs(;)k(the)c(monitor)f(process)h(can)-112 757 y(then)19
b(enforce)f(the)h(rules)h(by)f(e)o(xamining)e(the)j(intercepted)e
(system)-112 857 y(calls)26 b(and)f(their)h(parameters)e(and)i
(possibly)f(modifying)e(the)j(pa-)-112 956 y(rameters)j(or)i
(terminating)e(the)h(calls.)57 b(As)31 b(pointed)e(out)h(by)g(the)-112
1056 y(authors[JS00)m(],)22 b(this)h(approach)d(has)i(a)g(fe)n(w)g(dra)
o(wbacks.)29 b(Firstly)-5 b(,)-112 1155 y(since)24 b(rules)f(are)h
(enforced)e(in)i(the)g(conte)o(xt)f(of)g(the)h(monitor)e(pro-)-112
1255 y(cess,)j(there)e(is)i(some)f(o)o(v)o(erhead)d(due)j(to)g(conte)o
(xt)f(switching)g(and)-112 1355 y(cop)o(ying)35 b(data)i(from)f(one)h
(process')-5 b(s)37 b(conte)o(xt)f(to)i(the)f(other')-5
b(s.)-112 1454 y(Also,)35 b(there)c(are)h(cases)h(when)e(the)h
(monitored)e(process)i(is)h(not)-112 1554 y(entirely)21
b(under)h(the)h(control)e(of)i(the)g(monitor)e(due)h(to)h(the)g(imple-)
-112 1654 y(mentations)c(of)h(ptrace.)-112 1861 y Fu(3)99
b(BlueBox)33 b(P)n(olicy)f(Speci\002cation)i(and)f(Genera-)37
1977 y(tion)-37 2126 y Fs(Since)18 b(an)g(attack)h(on)f(a)h(system)f
(must)h(access)g(sensiti)n(v)o(e)f(system)-112 2225 y(resources)k(in)i
(unintended)d(w)o(ays)k(to)e(be)h(successful,)g(a)h(BlueBox)-112
2325 y(polic)o(y)15 b(de\002nes)i(and)f(enforces)f(rules)i(controlling)
e(a)i(process')-5 b(s)16 b(ac-)-112 2425 y(cess)h(to)h(system)f
(resources,)f(thus)h(thw)o(arting)f(unintended)f(access.)-112
2524 y(W)-7 b(e)24 b(cate)o(gorize)e(system)h(resources)f(and)h(the)g
(types)g(of)g(access)h(to)-112 2624 y(them)19 b(in)i(T)-7
b(able)20 b(1.)-37 2724 y(Features)g(of)g(our)f(current)g(rule)h
(speci\002cation)f(includes:)-29 2872 y Fr(\017)41 b
Fs(Access)20 b(permissions)g(to)g(\002le)h(system)f(objects.)-29
3029 y Fr(\017)41 b Fs(Access)20 b(to)h(the)f(\002le)h(system,)f(e.g.,)
f(mount,)g(unmount.)-29 3187 y Fr(\017)41 b Fs(Permitted)19
b Ft(uid)h Fs(and)g Ft(gid)g Fs(transitions.)-29 3344
y Fr(\017)41 b Fs(signals)23 b(which)f(can)h(be)g(sent,)g(recei)n(v)o
(ed,)f(block)o(ed,)g(ignored)54 3444 y(&)e(handled.)-29
3601 y Fr(\017)41 b Fs(Process)34 b(characteristics)g(such)g(as)g
(scheduling)f(priorities)54 3701 y(which)19 b(can)h(be)g(modi\002ed.)
-29 3858 y Fr(\017)41 b Fs(Elementary)25 b(controls)i(for)g(other)g
(system)h(resources)f(such)54 3957 y(as)22 b(IPC)f(objects,)g(sock)o
(ets)h(and)f Fn(ioctl)h Fs(calls.)29 b(This)21 b(is)h(an)g(area)54
4057 y(requires)d(more)g(study)h(for)f(more)h(comprehensi)n(v)o(e)d
(rules.)-37 4206 y(T)-7 b(o)23 b(mak)o(e)g(the)g(polic)o(y)f
(speci\002cation)g(e)o(xpressi)n(v)o(e,)g(we)h(pro)o(vide)-112
4305 y(an)31 b Ft(allowed)g(system)h(calls)g(list)h Fs(as)f(a)g
(coarser)e(le)n(v)o(el)h(of)h(control)-112 4405 y(that)e(is)i(ef)n
(fecti)n(v)o(e)d(in)i(thw)o(arting)f(a)h(number)d(of)j(attacks.)56
b(Since)-112 4504 y(system)30 b(resources)e(must)i(be)g(accessed)g
(through)e(system)i(calls,)-112 4604 y(disallo)n(wing)16
b(in)m(v)n(ocations)f(of)i(a)g(system)h(call)f(disallo)n(ws)g(access)h
(to)-112 4704 y(resources.)38 b(F)o(or)25 b(instance,)h(most)f(serv)o
(er)g(processes)g(don')o(t)e(need)-112 4803 y(to)18 b(mount)f(or)h
(unmount)e(\002le)j(systems,)g(so)g Fn(mount)h Fs(and)e
Fn(unmount)-112 4903 y Fs(are)f(not)g(in)h(their)f(allo)n(wed)g(lists)i
(and)e(an)h(in)m(v)n(ocation)d(of)i(either)h(will)-112
5003 y(be)32 b(considered)f(an)h(intrusion)f(re)o(gardless)g(of)h(the)h
(in)m(v)n(ocation')-5 b(s)-112 5102 y(parameters.)40
b(W)-7 b(e)26 b(ha)n(v)o(e)g(identi\002ed)e(72)i Ft(harmless)g
Fs(system)g(calls;)-112 5202 y(each)c(of)h(which)g(either)g(has)h(no)e
(security)h(implications)f(or)h(is)i(not)-112 5301 y(supported)15
b(by)j(the)g(Linux)e(2.2.14)g(k)o(ernel.)24 b(These)17
b(calls)i(are)f(listed)-112 5401 y(in)i(Appendix)39 b(A.)-37
5501 y(The)17 b(polic)o(y)f(for)g(a)i(program)d(can)i(also)h(be)f(mark)
o(ed)f Ft(inheritable)p Fs(:)-112 5600 y(this)24 b(is)g(useful)f(for)g
(a)h(script)g(where)e(each)i(program)d(e)o(x)o(ecuted)h(by)-112
5700 y(the)e(script)g(can)g(share)g(the)g(script')-5
b(s)21 b(polic)o(y)-5 b(.)2101 458 y(Based)26 b(on)f(our)f(e)o
(xperience,)h(for)f(a)i(gi)n(v)o(en)e(program)g(there)h(are)2026
558 y(se)n(v)o(eral)i(mechanisms)g(and)h(tools)g(one)f(could)g(use)h
(to)h(b)n(uild)e(and)2026 657 y(specify)19 b(the)h(rules.)2109
826 y Fr(\017)41 b Fs(Intended)19 b(Semantics:)27 b(The)21
b(most)g(comprehensi)n(v)o(e)d(w)o(ay)j(to)2192 926 y(generate)f(the)i
(correct)f(rules)h(for)f(a)h(program)e(is)j(by)e(looking)2192
1025 y(through)15 b(the)j(intended)e(semantics)i(of)f(the)h(program.)k
(While)2192 1125 y(this)27 b(can)g(be)g(daunting)e(for)h(big)g(serv)o
(ers)h(such)f(as)i(Apache,)2192 1225 y(we)c(ha)n(v)o(e)g(found)e(that)j
(for)e(se)n(v)o(eral)h(cgi\226bin)f(scripts,)i(this)g(is)2192
1324 y(the)17 b(easiest)h(w)o(ay)g(to)f(capture)f(rules)i(since)f
(these)h(scripts)f(typ-)2192 1424 y(ically)j(access)h(fe)n(w)f
(resources.)2109 1596 y Fr(\017)41 b Fs(Con\002guration:)25
b(F)o(or)c(serv)o(ers)f(such)h(as)h(Apache)e(which)h(can)2192
1695 y(be)26 b(con\002gured)f(to)i(run)f(in)h(dif)n(ferent)e(w)o(ays,)j
(con\002guration)2192 1795 y(\002les)g(need)f(to)h(be)f(used)g
(\(either)g(manually)f(or)h(automated\))2192 1894 y(to)20
b(create)g(rules.)2109 2066 y Fr(\017)41 b Fs(Audit)33
b(T)m(rails:)51 b(A)34 b(v)o(ery)e(straightforw)o(ard)f(mechanism)g(to)
2192 2166 y(generate)18 b(lar)o(ge)h(chunks)g(of)h(the)g(rules)g(is)h
(to)f(inspect)f(system)2192 2265 y(call)27 b(audit)g(trails.)46
b(F)o(or)26 b(a)i(number)d(of)h(serv)o(ers)h(and)f(scripts)2192
2365 y(we)20 b(ha)n(v)o(e)g(found)e(this)j(to)f(be)h(the)f(simplest)g
(method.)2109 2537 y Fr(\017)41 b Fs(Existing)d(T)-6
b(emplates:)61 b(F)o(or)38 b(lar)o(ge)g(and)f(popular)g(serv)o(ers)2192
2636 y(such)30 b(as)h(the)f(Apache)g(httpd,)i(we)e(en)m(vision)f(e)o
(xisting)h(rule)2192 2736 y(templates)e(which)g(can)g(automatically)f
(be)h(customized)f(to)2192 2835 y(ne)n(w)c(installations.)33
b(Our)22 b(reference)g(serv)o(er)g(is)h(the)g(Apache)2192
2935 y(httpd)29 b(for)h(which)g(we)g(ha)n(v)o(e)g(de)n(v)o(eloped)e(a)j
(template.)54 b(W)-7 b(e)2192 3035 y(are)16 b(currently)e(in)m(v)o
(estigating)g(rule)h(templates)h(for)f(lar)o(ger)g(ap-)2192
3134 y(plication)30 b(serv)o(ers)g(and)h(hope)f(to)h(include)f(rule)h
(templates)2192 3234 y(for)k(the)h(most)g(common)f(con\002gurations)e
(of)j(application)2192 3334 y(serv)o(ers)19 b(such)h(as)h(the)f(IBM)h
(W)-7 b(ebSphere[WEB01)n(].)2101 3502 y(While)30 b(these)h(mechanisms)e
(sound)g(daunting)f(for)h(nontri)n(vial)2026 3602 y(programs,)e(as)i
(we)f(discuss)g(in)g(section)g(5,)i(we)e(belie)n(v)o(e)f(that)h(the)
2026 3702 y(amount)21 b(of)i(e)o(xtra)f(w)o(ork)g(is)i(manageable.)31
b(F)o(or)23 b(our)f(prototypical)2026 3801 y(application)30
b(of)h(web)h(serv)o(ers,)i(most)d(of)h(the)f(rules)h(need)f(to)h(be)
2026 3901 y(done)19 b(once,)g(with)i(little)g(customization)d(for)i(ne)
n(w)g(serv)o(ers.)2026 4120 y Fu(4)99 b(T)-9 b(echnical)26
b(details)2101 4280 y Fs(In)e(this)i(section)e(we)h(will)h(\002rst)f
(discuss)g(the)g(BlueBox)f(system)2026 4380 y(architecture)c(to)j(sho)n
(w)f(ho)n(w)f(a)i(polic)o(y)e(is)i(de\002ned)e(and)h(enforced,)2026
4479 y(then)17 b(we)g(discuss)h(polic)o(y)e(speci\002cation)h(in)g
(details)h(and)e(conclude)2026 4579 y(with)k(a)h(discussion)e(of)h
(BlueBox')-5 b(s)21 b(impact)e(on)h(the)g(k)o(ernel.)2026
4773 y Fp(4.1)90 b(System)22 b(Ar)n(chitectur)n(e)2101
4933 y Fs(The)k(BlueBox)g(system)g(architecture)e(is)k(sho)n(wn)d(in)h
(Figure)g(1.)2026 5033 y(The)20 b(architecture)e(includes)i(tw)o(o)g
(parts)g(:)2026 5202 y Fo(P)n(olicy)g(Speci\002cation)f(and)i(P)o
(arsing)41 b Fs(A)d(BlueBox)g(polic)o(y)e(for)2192 5301
y(an)49 b(e)o(x)o(ecutable)f(program)g(is)i(speci\002ed)g(in)f(a)i
(human\226)2192 5401 y(readable)20 b(form)g(using)h(a)h(te)o(xt)g
(editor)e(and)h(then)g(parsed)g(into)2192 5501 y(a)29
b(binary)e(\002le)h(by)g(a)h(parser)f(program.)47 b(This)28
b(part)g(is)i(done)2192 5600 y(of)n(f\226line)24 b(and)i(before)f(the)h
(program)e(is)j(e)o(x)o(ecuted.)41 b(Details)2192 5700
y(are)20 b(in)g(Section)g(4.2.)p eop
%%Page: 5 5
5 4 bop -63 445 a Fo(r)o(esour)o(ces)1094 b(types)20
b(of)g(access)p -63 498 4088 24 v -63 658 a Fs(File)h(system)g(objects)
791 b(create,)20 b(open,)f(read,)g(write,)h Ft(e)n(xecute)p
Fs(,)g Ft(r)m(emo)o(val)p Fs(,)1366 758 y Ft(link\226to)p
Fs(,)f Ft(c)o(hang)o(e)g(of)h(access)h(permissions)p
Fs(,)1366 857 y Ft(c)o(hang)o(e)e(of)h(owner)o(ship)-63
957 y Fs(File)h(systems)1016 b(mount,)19 b(unmount,)f(types)i(of)g
(mount)-63 1056 y(Identities)1119 b(acquire,)19 b(release,)h(inherit)
-63 1156 y(Processes)h(\(address)e(spaces,)h(signals,)h
Fr(\001)14 b(\001)g(\001)o Fs(\))133 b(read,)20 b(write,)g(deli)n(v)o
(er)-63 1256 y(CPU)i(c)o(ycles,)d(process)h(scheduling)f(priority)97
b(raise)-63 1355 y(System)21 b(clock)982 b(set,)21 b(read)-63
1455 y(System/k)o(ernel)e(memory)655 b(read,)20 b(write)-63
1555 y(IPC)h(objects)f(:)26 b(pipes,)20 b(semaphores,)342
b(create,)20 b(open)f(\(attach\),)g(read,)g(write)-42
1654 y(message)h(queues,)f(shared)h(memory)-5 b(,)17
b Fm(:)d(:)g(:)-63 1754 y Fs(De)n(vices,)20 b(netw)o(ork)849
b(create/attach,)19 b(open,)g(read,)h(write,)g Ft(io\226contr)l(ol)p
Fs(,)1366 1853 y Ft(r)m(emo)o(val)p Fs(,)g Ft(link\226to)p
Fs(,)f Ft(c)o(hang)o(e)f(of)j(access)f(permissions)p
Fs(,)1366 1953 y Ft(c)o(hang)o(e)f(of)h(owner)o(ship)-63
2053 y Fs(Pri)n(vile)o(ges)1099 b(acquire,)19 b(release,)h(raise,)g(lo)
n(wer)p -63 2206 V 1228 2487 a(T)-7 b(able)20 b(1.)g
Fn(types)i(of)i(resources)d(and)j(access)-112 2753 y
Fo(P)n(olicy)19 b(Loading)h(and)h(Enf)n(or)o(cement)40
b Fs(Since)53 b(BlueBox)g(poli-)54 2853 y(cies)28 b(are)g(meant)g(to)g
(control)f(access)i(to)f(system)g(resources)54 2953 y(which)22
b(can)g(only)g(be)g(accessed)h(through)d(system)j(calls,)g(the)54
3052 y(natural)18 b(place)h(for)g(rule)g(enforcement)e(is)j(at)g(the)f
(k)o(ernel)g(sys-)54 3152 y(tem)27 b(call)g(entry)g(point.)45
b(Our)27 b(prototype)d(on)j(Linux)f(2.2.14)54 3252 y(places)k(an)h
Ft(enfor)m(cer)g Fs(module)e(at)j(the)f(k)o(ernel)f(system)h(call)54
3351 y(entry)19 b(point)h(to)g(enforce)f(rules.)26 b(The)20
b(enforcer)e(has)j(b)n(uilt\226in)54 3451 y(kno)n(wledge)k(of)j(what)g
(cate)o(gories)f(of)h(resources)f(each)h(call)54 3550
y(may)e(access)h(so)g(it)g(can)f(check)g(the)g(parameters)g(of)g(the)h
(in-)54 3650 y(v)n(ok)o(ed)19 b(system)h(call)h(against)e(the)h(rules.)
54 3802 y(Since)34 b(it)h(is)g(impractical)e(to)h(write)g(policies)g
(for)g(all)g(pro-)54 3902 y(cesses)e(on)f(a)g(system,)j(we)e(added)e(a)
i(ne)n(w)f(system)g(call)h(to)54 4001 y(mark)c(a)i(process)f(as)h
(being)e Ft(monitor)m(ed)g Fs(;)35 b(this)30 b(status)g(will)54
4101 y(be)23 b(passed)g(on)g(to)g(its)h(children)e(and)h(cannot)f(be)h
(unmark)o(ed.)54 4201 y(As)j(a)g(tool,)h(we)f(ha)n(v)o(e)g(a)g(simple)g
(wrapper)e(program)g(which)54 4300 y(marks)j(itself)h(as)h(monitored)c
(and)j(then)f Fn(e)n(x)n(ecv)n(e)p Fs(s)g(the)g(real)54
4400 y(program)h(to)j(pass)g(on)f(the)h Ft(monitor)m(ed)e
Fs(status)i(to)g(the)g(ne)n(w)54 4499 y(process)16 b(image.)23
b(When)17 b(loading)e(the)i(ne)n(w)f(image)h(the)g(mod-)54
4599 y(i\002ed)i Fn(e)n(x)n(ecv)n(e)f Fs(system)i(call)f(handler)1156
4569 y Fl(1)1210 4599 y Fs(loads)g(the)g(rules)h(into)54
4699 y(the)25 b(k)o(ernel)f(and)h(starts)h(enforcement.)37
b(If)25 b(no)g(rules)g(for)f(the)54 4798 y(ne)n(w)g(image)h(are)g
(found,)f(then)g(the)h(process)g(will)h(try)e(to)i(in-)54
4898 y(herit)16 b(and)g(share)g(the)g(rules)g(of)g(the)h(old)f(image;)h
(if)g(these)f(rules)54 4998 y(are)f(not)h(inheritable)e(or)h(do)h(not)f
(e)o(xist,)h(then)g(the)f(process)h(will)54 5097 y(be)25
b Ft(crippled)p Fs(;)h(i.e.,)g(it)g(is)g(only)e(allo)n(wed)h(to)g(mak)o
(e)g(harmless)54 5197 y(system)20 b(calls.)54 5349 y(Rules)28
b(are)f Ft(r)m(ead\226only)f Fs(after)h(being)g(loaded.)45
b(Each)27 b(moni-)54 5448 y(tored)22 b(process)h(is)h(allocated)f(a)h
(k)o(ernel)e(memory)g(b)n(uf)n(fer)1717 5418 y Fl(2)1772
5448 y Fs(to)p -112 5540 780 4 v -22 5595 a Fk(1)7 5619
y Fj(The)17 b(API)g(for)g Fi(e)n(x)n(ecv)n(e)g Fj(is)g(not)g(changed.)
-22 5677 y Fk(2)7 5700 y Fj(At)g(present,)h(the)g(size)g(of)f(the)g(b)o
(uf)n(fer)h(is)f(one)h(page)g(or)f Fh(4)p Fg(K)k Fj(bytes.)2192
2753 y Fs(hold)31 b(its)i(pri)n(v)n(ate)e(BlueBox)h(state)h(which)e
(can)h(change)f(as)2192 2853 y(the)h(process)g(e)o(x)o(ecutes.)59
b(More)32 b(discussion)f(on)h(BlueBox)2192 2953 y(process)22
b(state)i(is)g(gi)n(v)o(en)e(in)h(Section)g(4.3.)33 b(When)23
b(a)g(process)2192 3052 y Fn(f)n(or)q(k)p Fs(s,)h(the)g(child)f
(process)g(shares)h(the)f(parent')-5 b(s)23 b(polic)o(y)g(b)n(ut)2192
3152 y(will)g(be)f(gi)n(v)o(en)f(a)h(cop)o(y)f(of)h(the)g(parent')-5
b(s)22 b(BlueBox)g(state.)31 b(A)2192 3252 y(process')-5
b(s)18 b(BlueBox)h(state)g(will)g(be)g(reset)g(when)e(it)j
Fn(e)n(x)n(ecv)n(e)p Fs(s)2192 3351 y(a)g(program.)2026
3548 y Fp(4.2)90 b(Rules)22 b(f)n(or)g(Differ)n(ent)i(T)-7
b(ypes)21 b(of)i(Resour)n(ces)2101 3712 y Fs(In)c(this)i(section)e(we)h
(will)h(discuss)f(rules)f(for)h(three)f(types)g(of)h(re-)2026
3812 y(sources,)28 b(namely)f(\002le)h(system)g(objects,)h(uid/gid)d
(lists)j(and)e(sig-)2026 3912 y(nals;)40 b(each)34 b(has)g(particular)e
(syntax)h(and)g(semantics.)65 b(W)-7 b(e)35 b(be-)2026
4011 y(lie)n(v)o(e)17 b(the)h(syntax)e(and)h(semantics)h(discussed)f
(here)g(can)h(represent)2026 4111 y(most,)i(if)g(not)g(all,)h(of)f
(BlueBox)f(rules.)2026 4346 y Fo(4.2.1)81 b(Rules)21
b(f)n(or)f(File)g(System)g(Objects)2026 4504 y Fs(Rules)29
b(on)g(\002le)g(system)g(objects)g(are)f(encoded)f(as)j(a)f(tree)g
(which)2026 4604 y(mimics)15 b(the)h(hierarchy)d(of)i(\002les)i(on)e(a)
g(UNIX)h(system.)24 b(The)15 b(polic)o(y)2026 4704 y(of)g(a)h(program)e
(includes)h(one)g(such)g(tree)h(encoding)e(the)h(program')-5
b(s)2026 4803 y(access)17 b(rights)e(to)i(\002le)g(system)f(objects.)23
b(Figure)16 b(2)g(sho)n(ws)g(a)h(part)f(of)2026 4903
y(the)21 b(speci\002cation)f(of)g(rules)h(on)f(\002le)i(system)f
(objects)f(for)g(Apache)2026 5003 y(2.0)f(HTTP)i(Serv)o(er)-5
b(.)2101 5102 y(Each)25 b(node)g(in)i(the)f(tree)g(records)f(access)h
(rights)g(to)g(a)h(\(set)f(of\))2026 5202 y(\002le)d(system)g
(object\(s\).)31 b(The)22 b(root)g(of)g(a)h(tree)g(corresponds)d(to)j
(the)2026 5301 y(root)16 b(of)g(the)h(hierarchy)d(of)j(\002les.)25
b(Lik)o(e)16 b(a)h(UNIX)g(\002le)h(system,)f(each)2026
5401 y(node)29 b(has)h(a)g(name.)54 b(Unlik)o(e)29 b(a)h(UNIX)g(\002le)
h(system,)h(the)e(name)2026 5501 y(can)g(contain)f(UNIX)h(shell\226lik)
o(e)g Ft(wildcar)m(d)f Fs(characters)h('*')f(and)2026
5600 y('?')43 b(with)27 b(the)g(same)f(interpretation)f(as)i(in)f(a)h
(UNIX)g(shell.)44 b(The)2026 5700 y(only)20 b(e)o(xception)f(is)i(that)
g(a)h(leaf)e(node)g(with)h(the)g(name)f(\223)p Fr(\003)p
Fs(\224)h(repre-)p eop
%%Page: 6 6
6 5 bop 761 2147 a @beginspecial 0 @llx 0 @lly 741 @urx
561 @ury 2808 @rwi @setspecial
%%BeginDocument: fig/arch.ps
%!PS-Adobe-2.0 EPSF-2.0
%%Title: fig/arch.fig
%%Creator: fig2dev Version 3.2 Patchlevel 1
%%CreationDate: Fri Aug 24 14:22:24 2001
%%For: pau@netsec03 (Pau-Chen Cheng)
%%Orientation: Portrait
%%BoundingBox: 0 0 741 561
%%Pages: 0
%%BeginSetup
%%EndSetup
%%Magnification: 1.0000
%%EndComments
/$F2psDict 200 dict def
$F2psDict begin
$F2psDict /mtrx matrix put
/col-1 {0 setgray} bind def
/col0 {0.000 0.000 0.000 srgb} bind def
/col1 {0.000 0.000 1.000 srgb} bind def
/col2 {0.000 1.000 0.000 srgb} bind def
/col3 {0.000 1.000 1.000 srgb} bind def
/col4 {1.000 0.000 0.000 srgb} bind def
/col5 {1.000 0.000 1.000 srgb} bind def
/col6 {1.000 1.000 0.000 srgb} bind def
/col7 {1.000 1.000 1.000 srgb} bind def
/col8 {0.000 0.000 0.560 srgb} bind def
/col9 {0.000 0.000 0.690 srgb} bind def
/col10 {0.000 0.000 0.820 srgb} bind def
/col11 {0.530 0.810 1.000 srgb} bind def
/col12 {0.000 0.560 0.000 srgb} bind def
/col13 {0.000 0.690 0.000 srgb} bind def
/col14 {0.000 0.820 0.000 srgb} bind def
/col15 {0.000 0.560 0.560 srgb} bind def
/col16 {0.000 0.690 0.690 srgb} bind def
/col17 {0.000 0.820 0.820 srgb} bind def
/col18 {0.560 0.000 0.000 srgb} bind def
/col19 {0.690 0.000 0.000 srgb} bind def
/col20 {0.820 0.000 0.000 srgb} bind def
/col21 {0.560 0.000 0.560 srgb} bind def
/col22 {0.690 0.000 0.690 srgb} bind def
/col23 {0.820 0.000 0.820 srgb} bind def
/col24 {0.500 0.190 0.000 srgb} bind def
/col25 {0.630 0.250 0.000 srgb} bind def
/col26 {0.750 0.380 0.000 srgb} bind def
/col27 {1.000 0.500 0.500 srgb} bind def
/col28 {1.000 0.630 0.630 srgb} bind def
/col29 {1.000 0.750 0.750 srgb} bind def
/col30 {1.000 0.880 0.880 srgb} bind def
/col31 {1.000 0.840 0.000 srgb} bind def

end
save
-21.0 573.0 translate
1 -1 scale

/cp {closepath} bind def
/ef {eofill} bind def
/gr {grestore} bind def
/gs {gsave} bind def
/sa {save} bind def
/rs {restore} bind def
/l {lineto} bind def
/m {moveto} bind def
/rm {rmoveto} bind def
/n {newpath} bind def
/s {stroke} bind def
/sh {show} bind def
/slc {setlinecap} bind def
/slj {setlinejoin} bind def
/slw {setlinewidth} bind def
/srgb {setrgbcolor} bind def
/rot {rotate} bind def
/sc {scale} bind def
/sd {setdash} bind def
/ff {findfont} bind def
/sf {setfont} bind def
/scf {scalefont} bind def
/sw {stringwidth} bind def
/tr {translate} bind def
/tnt {dup dup currentrgbcolor
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add srgb}
  bind def
/shd {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
  4 -2 roll mul srgb} bind def
/reencdict 12 dict def /ReEncode { reencdict begin
/newcodesandnames exch def /newfontname exch def /basefontname exch def
/basefontdict basefontname findfont def /newfont basefontdict maxlength dict def
basefontdict { exch dup /FID ne { dup /Encoding eq
{ exch dup length array copy newfont 3 1 roll put }
{ exch newfont 3 1 roll put } ifelse } { pop pop } ifelse } forall
newfont /FontName newfontname put newcodesandnames aload pop
128 1 255 { newfont /Encoding get exch /.notdef put } for
newcodesandnames length 2 idiv { newfont /Encoding get 3 1 roll put } repeat
newfontname newfont definefont pop end } def
/isovec [
8#200 /grave 8#201 /acute 8#202 /circumflex 8#203 /tilde
8#204 /macron 8#205 /breve 8#206 /dotaccent 8#207 /dieresis
8#210 /ring 8#211 /cedilla 8#212 /hungarumlaut 8#213 /ogonek 8#214 /caron
8#220 /dotlessi 8#230 /oe 8#231 /OE
8#240 /space 8#241 /exclamdown 8#242 /cent 8#243 /sterling
8#244 /currency 8#245 /yen 8#246 /brokenbar 8#247 /section 8#250 /dieresis
8#251 /copyright 8#252 /ordfeminine 8#253 /guillemotleft 8#254 /logicalnot
8#255 /endash 8#256 /registered 8#257 /macron 8#260 /degree 8#261 /plusminus
8#262 /twosuperior 8#263 /threesuperior 8#264 /acute 8#265 /mu 8#266 /paragraph
8#267 /periodcentered 8#270 /cedilla 8#271 /onesuperior 8#272 /ordmasculine
8#273 /guillemotright 8#274 /onequarter 8#275 /onehalf
8#276 /threequarters 8#277 /questiondown 8#300 /Agrave 8#301 /Aacute
8#302 /Acircumflex 8#303 /Atilde 8#304 /Adieresis 8#305 /Aring
8#306 /AE 8#307 /Ccedilla 8#310 /Egrave 8#311 /Eacute
8#312 /Ecircumflex 8#313 /Edieresis 8#314 /Igrave 8#315 /Iacute
8#316 /Icircumflex 8#317 /Idieresis 8#320 /Eth 8#321 /Ntilde 8#322 /Ograve
8#323 /Oacute 8#324 /Ocircumflex 8#325 /Otilde 8#326 /Odieresis 8#327 /multiply
8#330 /Oslash 8#331 /Ugrave 8#332 /Uacute 8#333 /Ucircumflex
8#334 /Udieresis 8#335 /Yacute 8#336 /Thorn 8#337 /germandbls 8#340 /agrave
8#341 /aacute 8#342 /acircumflex 8#343 /atilde 8#344 /adieresis 8#345 /aring
8#346 /ae 8#347 /ccedilla 8#350 /egrave 8#351 /eacute
8#352 /ecircumflex 8#353 /edieresis 8#354 /igrave 8#355 /iacute
8#356 /icircumflex 8#357 /idieresis 8#360 /eth 8#361 /ntilde 8#362 /ograve
8#363 /oacute 8#364 /ocircumflex 8#365 /otilde 8#366 /odieresis 8#367 /divide
8#370 /oslash 8#371 /ugrave 8#372 /uacute 8#373 /ucircumflex
8#374 /udieresis 8#375 /yacute 8#376 /thorn 8#377 /ydieresis] def
/Helvetica-BoldOblique /Helvetica-BoldOblique-iso isovec ReEncode
/Times-BoldItalic /Times-BoldItalic-iso isovec ReEncode
/Helvetica-Bold /Helvetica-Bold-iso isovec ReEncode
/Times-Roman /Times-Roman-iso isovec ReEncode
/Times-Italic /Times-Italic-iso isovec ReEncode
 /DrawEllipse {
	/endangle exch def
	/startangle exch def
	/yrad exch def
	/xrad exch def
	/y exch def
	/x exch def
	/savematrix mtrx currentmatrix def
	x y tr xrad yrad sc 0 0 1 startangle endangle arc
	closepath
	savematrix setmatrix
	} def

/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def
%%EndProlog

$F2psBegin
10 setmiterlimit
n -1000 10537 m -1000 -1000 l 13687 -1000 l 13687 10537 l cp clip
 0.06000 0.06000 sc
% Polyline
15.000 slw
n 8550 6150 m 11250 6150 l 11250 8400 l 8550 8400 l cp gs col7 1.00 shd ef gr gs col-1 s gr 
% Ellipse
n 9900 6120 1350 270 0 360 DrawEllipse gs col7 1.00 shd ef gr gs col0 s gr

% Ellipse
n 9903 8366 1350 270 0 360 DrawEllipse gs col7 1.00 shd ef gr gs col0 s gr

/Times-BoldItalic-iso ff 300.00 scf sf
1500 8025 m
gs 1 -1 sc (System Call) col0 sh gr
/Times-BoldItalic-iso ff 300.00 scf sf
1500 8370 m
gs 1 -1 sc (Handler) col0 sh gr
% Polyline
n 1305 7575 m 1200 7575 1200 8595 105 arcto 4 {pop} repeat
  1200 8700 3270 8700 105 arcto 4 {pop} repeat
  3375 8700 3375 7680 105 arcto 4 {pop} repeat
  3375 7575 1305 7575 105 arcto 4 {pop} repeat
 cp gs col0 s gr 
/Times-Italic-iso ff 270.00 scf sf
5475 8124 m
gs 1 -1 sc (loaded into the) col0 sh gr
/Times-Italic-iso ff 270.00 scf sf
5475 8460 m
gs 1 -1 sc (kernel when execve) col0 sh gr
7.500 slw
% Ellipse
n 2250 3150 825 1425 0 360 DrawEllipse gs col0 s gr

% Polyline
15.000 slw
n 8550 1650 m 11400 1650 l 11400 2550 l 8550 2550 l cp gs col0 s gr 
% Polyline
n 9255 3375 m 9150 3375 9150 4470 105 arcto 4 {pop} repeat
  9150 4575 10470 4575 105 arcto 4 {pop} repeat
  10575 4575 10575 3480 105 arcto 4 {pop} repeat
  10575 3375 9255 3375 105 arcto 4 {pop} repeat
 cp gs col0 s gr 
% Polyline
7.500 slw
n 375 5025 m 12675 5025 l gs col0 s gr 
% Polyline
15.000 slw
n 8850 6825 m 11025 6825 l 11025 7800 l 8850 7800 l cp gs col0 s gr 
% Polyline
n 2175 5925 m 1200 4800 l 1200 975 l 3300 975 l 3300 4800 l 2100 5925 l
 cp gs col9 s gr 
% Polyline
n 1380 5925 m 1275 5925 1275 6645 105 arcto 4 {pop} repeat
  1275 6750 3270 6750 105 arcto 4 {pop} repeat
  3375 6750 3375 6030 105 arcto 4 {pop} repeat
  3375 5925 1380 5925 105 arcto 4 {pop} repeat
 cp gs col9 s gr 
% Polyline
n 4425 6000 m 6450 6000 l 6450 7050 l 4425 7050 l cp gs col9 s gr 
% Polyline
7.500 slw
gs  clippath
2205 7431 m 2175 7575 l 2145 7431 l 2145 7590 l 2205 7590 l cp
clip
n 2175 6750 m 2175 7575 l gs col0 s gr gr

% arrowhead
n 2205 7431 m 2175 7575 l 2145 7431 l 2175 7455 l 2205 7431 l  cp gs 0.00 setgray ef gr  col0 s
% Polyline
gs  clippath
9855 3231 m 9825 3375 l 9795 3231 l 9795 3390 l 9855 3390 l cp
clip
n 9825 2550 m 9825 3375 l gs col0 s gr gr

% arrowhead
n 9855 3231 m 9825 3375 l 9795 3231 l 9825 3255 l 9855 3231 l  cp gs 0.00 setgray ef gr  col0 s
% Polyline
gs  clippath
9855 6681 m 9825 6825 l 9795 6681 l 9795 6840 l 9855 6840 l cp
clip
n 9825 4575 m 9825 6825 l gs col0 s gr gr

% arrowhead
n 9855 6681 m 9825 6825 l 9795 6681 l 9825 6705 l 9855 6681 l  cp gs 0.00 setgray ef gr  col0 s
% Polyline
 [15 45] 45 sd
n 7350 225 m 7350 9525 l gs col0 s gr  [] 0 sd
% Polyline
15.000 slw
gs  clippath
3544 6345 m 3400 6300 l 3544 6255 l 3345 6255 l 3345 6345 l cp
clip
n 3375 6300 m 4425 6300 l gs col9 s gr gr

% arrowhead
n 3544 6345 m 3400 6300 l 3544 6255 l 3520 6300 l 3544 6345 l  cp gs col9 1.00 shd ef gr  col9 s
% Polyline
7.500 slw
 [60] 0 sd
gs  clippath
6504 6670 m 6375 6600 l 6522 6613 l 6369 6567 l 6352 6624 l cp
clip
n 8850 7350 m 6375 6600 l gs col0 s gr gr
 [] 0 sd
% arrowhead
n 6504 6670 m 6375 6600 l 6522 6613 l 6490 6635 l 6504 6670 l  cp gs 0.00 setgray ef gr  col0 s
% Polyline
 [45 20 15 15 15 20] 0 sd
gs  clippath
7179 7053 m 7275 6975 l 7227 7089 l 7308 6981 l 7260 6945 l cp
clip
n 6450 7875 m 6750 7500 l 6825 7575 l 7275 6975 l gs col0 s gr gr
 [] 0 sd
% arrowhead
n 7179 7053 m 7275 6975 l 7227 7089 l  col0 s
/Helvetica-BoldOblique-iso ff 300.00 scf sf
1725 3225 m
gs 1 -1 sc (Process) col0 sh gr
/Times-BoldItalic-iso ff 300.00 scf sf
1425 6375 m
gs 1 -1 sc (Rule Enforcer) col9 sh gr
/Helvetica-Bold-iso ff 300.00 scf sf
4575 6375 m
gs 1 -1 sc (Binary Rule) col9 sh gr
/Helvetica-Bold-iso ff 300.00 scf sf
4575 6750 m
gs 1 -1 sc (in Kernel) col9 sh gr
/Helvetica-Bold-iso ff 300.00 scf sf
9075 7200 m
gs 1 -1 sc (Binary Rule) col9 sh gr
/Helvetica-Bold-iso ff 300.00 scf sf
9075 7575 m
gs 1 -1 sc (File) col9 sh gr
/Helvetica-Bold-iso ff 300.00 scf sf
9375 3825 m
gs 1 -1 sc (Rule) col9 sh gr
/Helvetica-Bold-iso ff 300.00 scf sf
9375 4200 m
gs 1 -1 sc (Parser) col9 sh gr
/Helvetica-Bold-iso ff 300.00 scf sf
8775 2025 m
gs 1 -1 sc (Human-readable) col9 sh gr
/Helvetica-Bold-iso ff 300.00 scf sf
8775 2400 m
gs 1 -1 sc (Rules) col9 sh gr
/Times-Roman-iso ff 330.00 scf sf
7725 825 m
gs 1 -1 sc (Off-Line) col0 sh gr
/Times-Italic-iso ff 300.00 scf sf
11400 5400 m
gs 1 -1 sc (kernel) col0 sh gr
/Times-Italic-iso ff 300.00 scf sf
11400 4875 m
gs 1 -1 sc (User) col0 sh gr
/Times-Roman-iso ff 330.00 scf sf
5775 825 m
gs 1 -1 sc (On-Line) col0 sh gr
$F2psEnd
rs

%%EndDocument
 @endspecial 1385 2329 a Fs(Figure)19 b(1.)h Fn(BlueBo)n(x)k
(Architecture)-112 2596 y Fs(sents)18 b(an)f(entire)g(subtree;)h(for)e
(e)o(xample,)h(\223)p Fm(=a=b=)p Fr(\003)p Fs(\224)e(matches)i(an)o(y)
-112 2696 y(\002le)h(in)g(the)g(subtree)f(under)f(\223)p
Fm(=a=b=)p Fs(\224.)23 b(Limited)17 b(support)g(for)g(char)n(-)-112
2796 y(acter)k(classes)h(\(e.g.,)f Ff([)p Fm(abc)p Ff(])p
Fs(\))g(is)i(also)f(pro)o(vided)1256 2765 y Fl(3)1286
2796 y Fs(.)29 b(A)22 b(node')-5 b(s)21 b(name)-112 2895
y(can)h(also)i(contain)d(en)m(vironment)f(v)n(ariables)j(and)f(these)h
(are)g(e)n(v)n(al-)-112 2995 y(uated)f(when)h(the)g(polic)o(y)f(is)i
(being)e(loaded)g(into)h(the)h(k)o(ernel.)33 b(F)o(or)-112
3094 y(e)o(xample,)17 b(if)h(a)h(rule)f(is)h(\223)p Fm(=home=)p
Ff($)p Fr(f)p Fm(U)9 b(S)c(E)g(R)q Fr(g)p Fm(=pub=)11
b Fr(\003)g Fm(:html)33 b(r)r Fs(\224)-112 3194 y(and)17
b(the)g(v)n(alue)h(of)f Fm(U)9 b(S)c(E)g(R)19 b Fs(is)f(\223joe\224,)g
(then)f(the)h(process)f(will)i(ha)n(v)o(e)-112 3294 y
Fe(read)27 b Fs(access)i(to)e(all)i(HTML)e(\002les)i(under)e
Fm(=home=j)5 b(oe=pub=)p Fs(.)-112 3393 y(When)18 b(a)i(process)f(mak)o
(es)g(a)g(system)g(call)h(to)f(access)h(a)f(\002le)h(system)-112
3493 y(object,)27 b(the)f(object')-5 b(s)26 b Ft(absolute)g
Fs(pathname)e(is)k(matched)d(against)-112 3593 y(the)17
b(tree.)24 b(If)17 b(a)g(path)g(in)g(the)g(tree)g(matches)g(the)g
(object')-5 b(s)17 b(pathname,)-112 3692 y(then)e(the)h(access)h
(rights)f(in)g(the)g(last)h(node)e(of)h(the)g(path)f(determines)-112
3792 y(if)20 b(this)h(in)m(v)n(ocation)d(of)i(the)g(system)g(call)h(is)
g(allo)n(wed.)-37 3891 y(Besides)98 b(the)f(usual)g Fe(read,)49
b(write,)f(execute,)-112 3991 y(create,)g(append)p Fs(,)21
b(access)i(rights)e(to)h(a)g(\002le)h(system)f(objects)-112
4091 y(also)66 b(include)g(:)119 b Fe(delete,)48 b(hard)h(link)g(to,)h
(soft)-112 4190 y(link)f(to,)g(shared)g(lock,)f(exclusive)h(lock,)-112
4290 y(truncate)p Fs(.)64 b(There)33 b(are)g(also)h(rights)f(related)h
(to)f(directories)-112 4390 y(used)c(as)i(\002le)g(system)f(mount)f
(points)g(:)45 b(\(a\))30 b Fe(mount)49 b(point)30 b
Fs(:)-112 4489 y(a)k(directory)e(can)i(be)g(a)g(mount)f(point,)j(\(b\))
d Fe(unmount)p Fs(:)52 b(a)35 b(\002le)-112 4589 y(system)g(mounted)f
(on)i(a)g(directory)e(can)h(be)h(unmounted;)41 b(and)-112
4688 y(rights)24 b(related)h(to)g(sw)o(apping)f(de)n(vices)g(\(c\))h
Fe(swapon)f Fs(:)36 b(a)25 b(de)n(vice)-112 4788 y(can)e(be)h(a)g(sw)o
(apping)f(de)n(vice,)g(\(d\))g Fe(swapoff)p Fs(:)32 b(a)24
b(de)n(vice)f(can)g(be)-112 4888 y(released)c(from)g(being)h(a)g(sw)o
(apping)f(de)n(vice.)-37 4987 y(A)25 b(node)g(in)g(the)h(tree)f(may)g
(also)g(be)h(associated)f(with)g(a)h(list)h(of)-112 5087
y(uid')-5 b(s)22 b(and)h(a)g(list)h(of)f(gid')-5 b(s)23
b(\(see)g(Section)f(4.2.2\).)31 b(These)23 b(lists)h(are)-112
5187 y(the)c(allo)n(wed)h Ft(ne)o(w)g Fs(user)f(and)h(group)e(o)n
(wnerships)g(for)i(\002le)g(system)-112 5286 y(objects)e(matching)g
(the)h(node.)p -112 5542 780 4 v -22 5598 a Fk(3)7 5621
y Fj(Character)j(ranges)f(\(e.g.,)f Fh([)p Fg(a)p Fj(-)p
Fg(h)p Fh(])p Fj(\))e(and)j(the)f(character)i(')e Fh(])e
Fj(')i(are)g(not)g(allo)n(wed)-112 5700 y(in)c(a)g(character)j(class.)
2026 2596 y Fo(4.2.2)81 b(Rules)21 b(f)n(or)f(Identities)2026
2752 y Fs(Rules)85 b(on)e(identities)i(\(uids)e(or)h(gids\))g(are)g
(encoded)2026 2852 y(as)70 b(lists)g(of)f(singular)f(inte)o(gers)g(and)
h(ranges)3583 2821 y Fl(4)3684 2852 y Fs(such)g(as)2026
2951 y Ff([)p Fr(\000)p Ff(5)p Fm(;)14 b Fr(\000)p Ff(3])p
Fm(;)60 b Ff(1)p Fm(;)h Ff([30)p Fm(;)14 b Ff(100])p
Fm(;)59 b Ff(251)p Fm(;)h Ff(300)p Fs(.)105 b(The)47
b(basic)g(opera-)2026 3051 y(tion)22 b(on)h(such)g(a)g(list)h(is)g(to)f
(check)g(if)g(a)g(speci\002c)g(inte)o(gral)f(v)n(alue)h(is)2026
3150 y(in)d(it.)2101 3250 y(Each)15 b(program')-5 b(s)14
b(polic)o(y)g(has)i(an)f(uid)h(list)g(and)f(a)h(gid)f(list.)25
b(These)2026 3350 y(lists)20 b(are)f(the)f Ft(ne)o(w)h(identities)g
Fs(a)g(process)g(running)d(the)j(program)e(is)2026 3449
y(allo)n(wed)22 b(to)i(assume.)33 b(A)24 b(process)f(has)g(three)g
(types)g(of)g(identities)2026 3549 y(:)j Ft(r)m(eal,)20
b(ef)o(fective)g Fs(and)f Ft(saved)h Fs([MBKQ96)o(].)25
b(Since)20 b(a)h(process)f(can)2026 3649 y(freely)14
b(e)o(xchange)g(the)h(v)n(alues)g(of)h(dif)n(ferent)e(types)h(of)g(ids)
h(or)f(assign)2026 3748 y(one)31 b(to)h(the)g(other)m(,)i(the)e
(BlueBox)f(enforcer)f(does)i(not)g(mak)o(e)f(a)2026 3848
y(distinction)g(among)g(the)h(three)f(types)h(of)g(id')-5
b(s)33 b(when)e(checking)2026 3947 y(the)21 b(rules.)29
b(In)21 b(other)f(w)o(ords,)i(when)e(a)i(system)g(call)g(requests)f(ne)
n(w)2026 4047 y(uid')-5 b(s)18 b(or)f(gid')-5 b(s,)18
b(the)g(enforcer)e(only)h(allo)n(ws)h(one)g(of)f(the)h(follo)n(wing)
2026 4147 y(tw)o(o)i(cases)h(:)2088 4295 y(1.)41 b(the)28
b(uid')-5 b(s/gid')g(s)27 b(are)h(in)g(the)g(set)h(of)f(uid')-5
b(s/gid')g(s)27 b(which)h(the)2192 4395 y(process)20
b(already)f(has,)h(or)2088 4552 y(2.)41 b(the)28 b(uid')-5
b(s/gid')g(s)27 b(are)h(in)g(the)g(process')-5 b(s)28
b(uid/gid)f(list)i(and)e(if)2192 4652 y(the)g(follo)n(wing)e(condition)
g(is)i(met:)39 b(if)27 b(the)f(process')-5 b(s)27 b Fm(euid)2192
4751 y Fs(has)41 b(gone)e(through)g(the)i(transition)e(\223)p
Ff(\()p Fm(euid)61 b Ff(=)f(0\))h Fr(\))2192 4851 y Ff(\()p
Fm(euid)56 b Ff(=)g Fm(a)h Fr(6)p Ff(=)f(0\))g Fr(\))h
Ff(\()p Fm(euid)f Ff(=)g(0\))p Fs(\224)39 b(and)f(asks)g(to)2192
4951 y(change)31 b(its)i Fm(euid)f Fs(to)g Fm(v)s Fs(,)k(then)c
Fm(v)k Fs(equals)c Fm(a)p Fs(.)61 b(This)33 b(condi-)2192
5050 y(tion)17 b(is)i(meant)f(to)g(pre)n(v)o(ent)e(an)i(attack)o(er)f
(from)g(hopping)f(o)o(v)o(er)2192 5150 y(dif)n(ferent)i(uid')-5
b(s.)2101 5298 y(An)35 b(inte)o(ger)f(list)i(can)f(also)h(represent)e
(rules)h(on)g(system)g(re-)2026 5398 y(sources)26 b(with)g(inte)o(gral)
g(v)n(alues)g(such)g(as)h(scheduling)d(priorities,)2026
5498 y(etc..)p 2026 5542 V 2116 5598 a Fk(4)2145 5621
y Fj(It)e(may)f(contain)i(non\226ne)o(gati)n(v)o(e)i(and)d(ne)o(gati)n
(v)o(e)i(inte)o(gers;)i(e.g.,)21 b(uid')l(s)h(could)2026
5700 y(be)17 b(ne)o(gati)n(v)o(e)j(or)d(non\226ne)o(gati)n(v)o(e.)p
eop
%%Page: 7 7
7 6 bop -63 445 a Fo(pathname)890 b(access)20 b(permisions)100
b(cr)o(eation)19 b(mode)p -63 498 4088 24 v -63 758 a
Fs(/*)i Ft(r:r)m(ead,)e(w:write)o(,)j(x:e)n(xecute)o(,)d(c:cr)m(eate)o
(,)h(a:append)d Fs(*/)-63 957 y(/*)k(share)f(libraries)f(*/)-63
1056 y(/etc/ld.so.*)921 b Ft(r)-63 1156 y Fs(/lib/*)1111
b Ft(r)-63 1355 y Fs(/*)21 b(system)f(con\002guration)e(\002les)j(*/)
-63 1455 y(/etc/host.conf)835 b Ft(r)-63 1555 y Fs(/etc/hosts)973
b Ft(r)-63 1654 y Fs(/etc/passwd)899 b Ft(r)-63 1754
y Fs(/etc/group)948 b Ft(r)-63 1853 y Fs(/etc/resolv)-5
b(.conf)775 b Ft(r)-63 2053 y Fs(/*)21 b(Apache)e(\002les)i(*/)-63
2152 y(/usr/local/apache2/conf/*)443 b Ft(r)-63 2252
y Fs(/usr/local/apache2/htdocs/*.html)200 b Ft(r)-63
2352 y Fs(/usr/local/apache2/logs/error)p 897 2352 25
4 v 25 w(log)g Ft(rwca)517 b Fs(666)-63 2451 y
(/usr/local/apache2/logs/access)p 946 2451 V 27 w(log)149
b Ft(wca)549 b Fs(666)-63 2551 y(/usr/local/apache2/logs/referer)p
957 2551 V 25 w(log)140 b Ft(wca)549 b Fs(666)-63 2650
y(/usr/local/apache2/logs/agent)p 915 2650 V 26 w(log)181
b Ft(wca)549 b Fs(666)-63 2750 y(/usr/local/apache2/logs/httpd.pid)195
b Ft(rwc)559 b Fs(644)-63 2850 y(/usr/local/apache2/cgi-bin/*)355
b Ft(rx)p -63 3003 4088 24 v 1135 3284 a Fs(Figure)19
b(2.)h Fd(P)m(ar)s(tial)25 b Fn(r)q(ules)e(f)n(or)f(Apache)i(\002le)f
(access)-112 3551 y Fo(4.2.3)81 b(Rules)21 b(f)n(or)e(Signals)-112
3719 y Fs(Rules)25 b(for)f(signals)h(are)f(encoded)f(as)j(a)f
(bit\226mask)1371 3689 y Fl(5)1402 3719 y Fs(,)i(which)d(is)h(an)-112
3819 y(array)j(of)h(unsigned)f(inte)o(gers)h(used)g(as)i(bit\226v)o
(ectors)d(and)h(repre-)-112 3918 y(sents)e(a)h(set)g(of)f(non\226ne)o
(gati)n(v)o(e)c(inte)o(gers)j(whose)h(corresponding)-112
4018 y(bits)i(are)g Ff(1)p Fs(.)51 b(Bits)30 b(in)f(a)h(bit)f(mask)g
(are)g(numbered)d(sequentially)-5 b(,)-112 4117 y(starting)25
b(from)h(the)g(LSB)h(of)f(the)g(\002rst)h(inte)o(ger)m(,)f(numbered)e
(zero,)-112 4217 y(to)j(the)h(MSB)g(of)f(the)g(last)i(inte)o(ger)-5
b(.)46 b(Unlik)o(e)27 b(an)g(inte)o(ger)f(list,)31 b(set)-112
4317 y(operations)18 b(can)i(be)g(easily)h(performed)c(on)j
(bit\226masks.)-37 4416 y(F)o(or)c(rules)g(on)g(handling)f(recei)n(v)o
(ed)g(signals,)i(BlueBox)g(puts)f(sig-)-112 4516 y(nals)j(into)f(four)g
(subsets)i(:)25 b(\(1\))18 b(those)h Ft(can)f(be)h(bloc)n(k)o(ed)f
Fs(\(CBB\),)i(\(2\))-112 4616 y(those)d Ft(can)f(be)i(ignor)m(ed)e
Fs(\(CBI\),)h(\(3\))g(those)g Ft(can)g(be)g(default)g
Fs(\(CBD\))-112 4715 y(:)27 b(their)f(handlers)g(can)g(be)h(the)g(def)o
(ault)e(handlers,)i(\(4\))f(those)h Ft(can)-112 4815
y(be)e(handled)e Fs(\(CBH\))i(:)h(their)f(handlers)f(can)h(be)g
(assigned)g(by)f(the)-112 4914 y(process.)44 b(These)26
b(subsets)h(can)g(intersect)g(in)f(an)o(y)g(possible)h(w)o(ay)-5
b(.)-112 5014 y(Since)18 b(a)i(UNIX/LINUX)e(system)h(does)f(not)h
(support)e(other)i(types)-112 5114 y(of)k(treatment)g(for)g(recei)n(v)o
(ed)f(signals,)i(if)g(a)g(signal)g(is)g(in)g(only)f(one)-112
5213 y(subset,)32 b(then)d(\223can)h(be\224)g(becomes)f(\223must)g
(be\224.)54 b(F)o(or)30 b(e)o(xample,)-112 5313 y(signals)16
b(that)h(are)f(only)g(in)g(the)h(CBB)h(subset)f(are)f(signals)h(that)f
(must)-112 5413 y(be)32 b(block)o(ed.)60 b(Besides)33
b(maintaining)e(four)g(bit\226masks)h(for)f(the)-112
5512 y(four)25 b(\223can)i(be\224)g(subsets,)i(BlueBox)e(also)g
(computes)f(and)g(main-)p -112 5621 780 4 v -22 5677
a Fk(5)7 5700 y Fj(Bit\226masks)18 b(are)g(also)f(used)h(to)f(encode)i
(the)f Fc(allowed)g(system)g(calls)g(list)p Fj(.)2026
3551 y Fs(tains)25 b(the)h Ft(must)f(be)g(bloc)n(k)o(ed)g
Fs(subset)g(for)g(performance)d(reasons.)2026 3650 y(An)e(array)f(of)h
(pointers)g(to)g(handlers)f(for)h(the)g(CBH)i(subset)e(is)h(also)2026
3750 y(maintained;)e(Section)g(4.3)h(gi)n(v)o(es)g(more)f(details)h(on)
g(this)h(array)-5 b(.)2026 3954 y Fp(4.3)90 b(P)n(er)m(\226Pr)n(ocess)
19 b(State)2101 4126 y Fs(Incorporating)c(process)k(state)g(into)g
(rules)f(can)h(protect)f(process)2026 4225 y(against)j(a)i(much)e(lar)o
(ger)g(number)f(of)i(potential)f(attacks.)31 b(Se)n(v)o(eral)2026
4325 y(daemons,)k(especially)f(setuid)g(programs,)h(start)f(out)g(with)
g(real)2026 4425 y(uid)27 b(as)h(root,)g(setting)g(only)e(the)i(ef)n
(fecti)n(v)o(e)e(uid)h(as)h(a)g(user)m(,)h(while)2026
4524 y(retaining)21 b(the)i(possibility)f(of)g(acquiring)f(root)g
(state)j(to)e(do)h(pri)n(vi-)2026 4624 y(le)o(ged)15
b(operations.)22 b(If)16 b(such)g(a)g(daemon)f(is)i(sub)o(v)o(erted)d
(the)i(attack)o(er)2026 4723 y(can)26 b(then)g(re\226acquire)f(root)h
(pri)n(vile)o(ges.)43 b(One)27 b(such)f(e)o(xample)g(is)2026
4823 y(described)g(in)h(the)g(attack)g(on)g(the)g(wu\226ftp)f(daemon)g
(in)h(Section.)2026 4923 y(5.)52 b(Incorporation)26 b(of)j(state)h
(into)f(the)g(system)g(call)h(checks)f(im-)2026 5022
y(pacts)19 b(performance)d(as)j(process)f(state)i(needs)e(to)h(be)g
(updated)e(and)2026 5122 y(check)o(ed.)38 b(W)-7 b(e)27
b(ha)n(v)o(e)d(chosen)h(to)g(ha)n(v)o(e)g(a)g(small)h(amount)e(of)h
(pro-)2026 5222 y(cess)g(state)g(so)f(as)h(to)g(minimize)e(the)h
(performance)e(impact.)36 b Ft(Our)2026 5321 y(guiding)19
b(principle)h(is)i(to)f(add)e(state)j(only)e(when)g(absolutely)g(nec-)
2026 5421 y(essary)p Fs(.)25 b(P)o(arts)c(of)f(the)g(states)h(we)g
(maintain)e(are:)2109 5600 y Fr(\017)41 b Fs(Identity)18
b(state:)26 b(The)19 b(main)g(state)h(component)e(we)h(maintain)2192
5700 y(is)e(the)g(current)e(process)i(identity)f(state.)24
b(The)16 b(states)i(we)f(note)p eop
%%Page: 8 8
8 7 bop 54 458 a Fs(are)28 b(the)h(initial)h Fn(root)f
Fs(state,)j Fn(user)d Fs(state)h(and)e Fn(reroot)i Fs(state)54
558 y(when)21 b(the)h(process)g(becomes)f(root)g(again.)29
b(F)o(or)22 b(each)g(state,)54 657 y(there)e(is)j(a)e(separate)g
(edition)g(of)g(the)g(rules)g(dictating)g(which)54 757
y(system)j(calls)g(are)g(allo)n(wed)f(b)n(ut)h(all)g(states)h(share)e
(the)h(same)54 857 y(set)g(of)g(\002le)h(system)f(access)h
(permissions.)36 b(Daemons)23 b(typi-)54 956 y(cally)17
b(switch)h(back)f(to)h(root)f(state)i(only)e(for)g(a)h(short)f(while)h
(to)54 1056 y(do)25 b(a)h(fe)n(w)g(pri)n(vile)o(ged)d(operations)i(and)
g(this)h(can)g(be)f(ef)n(fec-)54 1155 y(ti)n(v)o(ely)c(controlled)g(by)
h(just)h(changing)d(the)i(allo)n(wed)g(system)54 1255
y(calls.)-29 1424 y Fr(\017)41 b Fs(System)25 b(call)i(count:)35
b(Another)25 b(process)g(state)i(component)54 1524 y(is)d(the)f(number)
e(of)i(times)g(certain)g(system)g(calls)h(are)f(made.)54
1624 y(Currently)-5 b(,)15 b(this)i(is)h(enabled)d(for)h(only)g(the)h
Fn(f)n(or)q(k)f Fs(and)h Fn(w)o(aitpid)54 1723 y Fs(system)22
b(calls.)34 b(F)o(or)22 b(each)h(call)g(we)g(k)o(eep)f(the)h(current)e
(count)54 1823 y(and)k(maximum)g(allo)n(wed.)43 b(This)26
b(component)e(is)j(useful)f(in)54 1923 y(tw)o(o)34 b(situations:)53
b(First,)38 b(we)c(can)g(use)g(this)h(to)f(stop)g(DOS)54
2022 y(attacks)e(which)g(repeatedly)f(consume)g(system)h(resources)54
2122 y(via)h(system)h(calls:)52 b Ft(e)o(.g)o(.)64 b
Fs(an)34 b(attack)o(er)e(could)h(repeatedly)54 2221 y(fork)21
b(child)h(processes.)32 b(The)22 b(second)g(situation)g(where)g(this)54
2321 y(might)17 b(be)i(useful)f(is)i(in)e(controlling)f(scripts)i
(which)f(e)o(x)o(ecute)54 2421 y(arbitrary)h(shell)j(commands.)28
b(Since)21 b(the)h(shell)g(script)f(forks)54 2520 y(processes)16
b(to)h(e)o(x)o(ecute)f(dif)n(ferent)f(commands)h(this)h(can)g(con-)54
2620 y(trol)g(the)h(number)e(of)h(commands)f(the)i(process)f(can)h(e)o
(x)o(ecute.)54 2720 y(While)32 b(this)h(by)f(itself)h(does)f(not)g(of)n
(fer)f(more)h(security)-5 b(,)34 b(it)54 2819 y(does)19
b(so)i(in)f(combination)e(with)j(other)e(rules.)-29 2989
y Fr(\017)41 b Fs(Signal)24 b(Handlers:)34 b(Another)24
b(DOS)h(attack)g(is)h(to)f(ha)n(v)o(e)f(sig-)54 3088
y(nals)17 b(handled)e(incorrectly)h(resulting)g(in)h(errant)f(process)h
(be-)54 3188 y(ha)n(vior)-5 b(.)23 b(This)18 b(can)f(be)h(done)e(by)h
(re)o(gistering)f(a)i(\223wrong\224)e(sig-)54 3287 y(nal)h(handler)e(.)
25 b(Since)17 b(there)f(is)i(no)f(w)o(ay)g(for)g(the)g(IDS)g(to)g
(iden-)54 3387 y(tify)30 b(the)g(\223correct\224)f(signal)h(handler)m
(,)h(it)g(assumes)f(that)g(the)54 3487 y(\002rst)g(handler)f(re)o
(gistered)f(is)j(the)f(right)g(handler)e(and)i(does)54
3586 y(not)19 b(permit)h(an)o(y)f(change)g(to)i(this.)-112
3754 y(Our)31 b(philosophy)e(to)i(adding)f(state)j(to)f(the)f(rules)h
(is)g(that)g(if)g(we)-112 3854 y(add)17 b(state)h(only)f(when)g(there)h
(is)g(substantial)g(bene\002t)f(to)h(be)g(gained)-112
3953 y(either)23 b(in)h(strengthening)e(security)h(guarantees)g(or)h
(in)g(making)f(it)-112 4053 y(easier)18 b(to)g(specify)f(rules)h(for)g
(a)g(particular)f(process.)24 b(W)-7 b(e)19 b(note)e(that)-112
4152 y(our)29 b(process)g(state)h(is)h(substantially)e(smaller)h(than)f
(the)h(system)-112 4252 y(proposed)18 b(by)h(Sekar)h
Ft(et.)26 b(al)20 b Fs([SU99)o(].)-112 4445 y Fp(4.4)90
b(K)n(er)o(nel)21 b(Impact)-37 4604 y Fs(A)29 b(v)o(ery)e(important)g
(design)h(criteria)g(for)g(our)g(system)h(w)o(as)g(to)-112
4704 y(minimize)18 b(the)h(impact)f(on)h(the)g(k)o(ernel.)k(The)c
(placement)f(of)h(func-)-112 4803 y(tionality)26 b(has)i(been)f
(carefully)f(done)g(to)i(reduce)e(impact)h(on)g(the)-112
4903 y(k)o(ernel.)35 b(Our)23 b(reference)f(intrusion)h(a)n(v)n
(oidance)g(implementation)-112 5003 y(on)16 b(Linux)g(has)h(an)g
(intercept)g(at)g(the)g(system)g(call)h(entry)e(point,)h(and)-112
5102 y(minor)e(hooks)h(in)i(the)f(k)o(ernel)f(code)h(for)f(process)h
(creation)f(and)g(ter)n(-)-112 5202 y(mination)e(\(the)i
Fn(f)n(or)q(k)p Fs(,)g Fn(e)n(x)n(ecv)n(e)e Fs(and)i
Fn(e)n(xit)g Fs(system)g(calls\).)24 b(The)15 b(total)-112
5301 y(impact)20 b(on)g(the)h(k)o(ernel)f(sources)g(is)i(limited)e(to)h
(about)f(10)g(lines)i(of)-112 5401 y(assembly)h(and)g(20)h(lines)g(of)g
(C)h(code.)36 b(The)23 b(rest)i(of)e(the)h(enforce-)-112
5501 y(ment)k(process)g(and)g(the)g(code)g(to)h(parse,)h(allocate)e
(memory)f(for)-112 5600 y(and)f(install)h(rules)f(are)h(in)g(a)g
(completely)e(independent)f(module.)-112 5700 y(The)k(patches)g(to)g(k)
o(ernel)g(are)g Ft(very)h Fs(simple)g(and)e(do)i(not)f(change)2026
458 y(the)e(semantics)g(of)g(the)g(remaining)e(code)h(nor)h(do)f(the)o
(y)h(interfere)2026 558 y(with)c(other)f(parts)h(of)g(the)g(system.)31
b(A)23 b(v)o(ery)e(v)n(alid)g(concern)g(is)i(the)2026
657 y(portability)c(of)h(BlueBox)h(across)g(dif)n(ferent)e(v)o(ersions)
h(of)g(the)h(k)o(er)n(-)2026 757 y(nel:)39 b(we)27 b(belie)n(v)o(e)f
(that)i(the)f(points)f(in)i(the)f(Linux)f(k)o(ernel)g(which)2026
857 y(we)21 b(ha)n(v)o(e)g(intercepted)f(are)h(v)o(ery)g(stable)g(and)g
(unlik)o(ely)f(to)i(change)2026 956 y(in)k(re)n(visions)f(of)g(the)h(k)
o(ernel.)40 b(On)26 b(Linux,)g(where)f(it)h(is)h(easier)e(to)2026
1056 y(allocate)i(memory)e(as)j(pages,)g(each)e(process)h(usually)f
(needs)h(no)2026 1155 y(more)22 b(than)h(2)g(pages)f(\(8K\))h(to)g
(store)g(all)h(IDS)f(related)f(structures.)2026 1255
y(Of)i(course,)g(we)g(use)g(only)f(a)h(smaller)g(subset)g(of)g(this)g
(depending)2026 1355 y(on)18 b(rule)h(size)g(etc.)25
b(Substantial)18 b(portions)g(of)g(the)h(rules)g(are)f(shared)2026
1454 y(by)i(processes)f(and)h(an)o(y)f(child)h(thread/process)f(that)h
(the)o(y)f(spa)o(wn.)2026 1554 y(This)h(can)g(be)g(reduced)f(with)h
(elementary)f(optimization.)2026 1765 y Fu(5)99 b(Examples)2101
1918 y Fs(In)27 b(this)i(section)f(we)g(illustrate)g(ho)n(w)f(our)g
(frame)n(w)o(ork)f(can)i(be)2026 2018 y(ef)n(fecti)n(v)o(ely)e(used)i
(to)h(thw)o(art)f(well-kno)n(wn)e(attacks.)49 b(The)o(y)27
b(also)2026 2118 y(illustrate)20 b(ho)n(w)g(rules)g(for)f(v)n(arious)h
(process)f(can)h(be)g(de\002ned.)2026 2304 y Fp(5.1)90
b(Phf)23 b(cgi\226bin)f(with)h(A)n(pache)2101 2457 y
Fs(The)i(phf)h(cgi\226bin)e(script)i(w)o(as)h(a)f(sample)g(script)f
(which)h(came)2026 2557 y(with)i(the)g(earlier)f(distrib)n(utions)g(of)
g(Apache)g(as)i(an)e(e)o(xample)g(of)2026 2656 y(ho)n(w)20
b(cgi\226bin)f(scripts)i(could)f(be)g(written.)26 b(Figure)20
b(5.1)g(sho)n(ws)h(the)2026 2756 y(rele)n(v)n(ant)30
b(parts)g(of)h(the)g(code)f(for)h(phf)f(script.)57 b(The)31
b(script)g(\002rst)2176 2931 y Fr(f)2326 3031 y(\001)14
b(\001)g(\001)2326 3130 y Fe(/*)49 b(transform)f(http)h(request)2376
3230 y(*)g(into)g Fb(options)g Fe(*/)2326 3330 y Fr(\001)14
b(\001)g(\001)2326 3429 y Fe(/*)49 b(Remove)g(shell)g(characters)2376
3529 y(*)g(from)g(options)g(*/)2326 3629 y(escape)p 2631
3629 25 4 v 29 w(shell)p 2910 3629 V 28 w(command\()2926
3728 y(``)p Fn(/sbin/ph)h Fb(options)p Fe(''\);)2326
3828 y Fn(popen)p Fe(\(``)p Fn(/sbin/ph)h Fb(options)p
Fe('','r'\);)2326 3927 y Fr(\001)14 b(\001)g(\001)2176
4027 y(g)2420 4210 y Fs(Figure)19 b(3.)h Fn(The)j(PHF)g(cgi\226bin)i
(scr)q(ipt)2026 4405 y Fs(syntactically)30 b(transforms)h(the)g
(incoming)f(http)h(request)g(into)g(a)2026 4504 y(list)25
b(of)f(options)g(for)f(a)i(\002ctional)f(program)e Fn(ph)j
Fs(and)f(then)g(spa)o(wns)2026 4604 y(\(using)j Fn(popen)p
Fs(\))h(a)g(shell)g(to)g(e)o(x)o(ecute)e Fn(ph)j Fs(with)f(the)f
(created)g(op-)2026 4704 y(tions.)i(The)22 b Fe(escape)p
2695 4704 V 29 w(shell)p 2974 4704 V 29 w(cmd)f Fs(subroutine)f
(escapes)i(shell)2026 4803 y(characters)e(which)g(may)g(be)h(present)f
(in)h(the)g(options)f(string.)27 b(The)2026 4903 y(f)o(atal)d(b)n(ug)f
(w)o(as)i(that)f(it)h(did)e(not)h(escape)g(the)g(ne)n(wline)f(\()p
Fr(n)p Fe(n)p Fs(\))g(char)n(-)2026 5003 y(acter:)41
b(The)28 b(attack)g(simply)g(ensured)f(that)i(arbitrary)e(command)2026
5102 y(w)o(as)20 b(e)o(x)o(ecuted)e(by)h(passing)g(the)h(ne)n(w)f
(command)f(after)h(a)h(ne)n(wline)2026 5202 y(character)f(in)h(the)g
(options.)2101 5301 y(This)30 b(is)g(a)g(good)e(e)o(xample)g(of)i(ho)n
(w)f(straightforw)o(ard)e(it)j(is)g(to)2026 5401 y(write)k(ef)n(fecti)n
(v)o(e)f(rules.)67 b(By)35 b(design,)i(the)d(script)g(in)m(v)n(ok)o(es)
f(tw)o(o)2026 5501 y(commands)25 b Fn(/bin/sh)k Fs(\()f(while)f(using)g
(the)g Fn(popen)i Fs(library)d(call)i(\))2026 5600 y(and)21
b(the)h(program)e Fn(/sbin/ph)p Fs(.)31 b(Thus)21 b(a)i(v)o(ery)d
(natural)h(set)i(of)f(rules)2026 5700 y(is)j(to)g(allo)n(w)f(read)g
(and)g(e)o(x)o(ecute)f(to)i(these)f(\002les.)39 b(Besides)25
b(shared)p eop
%%Page: 9 9
9 8 bop -112 458 a Fs(libraries,)30 b(the)f(process)f(accesses)h(no)g
(other)f(objects.)50 b(Marking)-112 558 y(these)20 b(rules)g(as)h
(inherited)d(ensures)i(that)g(the)g(process)g(which)f(e)o(x)o(e-)-112
657 y(cutes)h Fn(/bin/sh)i Fs(can)f(only)e(e)o(x)o(ecute)h(these)h(tw)o
(o)f(programs)f(and)h(the)-112 757 y(attack)h(is)i(thw)o(arted.)30
b(Note)22 b(that)g(the)g(process)g(can)g(e)o(x)o(ecute)e(these)-112
857 y(as)g(man)o(y)f(times)i(as)g(it)g(w)o(ants.)-112
1038 y Fp(5.2)90 b(Buffer)22 b(o)o(v)o(er\003o)o(w)f(in)i(wwwcount)-37
1186 y Fs(The)d(wwwcount)f(program)f(is)k(a)f(popular)d(cgi)j(program)d
(which)-112 1286 y(maintains)25 b(a)i(count)f(of)g(the)h(number)e(of)h
(hits)h(on)f(a)h(website)g(and)-112 1385 y(displays)f(this)i(in)f(a)h
(graphical)d(form.)45 b(This)28 b(is)g(widely)e(used)h(al-)-112
1485 y(though)c(in)j(non)e(sensiti)n(v)o(e)i(web)f(sites.)42
b(The)25 b(earlier)g(v)o(ersions)g(of)-112 1585 y(the)g(program)e(suf)n
(fer)h(from)h(a)g(well)h(kno)n(wn)e(b)n(uf)n(fer)g(o)o(v)o(er\003o)n(w)
f(at-)-112 1684 y(tack)32 b(which)g(can)g(be)g(used)g(to)h(e)o(x)o
(ecute)e(arbitrary)g(program)f(on)-112 1784 y(the)23
b(web)h(site.)36 b(It)24 b(is)g(almost)g(tri)n(vial)g(to)f(de\002ne)g
(the)h(rules)g(for)f(this)-112 1883 y(script.)54 b(From)30
b(the)g(de\002nition,)h(or)f(from)f(an)h(inspection)f(of)g(the)-112
1983 y(system)f(call)h(audit)e(trace)i(for)e(this)i(process)f(we)g(can)
g(deri)n(v)o(e)f(the)-112 2083 y(proper)20 b(\002le)k(accesses:)30
b(These)23 b(are)f(all)h(restricted)f(to)h(a)g(single)g(di-)-112
2182 y(rectory)k(based)h(on)f(the)i(initial)g(con\002guration)c(of)j
(the)h(program.)-112 2282 y(No)f(e)o(x)o(ecutable)e(is)j(in)f(the)g
(rules;)k(in)c(f)o(act,)i(the)f Fn(e)n(x)n(ecv)n(e)d
Fs(system)-112 2382 y(call)20 b(is)h(not)f(in)g(the)h(allo)n(wed)e
(system)i(call)f(list.)-112 2563 y Fp(5.3)90 b(wu\226ftpd)23
b(b)n(uffer)f(o)o(v)o(er\003o)o(w)-37 2711 y Fs(This)16
b(e)o(xample)f(illustrates)h(ho)n(w)g(to)h(use)f(the)g(state)h
(maintenance)-112 2811 y(part)e(of)h(our)f(system)h(to)g(enforce)e
(sophisticated)h(checks.)23 b(wu\226ftpd)-112 2910 y(is)h(the)g(ftp)g
(daemon)f(de)n(v)o(eloped)e(at)j(the)g(W)-7 b(ashington)24
b(Uni)n(v)o(ersity)-112 3010 y(at)d(St.)29 b(Louis)21
b(and)g(is)h(one)e(of)h(the)g(more)g(popular)e(ftp)i(daemons)f(in)-112
3110 y(use)h(today)-5 b(.)25 b(There)c(ha)n(v)o(e)f(been)g(a)h(number)f
(of)g(attempts)h(to)g(model)-112 3209 y(the)f(beha)n(vior)e(of)i(the)g
(daemon)f(to)h(detect)g(intrusions)g([SU99)n(].)-37 3309
y(At)32 b(a)f(v)o(ery)g(high)f(le)n(v)o(el,)k(the)d(ftp)g(daemon)f
(starts)i(running)e(as)-112 3409 y(root,)20 b(w)o(aits)i(for)e(a)h
(user)g(to)g(login)f(by)h(authentication)e(and)h(sets)i(its)-112
3508 y Ft(ef)o(fective)e Fs(uid)h(to)h(that)f(of)g(the)g(user)-5
b(.)29 b(F)o(or)21 b(the)g(rest)g(of)g(this)h(session,)-112
3608 y(the)31 b(daemon)e(has)j(as)g Ft(ef)o(fective)f
Fs(uid)g(that)g(of)g(the)g(authenticated)-112 3707 y(user)-5
b(.)23 b(It)16 b(is)h(thus)e(in)h(an)g(unpri)n(vile)o(ged)c(state,)18
b(e)o(xcept)c(when)h(it)i(needs)-112 3807 y(to)k(bind)g(sock)o(ets)h
(to)g(the)f(well\226kno)n(wn)f(ftp)h(data)h(port.)28
b(Since)22 b(this)-112 3907 y(is)e(a)g(pri)n(vile)o(ged)d(port,)i(this)
h(bind)f(operation)e(can)j(only)e(be)i(done)e(in)-112
4006 y(pri)n(vile)o(ged)28 b(state)j(so)f(the)h(daemon)d(becomes)i
(root)f(again.)55 b(The)-112 4106 y(only)33 b(system)i(calls)h(made)e
(by)h(the)f(daemon)g(in)h(this)g(state)g(are)-112 4206
y Fn(soc)n(k)n(et,)e(bind)d Fs(and)e Fn(setuid)h Fs(to)f(user)-5
b(.)49 b(Figure)28 b(4)g(describes)g(this)-112 4305 y(state)c(diagram)f
(of)h(the)g(ftp)g(daemon.)36 b(From)24 b(this)g(functional)f(de-)-112
4405 y(scription)c(we)h(can)g(easily)g(identify)f(one)h(portion)e(of)i
(the)g(rules)g(for)-112 4504 y(the)27 b(ftp)g(daemon.)45
b(In)28 b(the)f(initial)h(state)g(it)g(starts)h(as)f(root)e(and)h(is)
-112 4604 y(permitted)c(to)i(mak)o(e)g(most)f(of)h(the)g(system)g
(calls,)h(in)f(the)g(second)-112 4704 y(state)c(it)h(has)g(a)f(nonzero)
e(uid)i(and)f(is)i(permitted)e(among)g(other)g(the)-112
4803 y Fn(setuid)j Fs(system)g(call)g(to)g(become)e(root)h(again.)31
b(In)22 b(the)h(third)f(state)-112 4903 y(the)30 b(daemon)f(is)j(only)e
(allo)n(wed)g(to)h(e)o(x)o(ecute)e(the)i Fn(soc)n(k)n(et,)37
b(bind)-112 5003 y Fs(and)29 b Fn(setuid)h Fs(to)g(user)f(system)h
(calls.)54 b(Note)30 b(that)f(this)i(is)f(only)f(a)-112
5102 y(subset)20 b(of)h(the)g(entire)f(rule)h(set)g(and)f(illustrates)i
(ho)n(w)e(this)h(thw)o(arts)-112 5202 y(a)j(well\226kno)n(wn)f(attack.)
37 b(This)25 b(subset)f(of)g(the)h(rules)f(is)i(sho)n(wn)d(in)-112
5301 y(Figure)40 b(5.)-37 5401 y(The)25 b(earlier)g(v)o(ersions)g(of)h
(this)g(daemon)e(were)i(susceptible)f(to)-112 5501 y(an)g(attack)h
(where)g(a)g(re)o(gular)e(user)i(authenticated)e(and)i(o)o(v)o(er\003e)
n(w)-112 5600 y(the)21 b(process)f(heap[WUF)o(].)28 b(Then,)20
b(arbitrary)g(code)g(could)g(be)h(e)o(x-)-112 5700 y(ecuted)26
b(in)i(the)f Fn(reroot)k(state)d Ft(e)o(.g)o(.)45 b Fs(spa)o(wn)27
b(a)h(root)f(shell)g(on)g(the)2026 458 y(serv)o(er)-5
b(.)57 b(Using)30 b(the)h(subset)h(of)e(the)h(BlueBox)g(rules)g
(described)2026 558 y(abo)o(v)o(e,)20 b(we)j(can)f(mitigate)f(the)i
(damage)e(due)g(to)i(this)f(attack.)31 b(The)2026 657
y(only)h(system)i(calls)g(the)g(attack)o(er)f(can)g(e)o(x)o(ecute)f(in)
i(the)f Fn(reroot)2026 757 y Fs(state)24 b(are)g(the)f
Fn(soc)n(k)n(et,)28 b(bind)d Fs(and)e Fn(setuid)h Fs(to)g(user;)h(the)f
(attack)o(er)2026 857 y(has)30 b(no)g(potential)f(access)i(to)f(the)g
(\002le)h(system)f(objects)g Ft(i.e)o(.)55 b Fs(all)2026
956 y(other)19 b(sensiti)n(v)o(e)h(system)g(calls)h(are)f(disallo)n
(wed.)k(Although)18 b(there)2026 1056 y(is)29 b(no)f(w)o(ay)h(in)g(the)
f(k)o(ernel,)i(to)e(distinguish)g(the)g(normal)g(setting)2026
1155 y(uid)e(to)i(root)e(by)g(the)h(ftp)g(daemon)f(from)g(the)h(user)f
(state)i(and)f(the)2026 1255 y(attack)o(er)21 b(setting)i(uid)e(to)i
(root)e(after)h(the)g(b)n(uf)n(fer)f(o)o(v)o(er\003o)n(w)-5
b(,)20 b(this)j(is)2026 1355 y(the)d(best)g(protection)f(one)g(can)h(e)
o(xpect.)2101 1454 y(The)15 b(e)o(xamples)f(that)i(we)g(ha)n(v)o(e)f
(described)f(in)h(this)h(section)g(high-)2026 1554 y(light)g(se)n(v)o
(eral)f(important)g(features)g(of)h(the)g(semantics)g(of)g(the)g(rules)
2026 1654 y(in)24 b(our)f(system.)37 b(The)o(y)23 b(also)h(illustrate)g
(the)h(security)e(guarantees)2026 1753 y(the)31 b(system)g(can)f(pro)o
(vide.)55 b(F)o(or)30 b(instance,)j(in)e(the)g(case)g(of)g(the)2026
1853 y(phf\226attack,)16 b(the)j(system)f(guarantees)f(that)h(the)h
(only)e(e)o(x)o(ecutables)2026 1952 y(are)31 b Fn(/bin/sh)h
Fs(and)e Fn(/sbin/ph)p Fs(.)59 b(Ho)n(we)n(v)o(er)29
b(the)i(attack)g(can)g(mak)o(e)2026 2052 y(the)d(system)h(endlessly)f
(e)o(x)o(ecute)f(these)h(binaries)g(resulting)g(in)g(a)2026
2152 y(denial\226of\226service.)44 b(In)28 b(the)g(ftpd)f(e)o(xample,)h
(we)g(are)g(unable)e(to)2026 2251 y(detect)i(that)g(the)h(b)n(uf)n(fer)
e(o)o(v)o(er\003o)n(wed,)g(yet)h(we)h(are)f(able)h(to)f(sub-)2026
2351 y(stantially)18 b(mitigate)g(the)g(damage)g(that)g(the)h(attack)o
(er)f(can)g(do.)24 b(An-)2026 2451 y(other)d(important)g(feature)h(is)h
(that)g(the)g(rules)f(for)g(a)h(lar)o(ge)e(number)2026
2550 y(of)26 b(programs)e(are)i(v)o(ery)f(easy)h(to)h(write)f(and)g
(can)g(potentially)f(be)2026 2650 y(done)f(with)h(a)g(single)g(e)o
(xamination)e(of)i(the)g(audit)g(trail.)39 b(Ev)o(en)24
b(in)2026 2749 y(the)f(more)f(sophisticated)h(e)o(xample)e(of)i(the)g
(ftp)g(daemon,)f(we)i(be-)2026 2849 y(lie)n(v)o(e)31
b(our)f(approach)g(is)i(substantially)f(simpler)g(than)f(the)i(state)
2026 2949 y(diagram)19 b(based)g(approach)f(adv)n(ocated)h(by)h([SU99)o
(].)2026 3174 y Fu(6)99 b(P)n(erf)n(ormance)2101 3341
y Fs(One)16 b(of)h(the)f(main)h(design)f(guidelines)f(for)h(BlueBox)h
(is)g(to)g(min-)2026 3440 y(imize)32 b(the)h(performance)c(impact.)61
b(Crucial)32 b(design)g(decisions)2026 3540 y(about)f(ho)n(w)g(much)g
(state)h(to)g(incorporate)e(into)h(the)h(rules)g(were)2026
3639 y(dri)n(v)o(en)22 b(primarily)h(by)h(ho)n(w)f(much)g(it)i(impacts)
f(the)g(performance)2026 3739 y(of)g(the)g(process)f(being)g
(monitored.)35 b(The)24 b(prototypical)e(applica-)2026
3839 y(tion)h(we)g(use)g(to)g(measure)g(the)g(performance)d(is)k(the)f
(Apache)f(2.0)2026 3938 y(web)k(serv)o(er)g(daemon.)44
b(The)26 b(results)i(for)e(this)h(daemon)f(are)g(rep-)2026
4038 y(resentati)n(v)o(e)21 b(as)i(it)g(e)o(x)o(ercises)f(most)h(of)f
(the)h(checks)e(implemented)2026 4138 y(for)i(the)g(v)n(arious)f
(system)i(calls.)35 b(In)23 b(f)o(act,)h(man)o(y)f(of)g(the)g(compute)
2026 4237 y(intensi)n(v)o(e)17 b(system)h(call)h(checks,)f(such)g(as)h
Fn(open)p Fs(,)g Fn(read)g Fs(and)f Fn(fcntl)p Fs(,)2026
4337 y(are)28 b(used)g(substantially)-5 b(.)48 b(Other)28
b(processes)g(will)h(typically)e(use)2026 4436 y(fe)n(wer)22
b(such)h(calls)h(and)f(hence)f(the)h(performance)d(impact)j(on)g(the)
2026 4536 y(Apache)c(httpd)g(daemon)g(will)i(be)f(an)g(upper)f(bound.)
2026 4736 y Fp(6.1)90 b(T)-8 b(estbed)2101 4903 y Fs(Our)22
b(tests)h(ran)f(the)g(W)-7 b(ebStone)22 b(benchmark)e(of)i(serv)o(er)f
(perfor)n(-)2026 5003 y(mance)33 b(with)g(the)h(follo)n(wing)e
(parameters:)50 b(There)33 b(is)i(a)f(single)2026 5102
y(client)16 b(machine)f(generating)f(load)i(and)g(it)h(has)f(between)f
(three)h(and)2026 5202 y(eight)g(threads)g(generating)f(requests)h(for)
g(the)h(serv)o(er)-5 b(.)23 b(These)17 b(were)2026 5301
y(so)k(chosen)f(such)h(that)g(the)g(resulting)f(load)g(does)h(not)g
(saturate)g(the)2026 5401 y(serv)o(er)30 b(with)i(or)f(without)g
(BlueBox.)58 b(The)31 b(load)g(generated)f(by)2026 5501
y(the)19 b(clients)g(is)h(entirely)f(static)h(content.)j(T)-6
b(esting)19 b(under)f(dynamic)2026 5600 y(content)f(w)o(ould)g(result)i
(in)f(a)h(lar)o(ger)e(penalty)g(due)h(to)g(the)g(o)o(v)o(erhead)2026
5700 y(of)28 b(loading)f(rules)h(for)g(each)g(script)g(that)h(is)g(in)m
(v)n(ok)o(ed.)48 b(Both)29 b(the)p eop
%%Page: 10 10
10 9 bop 581 1036 a @beginspecial 0 @llx 0 @lly 613 @urx
150 @ury 3240 @rwi @setspecial
%%BeginDocument: fig/ftpdstate.ps
%!PS-Adobe-2.0 EPSF-2.0
%%Title: fig/ftpdstate.fig
%%Creator: fig2dev Version 3.2 Patchlevel 1
%%CreationDate: Fri Aug 24 14:31:44 2001
%%For: schari@netsec03 (Suresh Chari)
%%Orientation: Portrait
%%BoundingBox: 0 0 613 150
%%Pages: 0
%%BeginSetup
%%EndSetup
%%Magnification: 1.0000
%%EndComments
/$F2psDict 200 dict def
$F2psDict begin
$F2psDict /mtrx matrix put
/col-1 {0 setgray} bind def
/col0 {0.000 0.000 0.000 srgb} bind def
/col1 {0.000 0.000 1.000 srgb} bind def
/col2 {0.000 1.000 0.000 srgb} bind def
/col3 {0.000 1.000 1.000 srgb} bind def
/col4 {1.000 0.000 0.000 srgb} bind def
/col5 {1.000 0.000 1.000 srgb} bind def
/col6 {1.000 1.000 0.000 srgb} bind def
/col7 {1.000 1.000 1.000 srgb} bind def
/col8 {0.000 0.000 0.560 srgb} bind def
/col9 {0.000 0.000 0.690 srgb} bind def
/col10 {0.000 0.000 0.820 srgb} bind def
/col11 {0.530 0.810 1.000 srgb} bind def
/col12 {0.000 0.560 0.000 srgb} bind def
/col13 {0.000 0.690 0.000 srgb} bind def
/col14 {0.000 0.820 0.000 srgb} bind def
/col15 {0.000 0.560 0.560 srgb} bind def
/col16 {0.000 0.690 0.690 srgb} bind def
/col17 {0.000 0.820 0.820 srgb} bind def
/col18 {0.560 0.000 0.000 srgb} bind def
/col19 {0.690 0.000 0.000 srgb} bind def
/col20 {0.820 0.000 0.000 srgb} bind def
/col21 {0.560 0.000 0.560 srgb} bind def
/col22 {0.690 0.000 0.690 srgb} bind def
/col23 {0.820 0.000 0.820 srgb} bind def
/col24 {0.500 0.190 0.000 srgb} bind def
/col25 {0.630 0.250 0.000 srgb} bind def
/col26 {0.750 0.380 0.000 srgb} bind def
/col27 {1.000 0.500 0.500 srgb} bind def
/col28 {1.000 0.630 0.630 srgb} bind def
/col29 {1.000 0.750 0.750 srgb} bind def
/col30 {1.000 0.880 0.880 srgb} bind def
/col31 {1.000 0.840 0.000 srgb} bind def

end
save
-49.0 248.0 translate
1 -1 scale

/cp {closepath} bind def
/ef {eofill} bind def
/gr {grestore} bind def
/gs {gsave} bind def
/sa {save} bind def
/rs {restore} bind def
/l {lineto} bind def
/m {moveto} bind def
/rm {rmoveto} bind def
/n {newpath} bind def
/s {stroke} bind def
/sh {show} bind def
/slc {setlinecap} bind def
/slj {setlinejoin} bind def
/slw {setlinewidth} bind def
/srgb {setrgbcolor} bind def
/rot {rotate} bind def
/sc {scale} bind def
/sd {setdash} bind def
/ff {findfont} bind def
/sf {setfont} bind def
/scf {scalefont} bind def
/sw {stringwidth} bind def
/tr {translate} bind def
/tnt {dup dup currentrgbcolor
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add srgb}
  bind def
/shd {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
  4 -2 roll mul srgb} bind def
 /DrawEllipse {
	/endangle exch def
	/startangle exch def
	/yrad exch def
	/xrad exch def
	/y exch def
	/x exch def
	/savematrix mtrx currentmatrix def
	x y tr xrad yrad sc 0 0 1 startangle endangle arc
	closepath
	savematrix setmatrix
	} def

/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def
%%EndProlog

$F2psBegin
10 setmiterlimit
n -1000 5132 m -1000 -1000 l 12033 -1000 l 12033 5132 l cp clip
 0.06000 0.06000 sc
/Times-Roman ff 480.00 scf sf
1275 2550 m
gs 1 -1 sc (Initial) col0 sh gr
/Times-Roman ff 480.00 scf sf
1275 3090 m
gs 1 -1 sc (Root) col0 sh gr
/Times-Roman ff 480.00 scf sf
1275 3630 m
gs 1 -1 sc (State) col0 sh gr
/Times-Roman ff 480.00 scf sf
4950 2775 m
gs 1 -1 sc (Nonzero) col0 sh gr
/Times-Roman ff 480.00 scf sf
4950 3315 m
gs 1 -1 sc (user id) col0 sh gr
/Times-Roman ff 480.00 scf sf
9375 2700 m
gs 1 -1 sc (Reroot) col0 sh gr
/Times-Roman ff 480.00 scf sf
9375 3240 m
gs 1 -1 sc (State) col0 sh gr
% Arc
7.500 slw
gs  clippath
4576 2519 m 4691 2608 l 4549 2573 l 4725 2659 l 4752 2605 l cp
clip
n 3825.0 4262.5 1868.5 -118.8 -61.2 arc
gs col0 s gr
 gr

% arrowhead
15.000 slw
n 4576 2519 m 4691 2608 l 4549 2573 l 4584 2556 l 4576 2519 l  cp gs 0.00 setgray ef gr  col0 s
% Arc
7.500 slw
gs  clippath
8763 2477 m 8864 2583 l 8729 2526 l 8920 2658 l 8954 2609 l cp
clip
n 7823.3 4034.3 1788.8 -123.9 -52.0 arc
gs col0 s gr
 gr

% arrowhead
30.000 slw
n 8763 2477 m 8864 2583 l 8729 2526 l 8766 2515 l 8763 2477 l  cp gs 0.00 setgray ef gr  col0 s
% Arc
7.500 slw
gs  clippath
7000 3283 m 6889 3186 l 7029 3231 l 6827 3116 l 6797 3169 l cp
clip
n 7875.0 1500.0 1955.8 122.5 57.5 arcn
gs col0 s gr
 gr

% arrowhead
30.000 slw
n 7000 3283 m 6889 3186 l 7029 3231 l 6994 3245 l 7000 3283 l  cp gs 0.00 setgray ef gr  col0 s
7.500 slw
% Ellipse
n 1875 2925 1050 1200 0 360 DrawEllipse gs col0 s gr

% Ellipse
n 5775 2925 1050 1200 0 360 DrawEllipse gs col0 s gr

% Ellipse
n 9975 2850 1050 1200 0 360 DrawEllipse gs col0 s gr

/Times-Roman ff 300.00 scf sf
2775 2100 m
gs 1 -1 sc (user authentication) col0 sh gr
/Times-Roman ff 300.00 scf sf
7125 2025 m
gs 1 -1 sc (reroot for bind) col0 sh gr
/Times-Roman ff 300.00 scf sf
7125 3900 m
gs 1 -1 sc (after bind) col0 sh gr
$F2psEnd
rs

%%EndDocument
 @endspecial 1103 1218 a Fs(Figure)19 b(4.)h Fn(State)k(diag)o(r)o(am)g
(of)g(the)f(wu\226ftp)h(daemon)581 2727 y @beginspecial
0 @llx 0 @lly 627 @urx 323 @ury 3240 @rwi @setspecial
%%BeginDocument: fig/ftpdrules.ps
%!PS-Adobe-2.0 EPSF-2.0
%%Title: fig/ftpdrules.fig
%%Creator: fig2dev Version 3.2 Patchlevel 1
%%CreationDate: Fri Aug 24 14:31:44 2001
%%For: schari@netsec03 (Suresh Chari)
%%Orientation: Portrait
%%BoundingBox: 0 0 627 323
%%Pages: 0
%%BeginSetup
%%EndSetup
%%Magnification: 1.0000
%%EndComments
/$F2psDict 200 dict def
$F2psDict begin
$F2psDict /mtrx matrix put
/col-1 {0 setgray} bind def
/col0 {0.000 0.000 0.000 srgb} bind def
/col1 {0.000 0.000 1.000 srgb} bind def
/col2 {0.000 1.000 0.000 srgb} bind def
/col3 {0.000 1.000 1.000 srgb} bind def
/col4 {1.000 0.000 0.000 srgb} bind def
/col5 {1.000 0.000 1.000 srgb} bind def
/col6 {1.000 1.000 0.000 srgb} bind def
/col7 {1.000 1.000 1.000 srgb} bind def
/col8 {0.000 0.000 0.560 srgb} bind def
/col9 {0.000 0.000 0.690 srgb} bind def
/col10 {0.000 0.000 0.820 srgb} bind def
/col11 {0.530 0.810 1.000 srgb} bind def
/col12 {0.000 0.560 0.000 srgb} bind def
/col13 {0.000 0.690 0.000 srgb} bind def
/col14 {0.000 0.820 0.000 srgb} bind def
/col15 {0.000 0.560 0.560 srgb} bind def
/col16 {0.000 0.690 0.690 srgb} bind def
/col17 {0.000 0.820 0.820 srgb} bind def
/col18 {0.560 0.000 0.000 srgb} bind def
/col19 {0.690 0.000 0.000 srgb} bind def
/col20 {0.820 0.000 0.000 srgb} bind def
/col21 {0.560 0.000 0.560 srgb} bind def
/col22 {0.690 0.000 0.690 srgb} bind def
/col23 {0.820 0.000 0.820 srgb} bind def
/col24 {0.500 0.190 0.000 srgb} bind def
/col25 {0.630 0.250 0.000 srgb} bind def
/col26 {0.750 0.380 0.000 srgb} bind def
/col27 {1.000 0.500 0.500 srgb} bind def
/col28 {1.000 0.630 0.630 srgb} bind def
/col29 {1.000 0.750 0.750 srgb} bind def
/col30 {1.000 0.880 0.880 srgb} bind def
/col31 {1.000 0.840 0.000 srgb} bind def

end
save
-49.0 421.0 translate
1 -1 scale

/cp {closepath} bind def
/ef {eofill} bind def
/gr {grestore} bind def
/gs {gsave} bind def
/sa {save} bind def
/rs {restore} bind def
/l {lineto} bind def
/m {moveto} bind def
/rm {rmoveto} bind def
/n {newpath} bind def
/s {stroke} bind def
/sh {show} bind def
/slc {setlinecap} bind def
/slj {setlinejoin} bind def
/slw {setlinewidth} bind def
/srgb {setrgbcolor} bind def
/rot {rotate} bind def
/sc {scale} bind def
/sd {setdash} bind def
/ff {findfont} bind def
/sf {setfont} bind def
/scf {scalefont} bind def
/sw {stringwidth} bind def
/tr {translate} bind def
/tnt {dup dup currentrgbcolor
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add srgb}
  bind def
/shd {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
  4 -2 roll mul srgb} bind def
/reencdict 12 dict def /ReEncode { reencdict begin
/newcodesandnames exch def /newfontname exch def /basefontname exch def
/basefontdict basefontname findfont def /newfont basefontdict maxlength dict def
basefontdict { exch dup /FID ne { dup /Encoding eq
{ exch dup length array copy newfont 3 1 roll put }
{ exch newfont 3 1 roll put } ifelse } { pop pop } ifelse } forall
newfont /FontName newfontname put newcodesandnames aload pop
128 1 255 { newfont /Encoding get exch /.notdef put } for
newcodesandnames length 2 idiv { newfont /Encoding get 3 1 roll put } repeat
newfontname newfont definefont pop end } def
/isovec [
8#200 /grave 8#201 /acute 8#202 /circumflex 8#203 /tilde
8#204 /macron 8#205 /breve 8#206 /dotaccent 8#207 /dieresis
8#210 /ring 8#211 /cedilla 8#212 /hungarumlaut 8#213 /ogonek 8#214 /caron
8#220 /dotlessi 8#230 /oe 8#231 /OE
8#240 /space 8#241 /exclamdown 8#242 /cent 8#243 /sterling
8#244 /currency 8#245 /yen 8#246 /brokenbar 8#247 /section 8#250 /dieresis
8#251 /copyright 8#252 /ordfeminine 8#253 /guillemotleft 8#254 /logicalnot
8#255 /endash 8#256 /registered 8#257 /macron 8#260 /degree 8#261 /plusminus
8#262 /twosuperior 8#263 /threesuperior 8#264 /acute 8#265 /mu 8#266 /paragraph
8#267 /periodcentered 8#270 /cedilla 8#271 /onesuperior 8#272 /ordmasculine
8#273 /guillemotright 8#274 /onequarter 8#275 /onehalf
8#276 /threequarters 8#277 /questiondown 8#300 /Agrave 8#301 /Aacute
8#302 /Acircumflex 8#303 /Atilde 8#304 /Adieresis 8#305 /Aring
8#306 /AE 8#307 /Ccedilla 8#310 /Egrave 8#311 /Eacute
8#312 /Ecircumflex 8#313 /Edieresis 8#314 /Igrave 8#315 /Iacute
8#316 /Icircumflex 8#317 /Idieresis 8#320 /Eth 8#321 /Ntilde 8#322 /Ograve
8#323 /Oacute 8#324 /Ocircumflex 8#325 /Otilde 8#326 /Odieresis 8#327 /multiply
8#330 /Oslash 8#331 /Ugrave 8#332 /Uacute 8#333 /Ucircumflex
8#334 /Udieresis 8#335 /Yacute 8#336 /Thorn 8#337 /germandbls 8#340 /agrave
8#341 /aacute 8#342 /acircumflex 8#343 /atilde 8#344 /adieresis 8#345 /aring
8#346 /ae 8#347 /ccedilla 8#350 /egrave 8#351 /eacute
8#352 /ecircumflex 8#353 /edieresis 8#354 /igrave 8#355 /iacute
8#356 /icircumflex 8#357 /idieresis 8#360 /eth 8#361 /ntilde 8#362 /ograve
8#363 /oacute 8#364 /ocircumflex 8#365 /otilde 8#366 /odieresis 8#367 /divide
8#370 /oslash 8#371 /ugrave 8#372 /uacute 8#373 /ucircumflex
8#374 /udieresis 8#375 /yacute 8#376 /thorn 8#377 /ydieresis] def
/Times-Roman /Times-Roman-iso isovec ReEncode
 /DrawEllipse {
	/endangle exch def
	/startangle exch def
	/yrad exch def
	/xrad exch def
	/y exch def
	/x exch def
	/savematrix mtrx currentmatrix def
	x y tr xrad yrad sc 0 0 1 startangle endangle arc
	closepath
	savematrix setmatrix
	} def

/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def
%%EndProlog

$F2psBegin
10 setmiterlimit
n -1000 8012 m -1000 -1000 l 12262 -1000 l 12262 8012 l cp clip
 0.06000 0.06000 sc
/Times-Roman-iso ff 480.00 scf sf
1275 2550 m
gs 1 -1 sc (Initial) col0 sh gr
/Times-Roman-iso ff 480.00 scf sf
1275 3090 m
gs 1 -1 sc (Root) col0 sh gr
/Times-Roman-iso ff 480.00 scf sf
1275 3630 m
gs 1 -1 sc (State) col0 sh gr
/Times-Roman-iso ff 480.00 scf sf
4950 2775 m
gs 1 -1 sc (Nonzero) col0 sh gr
/Times-Roman-iso ff 480.00 scf sf
4950 3315 m
gs 1 -1 sc (user id) col0 sh gr
/Times-Roman-iso ff 480.00 scf sf
9375 2700 m
gs 1 -1 sc (Reroot) col0 sh gr
/Times-Roman-iso ff 480.00 scf sf
9375 3240 m
gs 1 -1 sc (State) col0 sh gr
/Times-Roman-iso ff 300.00 scf sf
1275 5325 m
gs 1 -1 sc (Link to libraries) col0 sh gr
/Times-Roman-iso ff 300.00 scf sf
1275 5700 m
gs 1 -1 sc (Open sockets) col0 sh gr
/Times-Roman-iso ff 300.00 scf sf
1275 6030 m
gs 1 -1 sc (Read /etc/passwd) col0 sh gr
/Times-Roman-iso ff 300.00 scf sf
1275 6360 m
gs 1 -1 sc (Setuid to user) col0 sh gr
/Times-Roman-iso ff 300.00 scf sf
1275 6690 m
gs 1 -1 sc (etc.) col0 sh gr
/Times-Roman-iso ff 300.00 scf sf
5325 5550 m
gs 1 -1 sc (Access user files) col0 sh gr
/Times-Roman-iso ff 300.00 scf sf
5325 5880 m
gs 1 -1 sc (setuid to root) col0 sh gr
/Times-Roman-iso ff 300.00 scf sf
5325 6210 m
gs 1 -1 sc (etc.) col0 sh gr
/Times-Roman-iso ff 300.00 scf sf
9150 5175 m
gs 1 -1 sc (Only system calls) col0 sh gr
/Times-Roman-iso ff 300.00 scf sf
9150 5505 m
gs 1 -1 sc (- Bind) col0 sh gr
/Times-Roman-iso ff 300.00 scf sf
9150 5835 m
gs 1 -1 sc (- Socket) col0 sh gr
/Times-Roman-iso ff 300.00 scf sf
9150 6165 m
gs 1 -1 sc (- Setuid\(back to) col0 sh gr
/Times-Roman-iso ff 300.00 scf sf
9150 6495 m
gs 1 -1 sc (    user\).) col0 sh gr
% Arc
7.500 slw
gs  clippath
4576 2519 m 4691 2608 l 4549 2573 l 4725 2659 l 4752 2605 l cp
clip
n 3825.0 4262.5 1868.5 -118.8 -61.2 arc
gs col0 s gr
 gr

% arrowhead
15.000 slw
n 4576 2519 m 4691 2608 l 4549 2573 l 4584 2556 l 4576 2519 l  cp gs 0.00 setgray ef gr  col0 s
% Arc
7.500 slw
gs  clippath
8763 2477 m 8864 2583 l 8729 2526 l 8920 2658 l 8954 2609 l cp
clip
n 7823.3 4034.3 1788.8 -123.9 -52.0 arc
gs col0 s gr
 gr

% arrowhead
30.000 slw
n 8763 2477 m 8864 2583 l 8729 2526 l 8766 2515 l 8763 2477 l  cp gs 0.00 setgray ef gr  col0 s
% Arc
7.500 slw
gs  clippath
7000 3283 m 6889 3186 l 7029 3231 l 6827 3116 l 6797 3169 l cp
clip
n 7875.0 1500.0 1955.8 122.5 57.5 arcn
gs col0 s gr
 gr

% arrowhead
30.000 slw
n 7000 3283 m 6889 3186 l 7029 3231 l 6994 3245 l 7000 3283 l  cp gs 0.00 setgray ef gr  col0 s
7.500 slw
% Ellipse
n 1875 2925 1050 1200 0 360 DrawEllipse gs col0 s gr

% Ellipse
n 5775 2925 1050 1200 0 360 DrawEllipse gs col0 s gr

% Ellipse
n 9975 2850 1050 1200 0 360 DrawEllipse gs col0 s gr

% Polyline
n 1305 4875 m 1200 4875 1200 6895 105 arcto 4 {pop} repeat
  1200 7000 3270 7000 105 arcto 4 {pop} repeat
  3375 7000 3375 4980 105 arcto 4 {pop} repeat
  3375 4875 1305 4875 105 arcto 4 {pop} repeat
 cp gs col0 s gr 
% Polyline
n 5280 4775 m 5175 4775 5175 6795 105 arcto 4 {pop} repeat
  5175 6900 7245 6900 105 arcto 4 {pop} repeat
  7350 6900 7350 4880 105 arcto 4 {pop} repeat
  7350 4775 5280 4775 105 arcto 4 {pop} repeat
 cp gs col0 s gr 
% Polyline
n 9180 4700 m 9075 4700 9075 6720 105 arcto 4 {pop} repeat
  9075 6825 11145 6825 105 arcto 4 {pop} repeat
  11250 6825 11250 4805 105 arcto 4 {pop} repeat
  11250 4700 9180 4700 105 arcto 4 {pop} repeat
 cp gs col0 s gr 
/Times-Roman-iso ff 300.00 scf sf
2775 2100 m
gs 1 -1 sc (user authentication) col0 sh gr
/Times-Roman-iso ff 300.00 scf sf
7125 2025 m
gs 1 -1 sc (reroot for bind) col0 sh gr
/Times-Roman-iso ff 300.00 scf sf
7125 3900 m
gs 1 -1 sc (after bind) col0 sh gr
/Times-Roman-iso ff 300.00 scf sf
3225 5325 m
gs 1 -1 sc (.) col0 sh gr
$F2psEnd
rs

%%EndDocument
 @endspecial 745 2910 a Fs(Figure)19 b(5.)h Fn(Subset)k(of)f(the)h
(state\226dependent)g(r)q(ules)f(f)n(or)g(the)g(ftp)h(daemon.)-112
3177 y Fs(webstone)k(client)h(and)f(the)h(Apache)f(serv)o(er)g(were)h
(put)g(on)f(a)i(gi-)-112 3277 y(gabit)20 b(ethernet)h(to)g(ensure)g
(that)h(no)f(ef)n(fect)f(due)h(to)h(lar)o(ge)f(netw)o(ork)-112
3376 y(latencies)f(were)g(observ)o(ed)e(in)i(the)h(results.)-112
3575 y Fp(6.2)90 b(T)-8 b(est)22 b(Results)-37 3741 y
Fs(Figure)e(6)h(sho)n(ws)h(the)f(performance)d(of)j(the)g(Apache)f(2.0)
h(web-)-112 3841 y(serv)o(er)k(performing)e(with)j(and)g(without)52
b(BlueBox)26 b(under)f(v)n(ari-)-112 3940 y(ous)i(serv)o(er)f(load)h(f)
o(actors.)45 b(W)-7 b(e)29 b(anticipate)d(a)i Ff(8)23
b Fr(\000)g Ff(10)p Fs(\045)k(perfor)n(-)-112 4040 y(mance)j(penalty)h
(for)f(the)i(Apache)f(2.0)f(serv)o(er)h(running)e(on)i(the)-112
4140 y(Linux)19 b(2.2.14)f(k)o(ernel.)-112 4339 y Fp(6.3)90
b(Bottlenecks)-37 4504 y Fs(The)22 b(main)g(performance)e(bottlenecks)i
(in)h(enforcing)d(the)j(sys-)-112 4604 y(tem)g(call)h(checks)f(for)g
(the)h(Apache)e(serv)o(er)h(is)h(pathname)e(resolu-)-112
4704 y(tion.)30 b(F)o(or)22 b(each)g(request,)f(the)h(Apache)g(serv)o
(er)f Fn(open)p Fs(s)j(a)e(\002le)h(and)-112 4803 y(then)g(uses)h
Fn(send\002le)g Fs(to)g(send)f(it)h(o)o(v)o(er)f(the)g(sock)o(et.)35
b(F)o(or)23 b(each)h(re-)-112 4903 y(quest,)15 b(we)h(perform)d(a)j
(full)f(name)g(resolution)f(operation)f(to)j(match)-112
5003 y(the)28 b(right)f(\002le)i(name)e(with)i(a)f(node)f(on)h(the)g
(tree)g(of)g(\002le)h(system)-112 5102 y(object)24 b(rules)g(to)h
(eliminate)f(security)g(holes.)38 b(This)25 b(can)g(be)f(addi-)-112
5202 y(tionally)h(optimized)g(by)h(caching)f(and)g(marking)g(certain)h
(names)-112 5301 y(as)e(fully)g(resolv)o(ed.)36 b(Another)23
b(w)o(ay)h(to)g(reduce)f(this)i(o)o(v)o(erhead)d(of)-112
5401 y(name)i(resolution)g(is)j(to)e(ha)n(v)o(e)g Ft(mandatory)f
(access)i(contr)l(ol)f Fs(type)-112 5501 y(labels)g([DoD85)n(,)g(SEL])g
(on)f(\002le)i(system)f(objects)g(and)f(mo)o(v)o(e)f(the)-112
5600 y(check)29 b(entirely)g(to)h(the)g(\002le)h(system)f(i.e.)55
b(the)30 b(\002le)g(system)h(will)-112 5700 y(check)19
b(the)h(labels)h(for)e(permission)g(before)g(it)i(opens)e(the)i
(\002le.)2101 3177 y(The)31 b(results)g(sho)n(wn)f(in)i(Figure)e(6)h
(were)g(generated)e(entirely)2026 3277 y(using)d(static)i(content.)43
b(Dynamic)26 b(content)g(requires)g(the)g(serv)o(er)2026
3376 y(to)20 b(load)g(another)e(process)i(and)f(thus)h(load)g(the)g
(rules)g(for)f(this)i(ne)n(w)2026 3476 y(process)26 b(which)g(adds)h
(to)g(the)g(performance)c(penalty)-5 b(.)44 b(This)27
b(can)2026 3576 y(be)22 b(some)n(what)g(mitigated)g(by)g(caching)f(the)
i(data)f(structures)g(rep-)2026 3675 y(resenting)f(rules)i(for)f
(frequently)f(used)h(cgi\226bin)g(scripts.)33 b(W)-7
b(e)24 b(are)2026 3775 y(in)e(the)h(process)e(of)h(implementing)f(this)
h(in)h(the)f(BlueBox)g(imple-)2026 3874 y(mentation)d(on)g(Linux.)2101
3974 y(Using)37 b(these)f(optimizations,)k(we)d(e)o(xpect)f(that)g(the)
h(perfor)n(-)2026 4074 y(mance)18 b(penalty)h(for)f(the)i(Apache)e
(daemon)g(will)i(be)g(close)f(to)h(5\045.)2026 4173 y(W)-7
b(e)26 b(belie)n(v)o(e)f(that)h(this)g(penalty)e(is)j(not)e(e)o(xcessi)
n(v)o(e)f(gi)n(v)o(en)h(the)g(se-)2026 4273 y(curity)19
b(guarantees)g(one)h(can)g(obtain)f(using)h(this)g(system.)2026
4517 y Fu(7)99 b(Conclusion)2101 4704 y Fs(W)-7 b(e)24
b(ha)n(v)o(e)e(presented)g(Blue)h(Box,)h(a)f(simple)g(system)g(for)f
(sand-)2026 4803 y(boxing)d(applications)i(which)g(can)g(substantially)
g(mitigate)g(secu-)2026 4903 y(rity)i(e)o(xposures)f(of)h(processes.)35
b(W)-7 b(e)25 b(belie)n(v)o(e)d(that)i(our)f(system)h(is)2026
5003 y(a)e(simple)h(and)e(comprehensi)n(v)o(e)f(w)o(ay)i(to)g
(incorporate)e(checks)i(on)2026 5102 y(the)f(e)o(x)o(ecution)e(of)i
(programs)e(at)j(the)g(time)f(of)g(in)m(v)n(ocation)e(of)i(sys-)2026
5202 y(tem)29 b(calls.)51 b(W)-7 b(e)30 b(ha)n(v)o(e)e(described)f
(rules)i(for)f(important)f(serv)o(ers)2026 5301 y(such)20
b(as)i(the)e(Apache)g(daemon,)f(and)i(a)g(number)e(of)h(popular)f
(cgi\226)2026 5401 y(bin)k(scripts;)i(these)e(rules)g(can)g(be)g(used)g
(as)h(templates)f(across)g(in-)2026 5501 y(stallations)d(with)f(ne)n(w)
h(rules)g(written)f(for)g(the)h(indi)n(vidual)d(scripts.)2026
5600 y(Our)k(rule)h(syntax)f(and)g(semantics)h(are)g(simple)g(and)f
(yet)h(quite)g(ef-)2026 5700 y(fecti)n(v)o(e)e(in)g(catching)g(a)h(lar)
o(ge)f(number)f(of)h(kno)n(wn)f(attacks.)27 b(Since)p
eop
%%Page: 11 11
11 10 bop 881 2125 a @beginspecial 44 @llx 192 @lly 548
@urx 612 @ury 2520 @rwi @setspecial
%%BeginDocument: perfdata.eps
%!PS-Adobe-3.0 EPSF-3.0
%%Creator: MATLAB, The Mathworks, Inc.
%%Title: foo1.eps
%%CreationDate: 06/08/2001  15:37:35
%%DocumentNeededFonts: Helvetica
%%+ Times-Bold
%%DocumentProcessColors: Cyan Magenta Yellow Black
%%LanguageLevel: 2
%%Pages: 1
%%BoundingBox:    44   192   548   612
%%EndComments

%%BeginProlog
% MathWorks dictionary
/MathWorks 160 dict begin
% definition operators
/bdef {bind def} bind def
/ldef {load def} bind def
/xdef {exch def} bdef
/xstore {exch store} bdef
% operator abbreviations
/c  /clip ldef
/cc /concat ldef
/cp /closepath ldef
/gr /grestore ldef
/gs /gsave ldef
/mt /moveto ldef
/np /newpath ldef
/cm /currentmatrix ldef
/sm /setmatrix ldef
/rm /rmoveto ldef
/rl /rlineto ldef
/s /show ldef
/sc {setcmykcolor} bdef
/sr /setrgbcolor ldef
/sg /setgray ldef
/w /setlinewidth ldef
/j /setlinejoin ldef
/cap /setlinecap ldef
/rc {rectclip} bdef
/rf {rectfill} bdef
% page state control
/pgsv () def
/bpage {/pgsv save def} bdef
/epage {pgsv restore} bdef
/bplot /gsave ldef
/eplot {stroke grestore} bdef
% orientation switch
/portraitMode 0 def /landscapeMode 1 def /rotateMode 2 def
% coordinate system mappings
/dpi2point 0 def
% font control
/FontSize 0 def
/FMS {/FontSize xstore findfont [FontSize 0 0 FontSize neg 0 0]
  makefont setfont} bdef
/reencode {exch dup where {pop load} {pop StandardEncoding} ifelse
  exch dup 3 1 roll findfont dup length dict begin
  { 1 index /FID ne {def}{pop pop} ifelse } forall
  /Encoding exch def currentdict end definefont pop} bdef
/isroman {findfont /CharStrings get /Agrave known} bdef
/FMSR {3 1 roll 1 index dup isroman {reencode} {pop pop} ifelse
  exch FMS} bdef
/csm {1 dpi2point div -1 dpi2point div scale neg translate
 dup landscapeMode eq {pop -90 rotate}
  {rotateMode eq {90 rotate} if} ifelse} bdef
% line types: solid, dotted, dashed, dotdash
/SO { [] 0 setdash } bdef
/DO { [.5 dpi2point mul 4 dpi2point mul] 0 setdash } bdef
/DA { [6 dpi2point mul] 0 setdash } bdef
/DD { [.5 dpi2point mul 4 dpi2point mul 6 dpi2point mul 4
  dpi2point mul] 0 setdash } bdef
% macros for lines and objects
/L {lineto stroke} bdef
/MP {3 1 roll moveto 1 sub {rlineto} repeat} bdef
/AP {{rlineto} repeat} bdef
/PDlw -1 def
/W {/PDlw currentlinewidth def setlinewidth} def
/PP {closepath eofill} bdef
/DP {closepath stroke} bdef
/MR {4 -2 roll moveto dup  0 exch rlineto exch 0 rlineto
  neg 0 exch rlineto closepath} bdef
/FR {MR stroke} bdef
/PR {MR fill} bdef
/L1i {{currentfile picstr readhexstring pop} image} bdef
/tMatrix matrix def
/MakeOval {newpath tMatrix currentmatrix pop translate scale
0 0 1 0 360 arc tMatrix setmatrix} bdef
/FO {MakeOval stroke} bdef
/PO {MakeOval fill} bdef
/PD {currentlinecap 1 cap 3 1 roll 2 copy mt lineto stroke
   cap PDlw -1 eq not {PDlw w /PDlw -1 def} if} def
/FA {newpath tMatrix currentmatrix pop translate scale
  0 0 1 5 -2 roll arc tMatrix setmatrix stroke} bdef
/PA {newpath tMatrix currentmatrix pop	translate 0 0 moveto scale
  0 0 1 5 -2 roll arc closepath tMatrix setmatrix fill} bdef
/FAn {newpath tMatrix currentmatrix pop translate scale
  0 0 1 5 -2 roll arcn tMatrix setmatrix stroke} bdef
/PAn {newpath tMatrix currentmatrix pop translate 0 0 moveto scale
  0 0 1 5 -2 roll arcn closepath tMatrix setmatrix fill} bdef
/vradius 0 def /hradius 0 def /lry 0 def
/lrx 0 def /uly 0 def /ulx 0 def /rad 0 def
/MRR {/vradius xdef /hradius xdef /lry xdef /lrx xdef /uly xdef
  /ulx xdef newpath tMatrix currentmatrix pop ulx hradius add uly
  vradius add translate hradius vradius scale 0 0 1 180 270 arc 
  tMatrix setmatrix lrx hradius sub uly vradius add translate
  hradius vradius scale 0 0 1 270 360 arc tMatrix setmatrix
  lrx hradius sub lry vradius sub translate hradius vradius scale
  0 0 1 0 90 arc tMatrix setmatrix ulx hradius add lry vradius sub
  translate hradius vradius scale 0 0 1 90 180 arc tMatrix setmatrix
  closepath} bdef
/FRR {MRR stroke } bdef
/PRR {MRR fill } bdef
/MlrRR {/lry xdef /lrx xdef /uly xdef /ulx xdef /rad lry uly sub 2 div def
  newpath tMatrix currentmatrix pop ulx rad add uly rad add translate
  rad rad scale 0 0 1 90 270 arc tMatrix setmatrix lrx rad sub lry rad
  sub translate rad rad scale 0 0 1 270 90 arc tMatrix setmatrix
  closepath} bdef
/FlrRR {MlrRR stroke } bdef
/PlrRR {MlrRR fill } bdef
/MtbRR {/lry xdef /lrx xdef /uly xdef /ulx xdef /rad lrx ulx sub 2 div def
  newpath tMatrix currentmatrix pop ulx rad add uly rad add translate
  rad rad scale 0 0 1 180 360 arc tMatrix setmatrix lrx rad sub lry rad
  sub translate rad rad scale 0 0 1 0 180 arc tMatrix setmatrix
  closepath} bdef
/FtbRR {MtbRR stroke } bdef
/PtbRR {MtbRR fill } bdef
/stri 6 array def /dtri 6 array def
/smat 6 array def /dmat 6 array def
/tmat1 6 array def /tmat2 6 array def /dif 3 array def
/asub {/ind2 exch def /ind1 exch def dup dup
  ind1 get exch ind2 get sub exch } bdef
/tri_to_matrix {
  2 0 asub 3 1 asub 4 0 asub 5 1 asub
  dup 0 get exch 1 get 7 -1 roll astore } bdef
/compute_transform {
  dmat dtri tri_to_matrix tmat1 invertmatrix 
  smat stri tri_to_matrix tmat2 concatmatrix } bdef
/ds {stri astore pop} bdef
/dt {dtri astore pop} bdef
/db {2 copy /cols xdef /rows xdef mul dup 3 mul string
  currentfile 
  3 index 0 eq {/ASCIIHexDecode filter}
  {/ASCII85Decode filter 3 index 2 eq {/RunLengthDecode filter} if }
  ifelse exch readstring pop
  dup 0 3 index getinterval /rbmap xdef
  dup 2 index dup getinterval /gbmap xdef
  1 index dup 2 mul exch getinterval /bbmap xdef pop pop}bdef
/it {gs np dtri aload pop moveto lineto lineto cp c
  cols rows 8 compute_transform 
  rbmap gbmap bbmap true 3 colorimage gr}bdef
/il {newpath moveto lineto stroke}bdef
currentdict end def
%%EndProlog

%%BeginSetup
MathWorks begin

0 cap

end
%%EndSetup

%%Page: 1 1
%%BeginPageSetup
%%PageBoundingBox:    44   192   548   612
MathWorks begin
bpage
%%EndPageSetup

%%BeginObject: obj1
bplot

/dpi2point 12 def
portraitMode 0216 7344 csm

  314    -3  6057  5038 rc
92 dict begin %Colortable dictionary
/c0 { 0 0 0 sr} bdef
/c1 { 1 1 1 sr} bdef
/c2 { 1 0 0 sr} bdef
/c3 { 0 1 0 sr} bdef
/c4 { 0 0 1 sr} bdef
/c5 { 1 1 0 sr} bdef
/c6 { 1 0 1 sr} bdef
/c7 { 0 1 1 sr} bdef
c0
1 j
1 sg
   0    0 6913 5186 rf
6 w
0 4226 5356 0 0 -4226 899 4615 4 MP
PP
-5356 0 0 4226 5356 0 0 -4226 899 4615 5 MP stroke
4 w
DO
SO
6 w
0 sg
 899 4615 mt 6255 4615 L
 899  389 mt 6255  389 L
6255 4615 mt 6255  389 L
 899 4615 mt  899  389 L
 899 4615 mt 6255 4615 L
 899 4615 mt  899  389 L
 899 4615 mt  899 4561 L
 899  389 mt  899  442 L
%%IncludeResource: font Helvetica
/Helvetica /ISOLatin1Encoding 120 FMSR

 833 4760 mt 
(55) s
1568 4615 mt 1568 4561 L
1568  389 mt 1568  442 L
1502 4760 mt 
(60) s
2238 4615 mt 2238 4561 L
2238  389 mt 2238  442 L
2172 4760 mt 
(65) s
2907 4615 mt 2907 4561 L
2907  389 mt 2907  442 L
2841 4760 mt 
(70) s
3577 4615 mt 3577 4561 L
3577  389 mt 3577  442 L
3511 4760 mt 
(75) s
4246 4615 mt 4246 4561 L
4246  389 mt 4246  442 L
4180 4760 mt 
(80) s
4916 4615 mt 4916 4561 L
4916  389 mt 4916  442 L
4850 4760 mt 
(85) s
5585 4615 mt 5585 4561 L
5585  389 mt 5585  442 L
5519 4760 mt 
(90) s
6255 4615 mt 6255 4561 L
6255  389 mt 6255  442 L
6189 4760 mt 
(95) s
 899 4615 mt  952 4615 L
6255 4615 mt 6201 4615 L
 664 4659 mt 
(700) s
 899 3910 mt  952 3910 L
6255 3910 mt 6201 3910 L
 664 3954 mt 
(750) s
 899 3206 mt  952 3206 L
6255 3206 mt 6201 3206 L
 664 3250 mt 
(800) s
 899 2502 mt  952 2502 L
6255 2502 mt 6201 2502 L
 664 2546 mt 
(850) s
 899 1797 mt  952 1797 L
6255 1797 mt 6201 1797 L
 664 1841 mt 
(900) s
 899 1093 mt  952 1093 L
6255 1093 mt 6201 1093 L
 664 1137 mt 
(950) s
 899  389 mt  952  389 L
6255  389 mt 6201  389 L
 598  433 mt 
(1000) s
 899  389 mt 6255  389 L
 899 4615 mt 6255 4615 L
 899 4615 mt  899  389 L
6255 4615 mt 6255  389 L
gs 898 389 5358 4227 rc
/c8 { 1.000000 0.000000 0.000000 sr} bdef
c8
592 -366 518 -366 726 -499 893 -773 1632 -1533 1567 4148 6 MP stroke
/c9 { 0.000000 1.000000 0.000000 sr} bdef
c9
335 -189 545 -327 847 -641 1049 -681 1234 -1087 2124 4349 6 MP stroke
gr

c9
0 sg
%%IncludeResource: font Times-Bold
/Times-Bold /ISOLatin1Encoding 240 FMSR

 964  269 mt 
(Performance comparison under WebStone 2.5 load) s
2783 4981 mt 
(CPU utilization) s
 543 3313 mt  -90 rotate
(Coonections/sec) s
90 rotate
1 sg
0 299 1986 0 0 -299 959 748 4 MP
PP
-1986 0 0 299 1986 0 0 -299 959 748 5 MP stroke
4 w
DO
SO
6 w
0 sg
 959  748 mt 2945  748 L
 959  449 mt 2945  449 L
2945  748 mt 2945  449 L
 959  748 mt  959  449 L
 959  748 mt 2945  748 L
 959  748 mt  959  449 L
 959  449 mt 2945  449 L
 959  748 mt 2945  748 L
 959  748 mt  959  449 L
2945  748 mt 2945  449 L
%%IncludeResource: font Helvetica
/Helvetica /ISOLatin1Encoding 120 FMSR

1292  571 mt 
(Apache2.0 on Linux 2.2) s
1292  709 mt 
(Apaceh2.0 on Linux 2.2 + IDS) s
gs 959 449 1987 300 rc
c8
200 0 1025 531 2 MP stroke
c9
200 0 1025 669 2 MP stroke
gr

c9

end

eplot
%%EndObject

epage
end

showpage

%%Trailer
%%EOF

%%EndDocument
 @endspecial 533 2308 a Fs(Figure)19 b(6.)h Fn(P)l(erf)n(or)r(mance)j
(of)g(the)h(Apache)g(2.0)f(with)h(and)f(without)h(system)e(call)i(chec)
n(ks)-112 2575 y Fs(performance)15 b(has)j(been)f(a)i(moti)n(v)n(ating)
d(f)o(actor)h(in)h(our)f(design,)h(we)-112 2674 y(ha)n(v)o(e)e(achie)n
(v)o(ed)g(our)g(security)h(guarantees)f(with)h(minimal)g(impact)-112
2774 y(on)i(the)h(performance.)-37 2874 y(On)26 b(a)g(much)f(lar)o(ger)
g(scale,)j(we)e(belie)n(v)o(e)f(that)h(much)f(more)h(ef-)-112
2973 y(fecti)n(v)o(e)i(security)g(can)h(be)g(achie)n(v)o(ed)f(by)g
(inte)o(grating)f(the)j(attack)-112 3073 y(signature)f(based)h
(systems,)k(statistical)e(pro\002le)e(based)g(systems)-112
3172 y(and)d(the)h(sandboxing)d(systems)k(such)e(as)i(the)f(one)g
(described)e(in)-112 3272 y(this)i(paper)-5 b(.)50 b(Depicted)27
b(in)i(Figure)f(7,)i(the)e(signature)g(based)g(ap-)-112
3372 y(proach)21 b(detects)h(attacks)h(from)e(the)i(outside,)f(the)h
(statistical)g(pro-)-112 3471 y(\002le)28 b(approach)d(detects)j
(anomaly)e(inside,)j(and)e(the)h(sandboxing)-112 3571
y(approach)18 b(stops)i(attacks)g(on)g(the)g(boundary)-5
b(.)-112 3833 y Fu(8)99 b(Ackno)o(wledgements)-37 4038
y Fs(This)30 b(w)o(ork)f(has)h(bene\002ted)f(substantially)g(from)g
(discussions)-112 4137 y(with)j(a)h(lar)o(ge)e(number)f(of)i(people.)60
b(In)32 b(particular)m(,)h(we)g(w)o(ould)-112 4237 y(lik)o(e)c(to)h
(ackno)n(wledge)d(the)i(contrib)n(utions)e(of)i(P)o(ankaj)g(Rohatgi,)
-112 4337 y(Josyula)15 b(R.)h(Rao,)g(Da)n(vid)g(Saf)n(ford)d(and)i
(Douglas)g(Schales)h(of)f(IBM)-112 4436 y(Research,)30
b(and)f(Herv)5 b(\264)-33 b(e)29 b(Debar)f(who)h(w)o(as)h(at)f(IBM)h
(Zurich)e(Re-)-112 4536 y(search)19 b(Lab)m(.)-112 4798
y Fu(Refer)n(ences)-112 5003 y Fs([ALJ)59 4972 y Fq(+)113
5003 y Fs(93])101 b(Debra)51 b(Anderson,)59 b(T)-6 b(eresa)52
b(F)-7 b(.)54 b(Lunt,)59 b(Harold)326 5102 y(Ja)n(vitz,)54
b(Ann)47 b(T)-7 b(amaru,)53 b(and)47 b(Alfonso)g(V)-9
b(aldes.)326 5202 y(SAFEGU)m(ARD)39 b(FIN)m(AL)h(REPOR)-5
b(T)l(:)40 b(Detecting)326 5301 y(Unusual)19 b(Program)f(Beha)n(vior)h
(Using)h(the)f(NIDES)326 5401 y(Statistical)52 b(Component.)128
b(T)-6 b(echnical)51 b(report,)326 5501 y(Computer)33
b(Science)h(Laboratory)-5 b(,)36 b(SRI)f(Interna-)326
5600 y(tional,)20 b(Menlo)g(P)o(ark,)f(California,)h(USA,)h(Decem-)326
5700 y(ber)e(1993.)2026 2575 y([Atk95])173 b(Randall)27
b(Atkinson.)53 b(Security)27 b(Architecture)f(for)2464
2674 y(the)18 b(Internet)f(Protocol.)23 b(Internet)17
b(RFC)i(1825,)e(Au-)2464 2774 y(gust)j(1995.)2026 2930
y([BGM00])109 b(M.)30 b(Bernaschi,)h(E.)f(Gabrielli,)i(and)e(L.)g
(Mancini.)2464 3029 y(Enhancements)71 b(to)i(the)h(Linux)e(K)n(enel)h
(for)2464 3129 y(Blocking)49 b(Buf)n(fer)h(Ov)o(er\003o)n(w)g(Based)h
(Attacks,)2464 3228 y Fe(http://www.iac.rm.cnr.it/)2464
3328 y(newweb/tecno/papers/bufoverp)p Fs(,)2464 3428
y(August)19 b(2000.)2026 3583 y([CDE)2220 3553 y Fq(+)2275
3583 y Fs(96])77 b(Mark)33 b(Crosbie,)k(Bryn)c(Dole,)38
b(T)-7 b(odd)33 b(Ellis,)38 b(Iv)n(an)2464 3683 y(Krsul,)f(and)d
(Eugene)e(Spaf)n(ford.)72 b(IDIO)m(T)33 b(Users)2464
3783 y(Guide.)84 b(T)-6 b(echnical)36 b(Report)h(CSD-TR-96-050,)2464
3882 y(CO)m(AST)28 b(Laboratory)-5 b(,)26 b(Dept.)g(of)h(Computer)f
(Sci-)2464 3982 y(ences,)20 b(Purdue)f(Uni)n(v)o(ersity)-5
b(,)18 b(September)h(1996.)2026 4137 y([D)m(A97])181
b(T)m(im)23 b(Dierks)h(and)f(Christopher)f(Allen.)39
b(The)23 b(TLS)2464 4237 y(Protocol)34 b(V)-9 b(ersion)34
b(1.0.)75 b(IETF)35 b Fm(<)p Fs(draft-ietf-tls-)2464
4337 y(protocol-02.txt)p Fm(>)p Fs(,)16 b(March)j(1997.)2026
4492 y([DDNW98])40 b(Herv)5 b(\264)-33 b(e)32 b(Debar)m(,)j(Marc)e
(Dacier)m(,)i(Mehdi)d(Nassehi,)2464 4592 y(and)44 b(Andreas)f(W)-7
b(espi.)108 b(Fix)o(ed)44 b(vs.)h(V)-9 b(ariable\226)2464
4691 y(Length)15 b(P)o(atterns)i(for)f(Detecting)h(Suspicious)f(Pro-)
2464 4791 y(cess)h(Beha)n(vior)m(,)f(Research)g(Report,)h(No.)f
(RZ3012,)2464 4891 y(IBM)53 b(Research)f(Di)n(vision,)59
b(Zurich)52 b(Research)2464 4990 y(Lab,)19 b(April)h(1998.)2026
5146 y([DD)n(W99])102 b(Herv)5 b(\264)-33 b(e)22 b(Debar)m(,)g(Marc)h
(Dacier)m(,)g(and)f(Andreas)g(W)-7 b(e-)2464 5246 y(spi.)24
b(T)-7 b(o)n(w)o(ars)18 b(a)g(taxonomy)e(of)h(intrusion)g(detection)
2464 5345 y(systems.)29 b Ft(Computer)20 b(Networks)p
Fs(,)h(31,)f(1999.)2026 5501 y([DoD85])136 b(US)224 b(Department)e(of)h
(Defense)2464 5600 y(T)m(rusted)141 b(Computer)g(System)h(Ev)n(alua-)
2464 5700 y(tion)e(Criteria,)170 b(DOD)141 b(5200.28-STD,)p
eop
%%Page: 12 12
12 11 bop 731 2470 a @beginspecial 0 @llx 0 @lly 394
@urx 344 @ury 2880 @rwi @setspecial
%%BeginDocument: fig/integrated.ps
%!PS-Adobe-2.0 EPSF-2.0
%%Title: fig/integrated.fig
%%Creator: fig2dev Version 3.2 Patchlevel 1
%%CreationDate: Fri Aug 24 14:31:44 2001
%%For: schari@netsec03 (Suresh Chari)
%%Orientation: Portrait
%%BoundingBox: 0 0 394 344
%%Pages: 0
%%BeginSetup
%%EndSetup
%%Magnification: 1.0000
%%EndComments
/$F2psDict 200 dict def
$F2psDict begin
$F2psDict /mtrx matrix put
/col-1 {0 setgray} bind def
/col0 {0.000 0.000 0.000 srgb} bind def
/col1 {0.000 0.000 1.000 srgb} bind def
/col2 {0.000 1.000 0.000 srgb} bind def
/col3 {0.000 1.000 1.000 srgb} bind def
/col4 {1.000 0.000 0.000 srgb} bind def
/col5 {1.000 0.000 1.000 srgb} bind def
/col6 {1.000 1.000 0.000 srgb} bind def
/col7 {1.000 1.000 1.000 srgb} bind def
/col8 {0.000 0.000 0.560 srgb} bind def
/col9 {0.000 0.000 0.690 srgb} bind def
/col10 {0.000 0.000 0.820 srgb} bind def
/col11 {0.530 0.810 1.000 srgb} bind def
/col12 {0.000 0.560 0.000 srgb} bind def
/col13 {0.000 0.690 0.000 srgb} bind def
/col14 {0.000 0.820 0.000 srgb} bind def
/col15 {0.000 0.560 0.560 srgb} bind def
/col16 {0.000 0.690 0.690 srgb} bind def
/col17 {0.000 0.820 0.820 srgb} bind def
/col18 {0.560 0.000 0.000 srgb} bind def
/col19 {0.690 0.000 0.000 srgb} bind def
/col20 {0.820 0.000 0.000 srgb} bind def
/col21 {0.560 0.000 0.560 srgb} bind def
/col22 {0.690 0.000 0.690 srgb} bind def
/col23 {0.820 0.000 0.820 srgb} bind def
/col24 {0.500 0.190 0.000 srgb} bind def
/col25 {0.630 0.250 0.000 srgb} bind def
/col26 {0.750 0.380 0.000 srgb} bind def
/col27 {1.000 0.500 0.500 srgb} bind def
/col28 {1.000 0.630 0.630 srgb} bind def
/col29 {1.000 0.750 0.750 srgb} bind def
/col30 {1.000 0.880 0.880 srgb} bind def
/col31 {1.000 0.840 0.000 srgb} bind def

end
save
-188.0 451.0 translate
1 -1 scale

/cp {closepath} bind def
/ef {eofill} bind def
/gr {grestore} bind def
/gs {gsave} bind def
/sa {save} bind def
/rs {restore} bind def
/l {lineto} bind def
/m {moveto} bind def
/rm {rmoveto} bind def
/n {newpath} bind def
/s {stroke} bind def
/sh {show} bind def
/slc {setlinecap} bind def
/slj {setlinejoin} bind def
/slw {setlinewidth} bind def
/srgb {setrgbcolor} bind def
/rot {rotate} bind def
/sc {scale} bind def
/sd {setdash} bind def
/ff {findfont} bind def
/sf {setfont} bind def
/scf {scalefont} bind def
/sw {stringwidth} bind def
/tr {translate} bind def
/tnt {dup dup currentrgbcolor
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add srgb}
  bind def
/shd {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
  4 -2 roll mul srgb} bind def
 /DrawEllipse {
	/endangle exch def
	/startangle exch def
	/yrad exch def
	/xrad exch def
	/y exch def
	/x exch def
	/savematrix mtrx currentmatrix def
	x y tr xrad yrad sc 0 0 1 startangle endangle arc
	closepath
	savematrix setmatrix
	} def

/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def
%%EndProlog

$F2psBegin
10 setmiterlimit
n -1000 8512 m -1000 -1000 l 10687 -1000 l 10687 8512 l cp clip
 0.06000 0.06000 sc
% Polyline
7.500 slw
n 3150 2519 m 9675 2519 l 9675 7500 l 3150 7500 l cp gs col4 1.00 shd ef gr gs col0 s gr 
% Ellipse
n 6225 5175 1450 1450 0 360 DrawEllipse gs col13 1.00 shd ef gr gs col0 s gr

/Helvetica-Bold ff 240.00 scf sf
5175 5175 m
gs 1 -1 sc (anomaly detection) col0 sh gr
/Helvetica-Bold ff 240.00 scf sf
4875 3150 m
gs 1 -1 sc (attack signature detection) col0 sh gr
/Helvetica-Bold ff 300.00 scf sf
4425 2025 m
gs 1 -1 sc (Integrated Defense System) col0 sh gr
360.000 slw
% Ellipse
n 6224 5181 1450 1450 0 360 DrawEllipse gs col10 s gr

/Helvetica-Bold ff 240.00 scf sf
5550 3900 m
gs 1 -1 sc (sandboxing) col7 sh gr
$F2psEnd
rs

%%EndDocument
 @endspecial 1420 2653 a Fs(Figure)20 b(7.)g Fn(Integ)o(r)o(ated)k(Def)
n(ense)326 2921 y Fe(http://www.radium.ncsc.mil/)326
3020 y(tpep/library/rainbow/)326 3120 y(index.html)p
Fs(,)18 b(December)h(1985.)-112 3277 y([FBF99])151 b(T)m(imothy)21
b(Fraser)m(,)j(Lee)g(Badger)m(,)f(and)g(Mark)h(Feld-)326
3377 y(man.)k(Hardening)17 b(CO)m(TS)k(softw)o(are)e(with)h(generic)326
3476 y(softw)o(are)39 b(wrappers.)91 b(In)40 b Ft(Pr)l(oceedings)e(of)i
(the)326 3576 y(IEEE)d(Symposium)g(on)h(Security)g(and)g(Privacy)p
Fs(,)326 3676 y(1999.)-112 3833 y([FHSL96])95 b(Stephanie)29
b(F)o(orrest,)k(Ste)n(v)o(en)d(A.)h(Hofme)o(yr)m(,)g(Anil)326
3933 y(Somayaji,)16 b(and)h(Thomas)g(A.)g(Longstaf)n(f.)k(A)d(Sense)326
4032 y(of)i(Self)i(for)e(UNIX)h(Processes.)33 b(In)20
b Ft(IEEE)h(Sympo-)326 4132 y(sium)f(on)g(Security)g(and)f(Privacy)p
Fs(,)h(1996.)-112 4289 y([FKK96])132 b(Alan)32 b(O.)h(Freier)m(,)i
(Philip)d(Karlton,)j(and)d(P)o(aul)h(C.)326 4389 y(K)m(ocher)-5
b(.)29 b(The)20 b(SSL)i(Protocol)d(V)-9 b(ersion)20 b(3.0.)30
b(IETF)326 4489 y Fm(<)p Fs(draft-ietf-tls-ssl-v)o(ersion3-00.)o(txt)p
Fm(>)p Fs(,)37 b(No)o(v)o(em-)326 4588 y(ber)19 b(1996.)-112
4746 y([Jac99])192 b(Kathleen)47 b(A.)h(Jackson.)118
b(INTR)m(USION)47 b(DE-)326 4845 y(TECTION)28 b(SYSTEM)g(\(IDS\))h
(Product)e(Re)n(vie)n(w)-5 b(,)326 4945 y(IBM)16 b(internal)f
(con\002dential)g(document,)f(IBM)j(Re-)326 5044 y(search)27
b(Di)n(vision,)h(Zurich)e(Research)i(Lab,)h(April)326
5144 y(1999.)-112 5301 y([JS00])220 b(K.)25 b(Jain)h(and)f(R.)h(Sekar)
-5 b(.)46 b(User)n(-Le)n(v)o(el)24 b(Infrastruc-)326
5401 y(ture)15 b(for)g(System)h(Call)g(Interposition:)21
b(A)16 b(Platform)326 5501 y(for)25 b(Intrusion)f(Detection)h(and)g
(Con\002nement.)46 b(In)326 5600 y Ft(Pr)l(oceedings)28
b(of)i(the)g(Network)g(and)f(Distrib)n(uted)326 5700
y(Systems)20 b(Security)g(Symposium)p Fs(,)f(February)f(2000.)2026
2921 y([JV94])206 b(Hal)28 b(Ja)n(vitz)g(and)g(Alfonso)f(V)-9
b(aldes.)53 b(The)28 b(NIDES)2464 3020 y(statistical)j(component)d
(description)h(and)g(justi\002-)2464 3120 y(cation.)60
b(T)-6 b(echnical)30 b(report,)h(Computer)e(Science)2464
3219 y(Laboratory)-5 b(,)39 b(SRI)g(International,)i(Menlo)c(P)o(ark,)
2464 3319 y(California,)19 b(USA,)h(March)g(1994.)2026
3496 y([JVM01])132 b(The)231 b(Ja)n(v)n(a)h(V)-5 b(irtual)232
b(Machine,)2464 3596 y Fe(http://www.javasoft.com)p Fs(,)16
b(2001.)2026 3773 y([KFBK00])77 b(Calvin)25 b(K)m(o,)i(T)m(imothy)d
(Fraser)m(,)j(Lee)e(Badger)m(,)h(and)2464 3873 y(Douglas)h(Kilpatrick.)
54 b(Detecting)27 b(and)h(Counter)n(-)2464 3973 y(ing)23
b(System)g(Intrusions)f(Using)h(Softw)o(are)g(Wrap-)2464
4072 y(pers.)47 b(In)26 b Ft(Pr)l(oceedings)f(of)h(the)g(9th)g(USENIX)f
(Se-)2464 4172 y(curity)20 b(Symposium)p Fs(,)f(August)g(2000.)2026
4349 y([MBKQ96])49 b(Marshall)67 b(Kirk)g(McK)o(usick,)78
b(K)n(eith)67 b(Bostic,)2464 4449 y(Michael)30 b(J.)h(Karles,)h(and)e
(John)g(S.)h(Quarterman.)2464 4548 y Ft(The)39 b(Design)f(and)g
(Implementation)f(of)h(the)h(4.4)2464 4648 y(BSD)20 b(Oper)o(ating)f
(System)p Fs(,)h(pages)g(67,)g(540.)29 b(Addi-)2464 4748
y(son)19 b(W)-7 b(esle)o(y)i(,)20 b(Ne)n(w)g(Y)-9 b(ork)18
b(City)-5 b(,)20 b(Ne)n(w)g(Y)-9 b(ork,)18 b(USA,)2464
4847 y(1996.)2026 5025 y([P)o(ax98])174 b(V)-9 b(an)32
b(P)o(axson.)67 b(Bro:)50 b(A)33 b(System)f(for)g(Detecting)2464
5124 y(Netw)o(ork)27 b(Intruders)e(in)j(Real\226T)m(ime.)52
b(In)27 b Ft(the)h(7th)2464 5224 y(USENIX)19 b(Security)h(Symposium)p
Fs(,)f(1998.)2026 5401 y([PN98])192 b(Thomas)44 b(H.)i(Ptacek)f(and)g
(T)m(imothy)f(N.)i(Ne)n(w-)2464 5501 y(sham.)41 b(Insertion,)23
b(Ev)n(asion,)h(and)f(Denial)h(of)f(Ser)n(-)2464 5600
y(vices:)39 b(Eluding)25 b(Netw)o(ork)h(Intrusion)f(Detection,)2464
5700 y Fe(http://www.nai.com)p Fs(,)17 b(January)i(1998.)p
eop
%%Page: 13 13
13 12 bop -112 458 a Fs([RLS)68 428 y Fq(+)123 458 y
Fs(97])91 b(Marcus)21 b(J.)i(Ranum,)f(K)n(ent)g(Land\002eld,)f(Mik)o(e)
h(Sto-)326 558 y(larchuk,)g(Mark)h(Sienkie)n(wicz,)g(Andre)n(w)f
(Lameth,)326 657 y(and)28 b(Eric)g(W)-7 b(all.)58 b(Implementing)26
b(a)j(Generalized)326 757 y(T)-7 b(ool)35 b(for)f(Netw)o(ork)h
(Monitoring.)75 b(In)35 b Ft(the)g(11th)326 857 y(USENIX)c(Systems)h
(Administr)o(ator)f(Confer)m(ence)p Fs(,)326 956 y(1997.)-112
1122 y([SEL])234 b(Security\226Enhanced)11 b(Linux.)j(A)-6
b(v)n(ailable)15 b(online)g(at)326 1222 y Fe
(http://www.nsa.gov/selinux/)p Fs(.)-112 1388 y([SU99])192
b(R.)26 b(Sekar)g(and)f(P)-9 b(.)27 b(Uppuluri.)46 b(Synthesizing)25
b(F)o(ast)326 1487 y(Intrusion)15 b(Detection)i(Systems)g(from)f
(High-Le)n(v)o(el)326 1587 y(Speci\002cations.)62 b(In)31
b Ft(the)g(8th)f(USENIX)h(Security)326 1687 y(Symposium)p
Fs(,)18 b(pages)i(63\22678,)e(August)i(1999.)-112 1853
y([UES00])342 1835 y(\264)326 1853 y(Ulf)o(ar)f(Erlingsson)f(and)h
(Fred)g(B.)h(Schneider)-5 b(.)27 b(IRM)326 1952 y(enforcement)13
b(of)i(Ja)n(v)n(a)h(stack)g(inspection.)i(In)e Ft(IEEE)326
2052 y(Symposium)i(on)i(Security)g(and)f(Privacy)p Fs(,)h(2000.)-112
2218 y([W)-7 b(ag99])148 b(Da)n(vid)15 b(A.)g(W)-7 b(agner)i(.)19
b(Janus:)k(an)15 b(approach)e(for)i(con-)326 2318 y(\002nement)20
b(of)h(untrusted)f(applications.)31 b(T)-6 b(echnical)326
2417 y(Report)22 b(CSD\22699\2261056,)e(Uni)n(v)o(ersity)h(of)i
(Califor)n(-)326 2517 y(nia)d(at)g(Berk)o(ele)o(y)-5
b(,)19 b(August)h(1999.)-112 2683 y([WEB01])114 b(W)-7
b(ebSphere)314 b(V4.0)h(Adv)n(anced)326 2783 y(Edition)203
b(Handbook.)e(Online)j(at)326 2882 y Fe(http://www.redbooks.ibm.com/)
326 2982 y(redpieces/pdfs/sg246176.pdf)p Fs(,)326 3082
y(No)o(v)o(ember)17 b(2001.)-112 3248 y([WSB)95 3217
y Fq(+)150 3248 y Fs(96])64 b(K)n(enneth)19 b(M.)i(W)-7
b(alk)o(er)m(,)21 b(Daniel)f(F)-7 b(.)22 b(Sterne,)e(M.)h(Lee)326
3347 y(Badger)m(,)40 b(Michael)d(J.)h(Petkac,)j(Da)n(vid)c(L.)h(Sher)n
(-)326 3447 y(mann,)27 b(and)f(Karen)g(A.)h(Oostendrop.)49
b(Con\002ning)326 3546 y(Root)34 b(Programs)g(with)h(Domain)f(and)g(T)
-7 b(ype)35 b(En-)326 3646 y(forcement.)f(In)23 b Ft(the)f(6th)h
(USENIX)f(Security)g(Sym-)326 3746 y(posium)p Fs(,)d(July)h(1996.)-112
3912 y([WUF])198 b(Source)112 b(code)i(to)f(e)o(xploit)g(the)h(heap)326
4011 y(o)o(v)o(er\003o)n(w)140 b(in)j(wu\226ftpd.)e(Online)h(at)326
4111 y Fe(http://oliver.efri.hr/)p Fr(\030)p Fe(crv/)326
4211 y(security/bugs/mUNIXes/)326 4310 y(wuftpd15.html)p
Fs(.)-112 4476 y([XB01])183 b(Huagang)109 b(Xie)j(and)f(Philippe)g
(Biondi.)326 4576 y(The)75 b(Linux)g(Intrusion)f(Detection)h(Project,)
326 4676 y Fe(http://www.lids.org)p Fs(,)16 b(2001.)2026
458 y Fu(A)n(ppendix)2026 674 y(A)99 b(Harmless)24 b(System)h(Calls)
2101 832 y Fs(Each)g(of)h(these)g(system)g(calls)g(either)f(has)h(no)g
(security)f(impli-)2026 931 y(cations)30 b(or)h(is)g(not)f(supported)f
(by)h(the)h(Linux)f(2.2.14)e(k)o(ernel.)p 2076 1072 1800
24 v 2076 1315 a Fa(afs)p 2180 1315 23 4 v 26 w(syscall)285
b(lstat64)2076 1406 y(alar)r(m)445 b(mpx)2076 1498 y(break)i(msync)2076
1589 y(br)q(k)530 b(nanosleep)2076 1680 y(capget)409
b(ne)o(wselect)2076 1772 y(chdir)472 b(oldfstat)2076
1863 y(fchdir)451 b(oldlstat)2076 1954 y(fdatasync)314
b(oldolduname)2076 2046 y(fstat)493 b(olduname)2076 2137
y(fstat64)409 b(poll)2076 2228 y(fstatfs)435 b(prof)2076
2320 y(fsync)461 b(quer)r(y)p 2905 2320 V 26 w(module)2076
2411 y(ftime)472 b(readlink)2076 2502 y(get)p 2185 2502
V 25 w(k)o(er)r(nel)p 2416 2502 V 25 w(syms)101 b(sched)p
2915 2502 V 26 w(get)p 3046 2502 V 26 w(pr)q(ior)q(ity)p
3300 2502 V 25 w(max)2076 2594 y(getcwd)397 b(sched)p
2915 2594 V 26 w(get)p 3046 2594 V 26 w(pr)q(ior)q(ity)p
3300 2594 V 25 w(min)2076 2685 y(getdents)346 b(sched)p
2915 2685 V 26 w(getpar)o(am)2076 2776 y(getegid)387
b(sched)p 2915 2776 V 26 w(getscheduler)2076 2868 y(geteuid)g(sched)p
2915 2868 V 26 w(rr)p 2991 2868 V 27 w(get)p 3123 2868
V 26 w(inter)r(v)n(al)2076 2959 y(getgid)429 b(sched)p
2915 2959 V 26 w(yield)2076 3050 y(getg)o(roups)301 b(setitimer)2076
3142 y(getitimer)346 b(sgetmask)2076 3233 y(getpgid)387
b(stat)2076 3324 y(getpg)o(r)r(p)378 b(stat64)2076 3416
y(getpid)429 b(statfs)2076 3507 y(getppid)387 b(stty)2076
3598 y(getpr)q(ior)q(ity)302 b(sysfs)2076 3690 y(getresgid)325
b(sysinf)n(o)2076 3781 y(getresuid)g(syslog)2076 3872
y(getr)q(limit)370 b(time)2076 3964 y(getr)q(usage)299
b(times)2076 4055 y(getsid)434 b(uname)2076 4146 y(gettimeofda)n(y)206
b(ustat)2076 4237 y(getuid)429 b(vf)n(or)q(k)2076 4329
y(gtty)514 b(vhangup)2076 4420 y(loc)o(k)503 b(vm86)2076
4511 y(lstat)497 b(w)o(ait4)p 2076 4654 1800 24 v 2427
4932 a Fs(T)-7 b(able)20 b(2.)g Fd(Har)r(mless)j Fn(System)g(Calls)p
eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
